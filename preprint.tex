\documentclass[spanish]{article}

\usepackage{arxiv}

\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage{lmodern}        % https://github.com/rstudio/rticles/issues/343
\usepackage{hyperref}       % hyperlinks
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography
\usepackage{graphicx}

\title{Generación de red hidrográfica densa de República Dominicana a
partir de modelo digital de elevaciones de resolución media}

\author{
    José-Ramón Martínez-Batlle\orcidlink{0000-0001-9924-0327}
   \\
    Facultad de Ciencias \\
    Universidad Autónoma de Santo Domingo (UASD) \\
  Santo Domingo, República Dominicana \\
  \texttt{\href{mailto:joseramon@geografiafisica.org}{\nolinkurl{joseramon@geografiafisica.org}}} \\
   \And
    Michela Izzo Gioiosa\orcidlink{0000-0003-4835-3967}
   \\
    Directora Ejecutiva \\
    Guakia Ambiente \\
  Santo Domingo, República Dominicana \\
  \texttt{\href{mailto:michela.izzo@guakiambiente.org}{\nolinkurl{michela.izzo@guakiambiente.org}}} \\
  }

% Pandoc syntax highlighting
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}

% tightlist command for lists without linebreak
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}


% Pandoc citation processing
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newlength{\cslentryspacingunit} % times entry-spacing
\setlength{\cslentryspacingunit}{\parskip}
% for Pandoc 2.8 to 2.10.1
\newenvironment{cslreferences}%
  {}%
  {\par}
% For Pandoc 2.11+
\newenvironment{CSLReferences}[2] % #1 hanging-ident, #2 entry spacing
 {% don't indent paragraphs
  \setlength{\parindent}{0pt}
  % turn on hanging indent if param 1 is 1
  \ifodd #1
  \let\oldpar\par
  \def\par{\hangindent=\cslhangindent\oldpar}
  \fi
  % set entry spacing
  \setlength{\parskip}{#2\cslentryspacingunit}
 }%
 {}
\usepackage{calc}
\newcommand{\CSLBlock}[1]{#1\hfill\break}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{#1}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{#1}\break}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}

\usepackage{orcidlink} \usepackage{float} \usepackage[all]{nowidow} \usepackage[spanish]{babel} \renewcommand\spanishtablename{Tabla} \usepackage{xcolor} \usepackage{tabu} \renewcommand\tablename{Tabla} \renewcommand\figurename{Figura} \newcommand{\beginsupplement}{ \setcounter{table}{0} \renewcommand{\thetable}{S\arabic{table}} \renewcommand\tablename{Tabla} \setcounter{figure}{0} \renewcommand{\thefigure}{S\arabic{figure}} \renewcommand\figurename{Figura} } \usepackage[hidelinks]{hyperref} \usepackage{xurl} \usepackage[left]{lineno} \linenumbers
\begin{document}
\maketitle


\begin{abstract}
El resumen se colocará aquí.
\end{abstract}

\keywords{
    modelo digital de elevaciones
   \and
    análisis hidrológico
   \and
    procesamiento de datos geoespaciales
   \and
    hidrología computacional
  }

\hypertarget{introducciuxf3n}{%
\section{Introducción}\label{introducciuxf3n}}

El agua es un recurso crítico, que impulsa la economía y sostiene la
vida. A nivel global, pero especialmente en países que comparten islas
pequeñas, como República Dominicana (RD), la administración eficaz de
este recurso es esencial (Izzo et~al., 2010; Le, 2019; Lenderking
et~al., 2020; Lohmann, 2016; Mackay y Spencer, 2017; Roson, 2013). Sin
embargo, la gestión eficiente de los recursos hídricos puede verse
limitada por la falta de información precisa y completa sobre la red
hidrográfica. En este contexto, las fuentes actuales de información
geográfica, a pesar de su valor, presentan limitaciones en cuanto a su
resolución, cobertura y consistencia.

La red hidrográfica de RD digitalizada a partir del mapa topográfico
nacional a escala 1:50,000 (``MTN-50k'') (Instituto Cartográfico Militar
(ICM), 1989) ofrece una cobertura extensa pero carece de los detalles
necesarios para apoyar el análisis hidrológico. Por otro lado, los
estudios técnicos y multitemáticos de ámbito subnacional desarrollados
por el Instituto Nacional de Recursos Hidráulicos (INDRHI) de RD y otras
entidades y autores, aunque son valiosas fuentes de información,
utilizan metodologías diversas, lo que limita la consolidación de una
red hidrográfica coherente a nivel nacional (CIDIAT y INDRHI, 1992;
Halcrow-COR Ing. S.A., 2002; INDRHI, 1996, 2012; INDRHI y AQUATER, 2000;
INDRHI y EPTISA, 2000; Martinez-Batlle, 2019; Martínez-Batlle, 2019; OEA
y INDRHI, 1994; Rodríguez y Febrillet, 2006; Secretaría de Estado de
Medio Ambiente y Recursos Naturales, 2004; SERCITEC y INDRHI, 2002)

Adicionalmente, las redes hidrográficas derivadas de modelos digitales
de elevaciones de baja resolución, como el Shuttle Radar Topography
Mission (SRTM) de 3 arco-segundos, normalmente presentan artefactos de
difícil depuración, además de que la longitud de los canales es siempre
más corta que la verdadera, resultando en redes poco densas (Jarvis
et~al., 2008; NASA JPL, 2013; NASA LP DAAC, 2000; National Aeronautics
and Space Administration y United States Geological Survey, 2009). Por
otro lado, el DEM SRTM de 1 arco-segundo (\textasciitilde30 metros)
garantiza la precisión mientras aumenta el detalle de elevación y parece
ser una de las fuentes más consistentes actualmente (Aziz y Rashwan,
2022). No obstante, nosotros hemos generado productos hidrográficos con
SRTM-DEM de 30 metros, y notamos que el nivel de detalle de la red es
bastante mejorable, sobre todo en áreas de montaña.

Desde 2014, Alaska Satellite Facility (ASF) inició la creación de
productos ALOS-PALSAR corregidos radiométricamente en función del
terreno (RTC), con el objetivo de mejorar la geometría y la
radiometría---coeficiente de retrodispersión por unidad de superficie
del frente de onda incidente, también conocido como \emph{gamma-nought},
\(\gamma^0\)---de las imágenes generadas por el sensor PALSAR (radar de
apertura sintética, banda L, con distintas polarizaciones y modos de
barrido) montado a bordo del satélite ALOS de la Agencia Espacial
Japonesa (JAXA) (ASF DAAC, 2014; JAXA/METI y ASF DAAC, 2015). ALOS fue
lanzado en 2006, pero luego de cinco años de servicio, perdió energía y
cesó la comunicación con el centro de control, aunque aún permanece en
órbita.

Para obtener los productos RTC, denominados propiamente como
``\emph{Hi-Res Terrain Corrected}'' o ``ALOS PALSAR RTC'', ASF requirió
de datos globales de elevación de la máxima resolución posible, para lo
cual empleó de forma preferente (según territorios) el SRTM de 1
arco-segundo. En el proceso fue necesario ajustar el espaciado de
píxeles del DEM fuente (\textasciitilde30 metros) para hacerlo coincidir
con el espaciado de píxel de las imágenes ALOS PALSAR (\textasciitilde{}
12.5 metros) usando una función de remuestreo (\emph{up-sampling}),
obteniéndose así un DEM de 12.5 metros (ASF DAAC, 2014; JAXA/METI y ASF
DAAC, 2015).

A pesar de que ASF advirtió que este DEM se empleó únicamente para
realizar la corrección radiométrica del terreno del producto derivado de
ALOS-PALSAR, y que no debería ser utilizado como fuente de elevación
precisa (ASF DAAC, 2014), lo cierto es que en países donde no se dispone
de DEM de mediana o alta resolución, se vuelve crucial indagar en el
potencial de cada nuevo producto disponible. Por esta razón, tras varias
pruebas iniciales en las que extrajimos redes de drenaje y elementos del
relieve a partir de este DEM, comprobamos que la red hidrográfica
obtenida tenía mucho mayor detalle que las redes generadas con cualquier
otra fuente disponible. Dado que la elevación precisa no es crucial en
nuestras aplicaciones, vimos un alto potencial en este DEM para realizar
aplicaciones de hidrología computacional, en concreto para la extracción
de redes densas con énfasis en áreas de montaña.

El propósito de este artículo es ofrecer nuevos datos para superar las
limitaciones de las redes hidrográficas existentes, desarrollando una
red densa de ríos, arroyos y cañadas---canales, talwegs---con énfasis en
áreas montañosas---donde las fuentes actualmente disponibles suelen
mostrar una red dispersa---, utilizando como fuente el DEM servido con
los productos ALOS PALSAR RTC de 12.5 metros de resolución espacial.
Nuestro segundo objetivo es optimizar el DEM, reduciendo el ruido y
asegurando su precisión hidrológica, a la vez que mantenemos los
elementos morfológicos significativos del terreno. El tercer objetivo,
no menos importante, es sistematizar el protocolo de procesamiento con
una metodología explícita, generando una base de código abierto basada
en software libre para el procesamiento de datos de elevación e
hidrología computacional, que ofrezca a personas interesadas,
especialmente a estudiantes, una referencia didáctica que pueda
aplicarse a fuentes de elevación similares.

Nuestro trabajo tiene potencial para suplir las demandas de información
sobre hidrografía de resolución fina, que es un aspecto crucial en
muchos estudios de modelación, análisis de riesgos, morfometría de
cuencas, entre otros. De manera particular, la hidrografía densa
generada por nosotros es idónea para mejorar la red estaciones
hidrométricas del país, la cual es limitada y afronta diversos desafíos
de densidad de puntos y de operación, un común denominador en este tipo
de redes globalmente. Nos enfocamos en la utilidad de una hidrografía
sistemáticamente generada, no necesariamente en las métricas precisas,
pues el modelo digital de elevaciones usado tiene error, y la
información de terreno necesaria para conducir el flujo en áreas llanas,
es insuficiente. Asimismo, nuestro trabajo también podría contribuir a
aportar información para acciones de conservación, planificación y
gestión de los recursos hídricos a nivel nacional (Burn, 1997; INDRHI,
2019; Mishra y Coulibaly, 2009; Mishra y Coulibaly, 2010). Además, los
datos generados pueden ser de gran valor para un amplio rango de
aplicaciones, incluyendo la planificación del uso del suelo, el diseño
de infraestructuras, la gestión de cuencas hidrográficas y la
modelización de escorrentía y erosión. A medida que nos enfrentamos a
los impactos del cambio climático y a la creciente escasez de agua,
esperamos que este trabajo sirva como una contribución significativa
para la gestión de los recursos hídricos en la República Dominicana
(Izzo et~al., 2010; Le, 2019; Lenderking et~al., 2020; Lohmann, 2016;
Mackay y Spencer, 2017; Roson, 2013).

\hypertarget{notas-sobre-terminologuxeda}{%
\subsection*{Notas sobre
terminología}\label{notas-sobre-terminologuxeda}}
\addcontentsline{toc}{subsection}{Notas sobre terminología}

La terminología utilizada para describir los distintos componentes de
los sistemas fluviales es un tema de continuo debate en el campo de la
geomorfología fluvial. Este debate suele estar intrínsecamente ligado a
la escala de análisis empleada; al variar la escala, incrementándola o
reduciéndola, los criterios empleados para delimitar las definiciones de
los elementos morfológicos, tienden a desdibujarse y/o a resultar
inconsistentes (García y Ojeda, 2011). Seleccionar el término apropiado
para describir la unidad topográficamente deprimida por donde fluye o
por donde podría circular el agua de escorrentía, es un desafío nada
despreciable. Este reto se intensifica cuando el idioma introduce
distintas connotaciones para términos similares, y donde la traducción
podría prestarse a confusión---tal como ocurre con \emph{channel} y
canal en inglés y español, respectivamente---(Anderson y Anderson, 2010;
Charlton, 2010; Gutiérrez Elorza, 2009; Pedraza Gilsanz, 1996).

La resolución de las discrepancias en la terminología supera el alcance
del presente trabajo, por lo decidimos fijar los términos utilizados en
el artículo de manera convencional. En este estudio, empleamos los
términos \emph{talweg} y canal de forma indistinta para referimos a la
unidad topográficamente deprimida por la que fluye, o podría fluir, la
corriente. En geomorfología, utilizamos la voz germánica \emph{talweg}
para referirnos a la línea imaginaria que traza la parte más baja de un
valle, razón por la cual también la hemos incluido entre los términos
genéricos usados (Foucault y Raoult, 1985). Es importante remarcar que
nuestra definición convencional no siempre se refiere a un curso fluvial
permanente, pues la circulación del agua es influenciada por múltiples
factores. Asimismo, cabe destacar que, a esta unidad geomorfológica en
sus distintas variantes hidrodinámicas y dimensionales, también se le
conoce con múltiples nombres en República Dominicana (en orden de mayor
a menor ``importancia''), como son río, arroyo o cañada, denominaciones
que también incorporamos en la redacción.

Finalmente, en nuestro en este trabajo también adoptamos los términos
curso, drenaje o corriente, especialmente cuando destacamos la presencia
de un flujo ya sea permanente, semipermanente o intermitente. Además,
para el análisis hortoniano de los sistemas fluviales, nos referimos al
sistema interconectado de canales, cursos, corrientes o drenajes con las
denominaciones ``red de drenajes'' o ``red hidrográfica''.

\hypertarget{materiales-y-muxe9todos}{%
\section{Materiales y métodos}\label{materiales-y-muxe9todos}}

\hypertarget{obtenciuxf3n-y-preprocesamiento-del-dem}{%
\subsection{Obtención y Preprocesamiento del
DEM}\label{obtenciuxf3n-y-preprocesamiento-del-dem}}

\begin{figure}[H]

{\centering \includegraphics[width=0.8\linewidth]{figuras/resumen-obtencion-preprocesamiento-dem} 

}

\caption{Resumen gráfico de la obtención y preprocesamiento del DEM}\label{fig:obtencionpreprocdem}
\end{figure}

Iniciamos nuestro estudio valorando diversas herramientas para el
procesamiento de los datos (Figura \ref{fig:obtencionpreprocdem}).
Debido a la gran variedad de complementos que ofrece, junto con su alto
rendimiento y la calidad de los resultados que proporciona, decidimos
utilizar GRASS GIS v8.2.0 para realizar la mayor parte del
preprocesamiento del DEM (GRASS Development Team, 2023). La
implementación de su interfaz de línea de comandos (e.g.~interfaz basada
en texto), en nuestro caso Bash, garantizó la reproducibilidad de
nuestros procedimientos. Nos auxiliamos también de la biblioteca
GDAL/OGR, WhiteboxTools el entorno de programación estadística R y el
lenguaje de programación Python (GDAL/OGR contributors, 2022; Lindsay,
2018; R Core Team, 2023; Van Rossum y Drake, 2009). Nuestro enfoque de
reproducibilidad asegura que, sin importar la fuente de datos empleada,
el seguimiento del flujo de trabajo es viable, manteniendo la integridad
y coherencia del proceso de análisis, sin menoscabo de la calidad del
resultado final.

Asimismo, para facilitar nuestra labor, utilizamos una serie de
bibliotecas de R, además de funciones personalizadas escritas por
nosotros para agilizar y optimizar las tareas de limpieza y
representación de datos y mapas (Hijmans, 2023; O'Brien, 2023; Pebesma,
2018; Pebesma y Bivand, 2023; Wickham et~al., 2019; Xie, 2014, 2015,
2023; Zhu, 2021). El código reproducible usado en el estudio se puede
consultar en la sección \protect\hyperlink{infosupl}{Información
suplementaria}, así como los repositorios creados al efecto, donde
incluimos el código escrito y las direcciones para acceder a los datos
fuentes, entre otras utilidades.

Nos centramos en la fuente de datos, que en nuestro caso es el modelo
digital de elevaciones (DEM) servido con los productos \emph{Hi-Res
Terrain Corrected} de Alaska Satellite Facility (ASF) (ASF DAAC, 2014).
Este producto se descarga desde el Centro de Archivo Activo Distribuido
del Alaska Satellite Facility o ASF DAAC---una de las instalaciones
temáticas de la Administración Nacional de Aeronáutica y del Espacio de
los Estados Unidos, NASA---en forma de escenas o ``cuadros''
(\emph{tiles}), conteniendo dos imágenes de retrodispersión \(\gamma^0\)
(ca. 70x58 km cada una), una por cada polaridad, y el modelo digital de
elevaciones remuestreado con el que ASF realizó la corrección
radiométrica de terreno (ca. 80x70 km), objeto de nuestro estudio.

Cabe señalar que en un estudio de Aziz y Rashwan (2022), se evaluó la
precisión del DEM comparándolo con otras fuentes de elevación,
encontrándose un rendimiento relativamente bajo en varias pruebas. Sin
embargo, en el trabajo se utilizó el DEM sin preprocesar, lo cual
seguramente afectó el detectado bajo rendimiento. Consideramos que, a
pesar de los resultados de su comparativa, la alta resolución del DEM lo
convierte en una excelente opción para la extracción de redes de
drenaje, siempre que se apliquen filtros apropiados (Ngula Niipele y
Chen, 2019). Además, ASF señaló en su documentación (ASF DAAC, 2014;
JAXA/METI y ASF DAAC, 2015) que el DEM usado en la RTC no es una fuente
confiable de elevación, por lo que el resultado obtenido por Aziz y
Rashwan (2022) era más bien el esperado.

Para conformar un mosaico continuo del DEM de República Dominicana,
seleccionamos y descargamos más de 40 escenas únicas de ALOS-PALSAR
desde el ASF DAAC (JAXA/METI y ASF DAAC, 2015), minimizando la
redundancia espacial y eligiendo las versiones más recientes,
conservando sólo 28 escenas distintas (Figura \ref{fig:mapaindice} y
Tabla \ref{tab:tablaindice}). Después, extrajimos los DEM
correspondientes de los archivos comprimidos y transformamos aquellos
proyectos en el huso 18N al 19N del sistema UTM. Posteriormente, creamos
un mosaico continuo (``sin costuras'') usando el formato de ráster
virtual.

\begin{figure}

{\centering \includegraphics[width=0.8\linewidth]{preprint_files/figure-latex/mapaindice-1} 

}

\caption{Mapa índice de las 28 escenas usadas en la formación del DEM de República Dominicana, superponiendo las huellas (polígono de área con datos) de las escenas ALOS PALSAR RTC sobre el límite costero e internacional del país}\label{fig:mapaindice}
\end{figure}

Posteriormente, creamos una base de datos, con su correspondiente
localización, en GRASS GIS, nuestro software principal por su
eficiencia. Ocasionalmente recurrimos a otras herramientas como
WhiteboxTools y QGIS, siempre con el objetivo de optimizar el uso de los
recursos de hardware para obtener los resultados necesarios de manera
rápida (GRASS Development Team, 2023; Lindsay, 2018; QGIS Development
Team, 2021). Complementariamente, generamos una máscara de país en QGIS,
fusionando el límite oficial de la Oficina Nacional de Estadística con
fuentes en línea como GADM, OCHA y OpenStreetMap, y excluyendo
superficies de lagos naturales y embalses para facilitar el análisis de
cuencas endorreicas; este paso fue realizado de forma semimanual.
Posteriormente, importamos tanto el ráster virtual como la máscara a la
base de datos de GRASS GIS (Figura \ref{fig:demsinprocesar}).
Inmediatamente, aplicamos la máscara a la región activa para enfocar los
análisis sólo dentro del área de interés. (GADM, 2022; OCHA, 2022;
Oficina Nacional de Estadística (ONE), 2018; OpenStreetMap contributors,
2017; QGIS Development Team, 2021).

Dentro de la base de datos de GRASS, rellenamos los datos nulos del DEM
(Figura \ref{fig:demrelleno}), para luego suavizar el resultado
preservando morfologías con la herramienta
\emph{FeaturePreservingSmoothing} de WhiteboxTools (Figura
\ref{fig:demsuavizado}) (Lindsay, 2018; Lindsay et~al., 2019). Tras
esto, combinamos el DEM suavizado con el ráster de altura del geoide
EGM2008 mediante una simple suma algebraica para obtener alturas
pseudo-ortométricas, incrementando previamente la resolución del segundo
para acercarla ligeramente a la del primero.

A continuación, como último paso del preprocesamiento, tallamos el DEM
con una red preexistente de cursos largos de República Dominicana, un
paso clave en la generación de la hidrografía por métodos
computacionales, y que en inglés se conoce como \emph{stream burning}
(Lindsay, 2016). Primero creamos la red a partir de una selección de
ríos largos y permanentes, apoyados en imágenes satelitales (Google;
Airbus, CNES; Airbus, Landsat; Copernicus; Maxar Technologies; U.S.
Geological Survey, 2023), MTN-50K (Instituto Cartográfico Militar (ICM),
1989) y OpenStreetMap contributors (2017). Para representar ríos que que
llenan embalses, usamos sus trazados históricos para así mantener la
continuidad hidrológica (Figura \ref{fig:redcursoslargos}). Luego
realizamos el tallado del DEM probando tres algoritmos: \texttt{r.carve}
y \texttt{r.mapcalc} de GRASS GIS, y \texttt{FillBurn} de WhiteboxTools
(GRASS Development Team, 2022a; GRASS Development Team, 2022b, 2022c;
Larson et~al., 1991; Lindsay, 2018; Petrasova et~al., 2011; Saunders,
2000; Shapiro y Westervelt, 1994). Como criterio de selección
establecimos que el mejor algoritmo fuese aquel que lograra una mínima
alteración en el DEM, minimizando a la vez el tiempo de cómputo.
\texttt{r.carve} produjo un buen DEM tallado, aunque ocupó mucho tiempo
de cómputo, por lo que no la consideramos una herramienta adecuada para
iteraciones rápidas. Con \texttt{r.mapcalc} realizamos el tallado
mediante una simple álgebra de mapas (normalización, operaciones
booleanas, multiplicación), de donde obtuvimos un DEM poco alterado en
tiempo relativamente corto. Finalmente, probamos con la función
\texttt{FillBurn} de WhiteboxTools, la cual produjo un DEM tallado
sustancialmente alterado respecto del original, especialmente en las
áreas de karst con depresiones. Optamos por continuar nuestro flujo de
procesamiento con el DEM tallado por \texttt{r.mapcalc} (ver Figura
\ref{fig:demtallado}).

Finalmente, como último paso del preprocesamiento del DEM, aplicamos
algoritmos para superponer depresiones al modelo, un paso esencial para
dirigir la escorrentía y definir de forma coherente los límites de las
cuencas y redes de drenaje. Utilizamos diversas fuentes para generar un
conjunto de depresiones. Principalmente, a partir de la capa de
litologías de la República Dominicana (Mollat et~al., 2004),
identificamos las calizas con suficiente grado de karstificación.
Además, utilizamos el complemento \texttt{r.geomorphon} para crear una
capa de depresiones (Jasiewicz y Stepinski, 2013) (Figura
\ref{fig:geomorfonosrd}), y digitalizamos manualmente algunas
depresiones conocidas. Finalmente, intersectamos las tres fuentes de
datos para producir una capa exhaustiva de las depresiones que capturan
la escorrentía superficial (Figura \ref{fig:depresiones}).

\hypertarget{procesamiento-de-hidrologuxeda-computacional}{%
\subsection{Procesamiento de hidrología
computacional}\label{procesamiento-de-hidrologuxeda-computacional}}

\begin{figure}[H]

{\centering \includegraphics[width=0.8\linewidth]{figuras/resumen-procesamiento-hidrologia-computacional} 

}

\caption{Resumen gráfico del procesamiento de hidrología computacional}\label{fig:procesamientohidrocompu}
\end{figure}

El avance en las técnicas de procesamiento de hidrología computacional
ha permitido estudios cada vez más sofisticados de fenómenos hídricos,
impulsado por las actualizaciones y herramientas disponibles hoy en día,
entre las cuales destacan las de GRASS GIS (Ehlschlaeger, 1989; Freeman,
1991; Holmgren, 1994; Larson et~al., 1991; McCool et~al., 1987; Metz
et~al., 2011; Moore et~al., 1991; Quinn et~al., 1991; Weltz et~al.,
1988). Por su potencial y múltiples complementos disponibles, todo el
procesamiento de hidrología computacional lo desarrollamos en GRASS GIS
(Figura \ref{fig:procesamientohidrocompu}).

Antes de iniciar el procesamiento de hidrología computacional con GRASS
GIS, aplicamos una máscara de país, delimitada por la línea de costa y a
los límites fronterizos, para evitar que las redes se extendieran más
allá de nuestra área de interés. Posteriormente, generamos el mapa de
acumulación de flujo con el complemento \texttt{r.watershed} (GRASS
Development Team, 2022d) (Figura \ref{fig:acumyredrwshed}), y utilizamos
este mapa como fuente de los complementos de la familia
\texttt{r.stream*} para el estudio de redes de drenaje y jerarquía
hidrográfica (Jasiewicz y Metz, 2011). Dentro de esta familia se
encuentran \texttt{r.stream.extract}, que usa el mapa de acumulación de
flujo generado por \texttt{r.watershed} para extraer la red,
\texttt{r.stream.order} para calcular la jerarquía hidrográfica, y
\texttt{r.stream.basins} para crear cuencas hidrográficas en función de
la referida jerarquía. En consecuencia, aplicamos estos algoritmos al
DEM para generar la hidrografía dominicana jerarquizada y la
delimitación de las cuencas según órdenes, proceso que sumarizamos a
continuación.

Empleando el DEM y el mapa de acumulación creado con
\texttt{r.watershed}, generamos la red hidrográfica usando el
complemento \texttt{r.stream.extract}, enfocándonos en la extracción de
cursos indiferenciados, sin caracterización hidrodinámica, sólo
morfológica (Freeman, 1991; Jasiewicz y Metz, 2011; Marchesini et~al.,
2021). Basándonos en experiencia de terreno y estudios previos,
seleccionamos umbrales de acumulación de 180, 540 y 900 celdas,
equivalentes a 3, 8 y 14 hectáreas respectivamente (Freeman, 1991;
Marchesini et~al., 2021). Automatizamos la generación de las redes con
un bucle \texttt{for} en Bash, iterando sobre cada umbral de
acumulación; para cada red generada (Figura
\ref{fig:redindiferenciada}), actualizamos la base de datos y creamos un
resumen con estadísticas básicas.

Para determinar la red hidrográfica óptima de alta densidad de República
Dominicana, realizamos una inspección visual de los tres resultados
generados a partir de los umbrales de acumulación elegidos (Figura
\ref{fig:redorden3umbrales}). Tras evaluar las redes, seleccionamos la
obtenida con el umbral de 540 celdas, por ajustarse a nuestros criterios
de selección. Sin embargo, para preservar la reproducibilidad de
nuestros resultados y facilitar eventuales aplicaciones futuras,
decidimos conservar todos las redes en la base de datos, incluyendo las
originadas a partir de los umbrales de 180 y 900 celdas. En concreto, la
red generada con el umbral 180 celdas, presenta un buen ajuste con las
vaguadas topográficas marcadas en el mapa topográfico (Figura
\ref{fig:redordenumbral180}).

A continuación, con el complemento \texttt{r.stream.order} de GRASS GIS,
calculamos la jerarquía de la red hidrográfica para cada uno de los
umbrales de acumulación previamente establecidos (180, 540 y 900
celdas), utilizando un bucle en Bash para automatizar el proceso. Este
análisis permitió obtener la jerarquía de la red hidrográfica de acuerdo
a los métodos de Strahler y Horton, ofreciendo información útil para
nuestros objetivos (Horton, 1945; Strahler, 1957).

Utilizando el complemento \texttt{r.stream.basins} de GRASS GIS,
delimitamos las cuencas y subcuencas según la jerarquía de red para cada
uno de los tres umbrales de acumulación. Este proceso permitió la
delimitación de unidades que incluyen, de forma indiferenciada, tanto
cuencas como subcuencas con redes de drenaje tributarias.
Posteriormente, aplicamos el mismo complemento para delimitar las
cuencas que desembocan en el mar, lagos, lagunas o pérdidas del karst,
excluyendo las subcuencas tributarias (e.g.~cuencas sin prolongación de
drenaje superficial fuera de ellas).

Finalizamos el procesamiento de hidrología computacional seleccionando
solo las cuencas generadas para el umbral de 540 celdas y las
convertimos en un modelo de datos vectorial utilizando el complemento
\texttt{r.to.vect} de GRASS GIS. Este procedimiento incluyó la creación
y actualización de una nueva columna \texttt{strahler} en la tabla de
atributos de cada capa vectorial para indicar el correspondiente orden
de red. Después de procesar y fusionar todas las cuencas de cada orden
en una única capa vectorial con \texttt{v.patch}, procedimos a limpiar y
preparar los datos para el análisis. Este paso, que incluyó la
corrección de topología, la actualización del área de cada cuenca con
\texttt{v.clean}, la eliminación de áreas espurias y artefactos, resultó
crítico para garantizar la precisión de nuestros resultados. Finalmente,
seleccionamos los datos válidos y los exportamos a un archivo de texto,
lo que nos proporcionó valiosas estadísticas del área para cada cuenca
con desembocadura en mares, lagos o en pérdidas kársticas, según el
orden Strahler para nuestro análisis posterior.

\hypertarget{resultados}{%
\section{Resultados}\label{resultados}}

La base de datos de cuencas hidrográficas delimitadas y la red de
drenaje extraída usando el umbral de acumulación de 540 celdas
(\textasciitilde8 ha), se ajustó bien a nuestros criterios óptimos de
selección. El modelo de red hidrográfica y la delimitación de cuencas
demostró coherencia, suficiente detalle y una diversidad sustancial a lo
largo del territorio dominicano, especialmente en las áreas de montaña,
proporcionando una representación hidrográfica precisa sin atenuar
patrones de variabilidad. Presentamos a continuación los principales
hallazgos, en forma de resúmenes estadísticos, de las cuencas y sus
redes de drenaje.

\hypertarget{cuencas-que-desembocan-en-mares-lagos-lagunas-o-en-puxe9rdidas-kuxe1rsticas}{%
\subsection{Cuencas que desembocan en mares, lagos, lagunas o en
pérdidas
kársticas}\label{cuencas-que-desembocan-en-mares-lagos-lagunas-o-en-puxe9rdidas-kuxe1rsticas}}

En el caso de las cuencas que desembocan en mares, lagos, lagunas o en
pérdidas kársticas, en total delimitamos 6941 cuencas hidrográficas
(Figura \ref{fig:cuencasordenestodas}). Predominan cuencas de gran
tamaño y anchura en los valles del Cibao y de San Juan, así como en la
periferia de la plataforma kárstica sudoriental. Por otro lado, las
cuencas medianas y de forma alargada con forma ligeramente ensanchada en
cabecera, tienden a concentrarse a lo largo del borde meridional de la
Cordillera Central y en el karst de la plataforma sudoriental. Las
cuencas más pequeñas, en cambio, se distribuyen de manera más uniforme a
través de los sistemas kársticos y zonas costeras. Entre todas las
cuencas delimitadas, se alcanzó una jerarquía de red máxima de ocho,
condición que sólo se observó en tres cuencas específicas: Yaque del
Sur, Yuna y Ozama.

La cuenca más extensa, correspondiente al río Yaque del Norte, cubre una
superficie de 6986~km\textsuperscript{2}, aunque sólo alcanzó orden
máximo de siete, seguida de las cuencas de los ríos Yuna
(4873~km\textsuperscript{2}) y Yaque del Sur
(4614~km\textsuperscript{2}), ambas con orden máximo de ocho (en la
siguiente sección, discutimos sobre la discrepancia entre las
superficies de cuencas obtenidas por nosotros y los tamaños publicados
en referencias existentes). El tamaño promedio de las cuencas es de
7~km\textsuperscript{2} y desviación estándar de
129~km\textsuperscript{2}, reflejando la diversidad de las cuencas
hidrográficas presentes en el país.

\begin{figure}

{\centering \includegraphics[width=0.8\linewidth]{figuras/cuencas-ordenes-todas} 

}

\caption{Cuencas según orden de Strahler de República Dominicana, y sus correspondientes redes de drenaje (sólo mostrando los cursos de orden 4 o superior). El umbral de acumulación usado para extraer la red fue de 540 celdas (aprox. 8 ha).}\label{fig:cuencasordenestodas}
\end{figure}

La mitad de las cuencas delimitadas tiene 0.36~km\textsuperscript{2} o
menos de superficie, el 25\% de las cuencas más grandes apenas supera
los 0.85~km\textsuperscript{2} y, de hecho, el 5\% más grande sólo
alcanza 5.6~km\textsuperscript{2} o más. Por lo tanto, la distribución
de las cuencas por tamaño presenta sesgo a la derecha (sesgo calculado,
39.8), con un importante número de cuencas pequeñas y pocas grandes, un
patrón bastante común en este tipo de conjunto de datos.

\begin{table}[H]

\caption{\label{tab:tablaordenesarea}Relación entre orden de red de Strahler y número de cuencas para el umbral de acumulación 540 celdas ($\sim$ 8 hectáreas)}
\centering
\begin{tabu} to \linewidth {>{\raggedleft}X>{\raggedleft}X>{\raggedleft}X>{\raggedleft}X}
\toprule
Orden de red (Strahler) & Número de cuencas & Área promedio & Área total\\
\midrule
1 & 4070 & 263837.3 & 1073817672\\
2 & 2029 & 956249.8 & 1940230776\\
3 & 606 & 3911578.6 & 2370416619\\
4 & 165 & 21414857.6 & 3533451511\\
5 & 46 & 111125189.5 & 5111758717\\
\addlinespace
6 & 19 & 517463997.1 & 9831815945\\
7 & 2 & 3979801647.7 & 7959603295\\
8 & 4 & 3708474023.0 & 14833896092\\
\bottomrule
\end{tabu}
\end{table}

Los estadísticos básicos de cuenca sugieren que los resultados obtenidos
fueron consistentes, pues observamos el típico decrecimiento exponencial
del número de cuencas en relación con el orden de red (ver Figura
\ref{fig:ordennumcuencas} y Tabla \ref{tab:tablaordenesarea}). En
segundo lugar, destaca un hecho particular reseñable: el número de
cuencas de orden siete es menor que el número de cuencas de orden ocho,
un hecho que afecta a la cuenca del Yaque del Norte que, con
independencia de su gran tamaño, no alcanza la jerarquía máxima.

\begin{figure}

{\centering \includegraphics[width=0.6\linewidth]{preprint_files/figure-latex/ordennumcuencas-1} 

}

\caption{Número de cuencas por órdenes de red de Strahler para el umbral de acumulación 540 celdas ($\sim$8 hectáreas)}\label{fig:ordennumcuencas}
\end{figure}

Una caracterización de las cuencas que alcanzan un orden cuatro o mayor
resulta también oportuna en este caso, dado que las cuencas de orden de
red inferior son muy numerosas y, por la naturaleza del DEM empleado, la
delimitación de las cuencas pequeñas es más propensa a error. Así,
enfocando nuestro análisis sólo en las cuencas de orden cuatro o mayor,
encontramos algunos patrones de interés que merecen mención.

Contabilizamos 235 cuencas de orden cuatro y mayor, lo que representa un
3.39\% del total nacional. Sin embargo, este pequeño porcentaje
representa, en términos de superficie, el 88.5\% del área total de
cuencas. En este subconjunto encontramos un tamaño mínimo de
2.37~km\textsuperscript{2}, promedio de 176~km\textsuperscript{2} y
desviación estándar de 129~km\textsuperscript{2}. La mitad de las
cuencas de orden cuatro y mayor 25.68~km\textsuperscript{2} o menos de
superficie y, aunque este subconjunto de cuencas tiene mejor
distribución, el sesgo a la derecha persiste (sesgo calculado 7.23).

\hypertarget{cuencas-y-subcuencas}{%
\subsection{Cuencas y subcuencas}\label{cuencas-y-subcuencas}}

Analizando las cuencas considerando sólo el orden de su red,

\hypertarget{red-de-drenaje}{%
\subsection{Red de drenaje}\label{red-de-drenaje}}

La longitud total de \emph{talwegs} obtenidos es de \#\#\# kilómetros,
con el río más largo extendiéndose por \#\#\# kilómetros. Este nivel de
detalle en la cartografía de ríos y corrientes supera significativamente
a los modelos previos existentes, permitiendo una mejor comprensión y
análisis de los patrones de flujo de agua en la República Dominicana
(Figura \ref{fig:redordennacional}).

\begin{figure}

{\centering \includegraphics[width=0.8\linewidth]{figuras/red-orden-nacional} 

}

\caption{Representación de la red hidrográfica dominicana simbolizando el grosor de los segmentos en función de su orden de red (método de Strahler). El orden máximo alcanzado fue de 8. Esta red fue generada usando un umbral de acumulación de 540 celdas ($\sim$8 ha)}\label{fig:redordennacional}
\end{figure}

En cuanto a la jerarquía de la red, se observó un rango desde \#\#\# (la
menor jerarquía) hasta \#\#\# (la mayor jerarquía), lo que indica una
diversidad significativa en la configuración de las corrientes de agua.
Esta jerarquía hidrográfica proporciona información valiosa para
comprender la estructura y el funcionamiento de las cuencas.

Además, la inclusión de las redes generadas con los umbrales de 180 y
900 celdas en la base de datos añade un nivel adicional de detalle y
versatilidad, ofreciendo diversas opciones para futuros estudios o
aplicaciones que requieran diferentes niveles de resolución. Cabe
mencionar que la red generada con un umbral de 180 celdas resultó en la
mayor cantidad de cuencas hidrográficas identificadas, mientras que la
red generada con el umbral de 900 celdas proporcionó las
representaciones más simplificadas de las cuencas.

En cuanto a la distribución de cursos según jerarquía hidrográfica, la
red generada con el umbral de 8 hectáreas alcanzó un orden máximo de 8
según los métodos de Strahler y Horton. Tanto la distribución del número
de cursos como la suma de longitudes según órdenes jerárquicos,
presentan un relación inversa exponencial.

\hypertarget{discusiuxf3n}{%
\section{Discusión}\label{discusiuxf3n}}

Por el énfasis que hemos puesto en la generación de la red hidrográfica
y la detallada metodología, nuestro trabajo es un artículo de datos y
metodológico a la vez.

Para lograr una rápida salida del trabajo, dejamos para futuras
investigaciones lo siguiente:

\begin{itemize}
\tightlist
\item
  Evaluación de precisión de la elevación.
\item
  Nuestro interés gira en torno a la aplicabilidad de la hidrografía
  sistemáticamente generada, no necesariamente a las métricas, pues el
  modelo digital de elevaciones usado tiene error, y la información de
  terreno es insuficiente.
\item
  El drenaje en las áreas de desembocadura, especialmente en los casos
  de Yuna y Yaque de Sur.
\item
  Morfometría de redes y morfometría de cuencas, para próximos trabajos.
\item
  Mejora de la hidrografía de las áreas llanas (esperaremos mejores
  fuentes de elevación, e.g.~TanDEM-X)
\item
  Las diferencias en cuanto a superficie de las cuencas, e.g.~Yuna y
  Yaque del Sur.
\item
  Análisis hortonianos exhaustivos.
\item
  Segregación de la red teórica y la red circulante.
\item
  Con respecto a la precisión posicional de la red, estimamos que es
  alta en sistemas montañosos no kársticos, y moderada en sistemas
  kársticos. En los sistemas kársticos en particular, nuestro mapa
  exhibe un grado ligeramente mayor de incertidumbre debido a la
  ausencia de un catálogo detallado y preciso de depresiones, como las
  dolinas, que en última instancia definen la topología y jerarquización
  de la red en estos relieves. Para subsanar esta carencia, generamos
  nuestro propio inventario de depresiones a partir del modelo de
  elevaciones seleccionado, aunque lo aplicamos con prudencia a la hora
  de determinar la ubicación de los sumideros reales donde el flujo se
  infiltra al karst. Es relevante mencionar que nuestra red podría
  presentar una precisión reducida en áreas urbanas y llanas, así como
  en terrenos con canales de riego. Sin embargo, este factor no impacta
  la relevancia de nuestro estudio, dado que se enfoca primordialmente
  en otros tipos de áreas.
\item
  En relación a las cuencas y redes de drenaje transfronterizas, es
  importante destacar que sólo se caracterizaron utilizando información
  la porción correspondiente al territorio dominicano. Como resultado,
  el orden de red máximo obtenido para estas redes podría no reflejar su
  orden real. Estas cuencas abarcan las de los ríos Artibonito,
  Pedernales y Masacre, además de varias cuencas menores dispersas a lo
  largo de la frontera. No obstante, una evaluación visual preliminar
  indica que la mencionada limitación no interfiere con el propósito de
  nuestro estudio. Además, en futuros trabajos, abordaremos estas
  cuencas de manera integral para proporcionar una visión más completa
  de su morfometría.
\item
  Para asegurar que los datos de elevación eran adecuados y precisos en
  términos de elevación, se debería validar el DEM con datos de puntos
  de verificación tomados con GNSS.
\end{itemize}

\hypertarget{declaraciuxf3n-de-conflicto-de-intereses}{%
\section*{Declaración de conflicto de
intereses}\label{declaraciuxf3n-de-conflicto-de-intereses}}
\addcontentsline{toc}{section}{Declaración de conflicto de intereses}

El autor y la autora de este artículo declaran que no tienen ningún
conflicto de interés con el contenido de este artículo.

\hypertarget{disponibilidad-de-datos-scripts-y-cuxf3digo}{%
\section*{Disponibilidad de datos, scripts y
código}\label{disponibilidad-de-datos-scripts-y-cuxf3digo}}
\addcontentsline{toc}{section}{Disponibilidad de datos, scripts y
código}

Los datos que respaldan los hallazgos de este estudio están disponibles
abiertamente en Zenodo en \url{https://doi.org/10.5281/zenodo.8146391}
(Martínez-Batlle y Izzo-Gioiosa, 2023). Los scripts utilizados para la
curación de datos, análisis y visualización están disponibles en esta
sección, así como en el repositorio de GitHub en
\url{https://github.com/geofis/red-hidrografica-densa-rd} y en Zenodo en
\url{} (\textbf{RELLENAR?}).

\newpage

\hypertarget{infosupl}{%
\section*{Información suplementaria}\label{infosupl}}
\addcontentsline{toc}{section}{Información suplementaria}

\beginsupplement

\hypertarget{suplemento-metodoluxf3gico-para-la-subsecciuxf3n-obtenciuxf3n-y-preprocesamiento-del-dem}{%
\subsection*{Suplemento metodológico para la subsección ``Obtención y
Preprocesamiento del
DEM''}\label{suplemento-metodoluxf3gico-para-la-subsecciuxf3n-obtenciuxf3n-y-preprocesamiento-del-dem}}
\addcontentsline{toc}{subsection}{Suplemento metodológico para la
subsección ``Obtención y Preprocesamiento del DEM''}

Los siguientes bloques de código cargan los paquetes de uso común a lo
largo de este cuaderno, así como funciones creadas por nosotros para
eficientizar las tareas de limpieza y representación de datos y mapas.
Igualmente, aprovechamos este bloque de código para declarar la ruta del
directorio donde se alojan los archivos fuente, la cual reaprovechamos
en distintas partes del código.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{conflicted}\SpecialCharTok{::}\FunctionTok{conflict\_prefer}\NormalTok{(}\StringTok{"select"}\NormalTok{, }\StringTok{"dplyr"}\NormalTok{)}
\NormalTok{conflicted}\SpecialCharTok{::}\FunctionTok{conflict\_prefer}\NormalTok{(}\StringTok{"filter"}\NormalTok{, }\StringTok{"dplyr"}\NormalTok{)}
\FunctionTok{library}\NormalTok{(raster)}
\FunctionTok{library}\NormalTok{(sf)}
\FunctionTok{library}\NormalTok{(kableExtra)}
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(gdalUtilities)}
\FunctionTok{library}\NormalTok{(e1071)}
\FunctionTok{source}\NormalTok{(}\StringTok{\textquotesingle{}R/funciones.R\textquotesingle{}}\NormalTok{)}
\NormalTok{dem\_proc\_dir }\OtherTok{\textless{}{-}} \StringTok{\textquotesingle{}estadisticos\textquotesingle{}}
\NormalTok{figuras }\OtherTok{\textless{}{-}} \StringTok{\textquotesingle{}figuras\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

Descargamos 42 escenas ALOS PALSAR RTC, específicamente los \emph{Hi-Res
Terrain Corrected}, desde el Centro de Archivo Activo Distribuido (DAAC)
del \href{https://asf.alaska.edu/}{Alaska Satellite Facility (ASF)} (ASF
DAAC, 2014), para posteriormente depurarlas y seleccionar las más
idóneas para unirlas en un mosaico creado como ráster virtual. La
descarga la realizamos por lotes, usando un \emph{script} de Python
provisto por el propio ASF.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{python download}\OperatorTok{{-}}\BuiltInTok{all}\OperatorTok{{-}}\DecValTok{2023}\OperatorTok{{-}}\DecValTok{0}\ErrorTok{4}\OperatorTok{{-}}\DecValTok{20\_00}\OperatorTok{{-}}\DecValTok{30}\OperatorTok{{-}}\FloatTok{00.}\ErrorTok{py}
\end{Highlighting}
\end{Shaded}

\begin{quote}
Al momento de realizarse esta investigación, la tendencia en el análisis
de datos geoespaciales apuntaba hacia enfoques basados en la nube, como
Google Earth Engine y Microsoft Planetary Computer. Nosotros usamos
regulamente estas plataformas en nuestras investigaciones, pero ciertos
algoritmos esenciales para el análisis hidrológico aún no se encuentran
disponibles en estos servicios. Por esta razón, nos vimos en la
necesidad de utilizar nuestros propios equipos informáticos (Intel(R)
Core(TM) i7-7700K CPU @ 4.20GHz, 64 GB de memoria RAM, unidad de estado
sólido NVMe, corriendo bajo Ubuntu 20.04) y, aunque conseguimos
paralelizar ciertos procesos, la mayoría de los algoritmos de
hidrolología computacional no utilizan eficientemente los múltiples
núcleos de los procesadores, resultando en una subutilización de la
capacidad de memoria y en procesamientos más lentos que los que
comúnmente se conseguirían en la nube.
\end{quote}

Identificamos las escenas necesarias para cubrir íntegramente la
República Dominicana, usando una búsqueda geográfica mediante polígono
delimitador en ASF. Dado que la misión del ALOS-PALSAR ofrece escenas de
distintas fechas para una misma área, las descargamos todas y
posteriormente excluimos del análisis las redundantes, conservando
siempre la más reciente. Utilizando el índice de huellas de escenas,
escribimos un pequeño programa para seleccionar las más recientes allí
donde hubiese redundancia. Con esto construimos un índice de DEM para
guiarnos durante la construcción del ráster virtual.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ind\_orig }\OtherTok{\textless{}{-}} \FunctionTok{invisible}\NormalTok{(}
  \FunctionTok{st\_read}\NormalTok{(}\StringTok{\textquotesingle{}alos{-}palsar{-}dem{-}rd/asf{-}datapool{-}results{-}2023{-}04{-}19\_08{-}31{-}26.geojson\textquotesingle{}}\NormalTok{,}
          \AttributeTok{quiet =}\NormalTok{ T)) }\SpecialCharTok{\%\textgreater{}\%} 
   \FunctionTok{rownames\_to\_column}\NormalTok{(}\StringTok{\textquotesingle{}fila\textquotesingle{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{fila =} \FunctionTok{as.integer}\NormalTok{(fila))}
\NormalTok{distancias }\OtherTok{\textless{}{-}}\NormalTok{ ind\_orig }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{st\_centroid}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{st\_distance}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ units}\SpecialCharTok{::}\FunctionTok{drop\_units}\NormalTok{()}
\NormalTok{distancias[}\FunctionTok{upper.tri}\NormalTok{(distancias, }\AttributeTok{diag =}\NormalTok{ T)] }\OtherTok{\textless{}{-}} \ConstantTok{NA}
\NormalTok{indices }\OtherTok{\textless{}{-}} \FunctionTok{which}\NormalTok{(distancias }\SpecialCharTok{\textless{}} \DecValTok{1000}\NormalTok{, }\AttributeTok{arr.ind =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{duplicados }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(indices) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{dup\_id =} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{nrow}\NormalTok{(indices)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pivot\_longer}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{dup\_id, }\AttributeTok{names\_to =} \StringTok{\textquotesingle{}tipo\textquotesingle{}}\NormalTok{, }\AttributeTok{values\_to =} \StringTok{\textquotesingle{}fila\textquotesingle{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{tipo)}
\NormalTok{seleccionados }\OtherTok{\textless{}{-}}\NormalTok{ duplicados }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{inner\_join}\NormalTok{(ind\_orig }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{select}\NormalTok{(fila, startTime) }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ st\_drop\_geometry) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(dup\_id) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{(startTime }\SpecialCharTok{==} \FunctionTok{max}\NormalTok{(startTime)) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{pull}\NormalTok{(fila)}
\NormalTok{ind\_orig\_sel }\OtherTok{\textless{}{-}}\NormalTok{ ind\_orig }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\NormalTok{fila }\SpecialCharTok{\%in\%}\NormalTok{ duplicados}\SpecialCharTok{$}\NormalTok{fila }\SpecialCharTok{|}\NormalTok{ fila }\SpecialCharTok{\%in\%}\NormalTok{ seleccionados) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(centerLon }\SpecialCharTok{\textless{}} \SpecialCharTok{{-}}\FloatTok{72.1821}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ind\_orig\_sel }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{select}\NormalTok{(sceneName, startTime) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{st\_drop\_geometry}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{estilo\_kable}\NormalTok{(}\AttributeTok{titulo =} \FunctionTok{paste}\NormalTok{(}\StringTok{\textquotesingle{}Escenas ALOS{-}PALSAR usadas para generar un DEM de 12.5 m de}
\StringTok{                        resolución espacial de República Dominicana\textquotesingle{}}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{table}[H]

\caption{\label{tab:tablaindice}Escenas ALOS-PALSAR usadas para generar un DEM de 12.5 m de
                        resolución espacial de República Dominicana}
\centering
\begin{tabu} to \linewidth {>{\raggedright}X>{\raggedright}X}
\toprule
sceneName & startTime\\
\midrule
ALPSRP253240380 & 2010-10-25 23:18:16\\
ALPSRP253240370 & 2010-10-25 23:18:08\\
ALPSRP253240360 & 2010-10-25 23:17:59\\
ALPSRP253240350 & 2010-10-25 23:17:51\\
ALPSRP252510370 & 2010-10-20 23:11:46\\
\addlinespace
ALPSRP252510360 & 2010-10-20 23:11:38\\
ALPSRP252510350 & 2010-10-20 23:11:30\\
ALPSRP251490380 & 2010-10-13 23:22:45\\
ALPSRP251490370 & 2010-10-13 23:22:36\\
ALPSRP251490360 & 2010-10-13 23:22:28\\
\addlinespace
ALPSRP251490350 & 2010-10-13 23:22:20\\
ALPSRP251490340 & 2010-10-13 23:22:12\\
ALPSRP250760380 & 2010-10-08 23:16:23\\
ALPSRP250760370 & 2010-10-08 23:16:15\\
ALPSRP250760360 & 2010-10-08 23:16:06\\
\addlinespace
ALPSRP250760350 & 2010-10-08 23:15:58\\
ALPSRP250030360 & 2010-10-03 23:09:44\\
ALPSRP250030350 & 2010-10-03 23:09:36\\
ALPSRP248280370 & 2010-09-21 23:14:21\\
ALPSRP248280360 & 2010-09-21 23:14:13\\
\addlinespace
ALPSRP248280350 & 2010-09-21 23:14:05\\
ALPSRP247260360 & 2010-09-14 23:25:03\\
ALPSRP247260350 & 2010-09-14 23:24:55\\
ALPSRP247260340 & 2010-09-14 23:24:47\\
ALPSRP242300380 & 2010-08-11 23:21:28\\
\addlinespace
ALPSRP242300370 & 2010-08-11 23:21:19\\
ALPSRP242300360 & 2010-08-11 23:21:11\\
ALPSRP242300350 & 2010-08-11 23:21:03\\
\bottomrule
\end{tabu}
\end{table}

En total, para cubrir el territorio de República Dominicana, necesitamos
28 de escenas únicas ALOS PALSAR RTC. Señalamos en este punto un detalle
relevante para el análisis hidrológico. Las escenas correspondientes a
la porción haitiana del río Artibonito, no las procesamos en este
estudio, a efectos de agilizar la producción de resultados. No obstante,
dicha tarea nos quedó pendiente para futuras investigaciones.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ind\_orig\_sel\_m }\OtherTok{\textless{}{-}}\NormalTok{ ind\_orig\_sel }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  ggplot }\SpecialCharTok{+}
  \FunctionTok{geom\_sf}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.6}\NormalTok{, }\AttributeTok{fill =} \StringTok{\textquotesingle{}grey90\textquotesingle{}}\NormalTok{, }\AttributeTok{color =} \StringTok{\textquotesingle{}grey20\textquotesingle{}}\NormalTok{, }\AttributeTok{size =} \FloatTok{0.5}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_sf}\NormalTok{(}\AttributeTok{data =}\NormalTok{ pais, }\AttributeTok{fill =} \StringTok{\textquotesingle{}transparent\textquotesingle{}}\NormalTok{, }\AttributeTok{color =} \StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_sf\_label}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{label =}\NormalTok{ sceneName), }\AttributeTok{color =} \StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{, }\AttributeTok{size =} \FloatTok{1.5}\NormalTok{,}
                \AttributeTok{label.padding =} \FunctionTok{unit}\NormalTok{(}\FloatTok{0.1}\NormalTok{, }\StringTok{"lines"}\NormalTok{), }\AttributeTok{alpha =} \FloatTok{0.9}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{11}\NormalTok{)) }\SpecialCharTok{+}
\NormalTok{  ggspatial}\SpecialCharTok{::}\FunctionTok{annotation\_scale}\NormalTok{(}\AttributeTok{style =} \StringTok{\textquotesingle{}ticks\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Usando como referencia el índice de escenas seleccionadas, extrajimos
los DEM correspondientes, incluidos en formato GTiff dentro de los
archivos comprimidos (\texttt{.zip}). Este formato es proporcionado por
el Alaska Satellite Facility para minimizar el uso del ancho de banda
durante las descargas, lo que resulta beneficioso para el rendimiento de
sus servidores. A pesar de estar comprimidos, la descompresión de estos
archivos no supone un proceso largo o laborioso.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{zip\_path }\OtherTok{\textless{}{-}} \StringTok{\textquotesingle{}alos{-}palsar{-}dem{-}rd/\textquotesingle{}}
\FunctionTok{sapply}\NormalTok{(ind\_orig\_sel}\SpecialCharTok{$}\NormalTok{fileName, }
       \ControlFlowTok{function}\NormalTok{(x)}
         \FunctionTok{unzip}\NormalTok{(}
           \AttributeTok{zipfile =} \FunctionTok{paste0}\NormalTok{(zip\_path, x),}
           \AttributeTok{exdir =} \FunctionTok{paste0}\NormalTok{(zip\_path, }\StringTok{\textquotesingle{}dem\textquotesingle{}}\NormalTok{), }\AttributeTok{junkpaths =}\NormalTok{ T,}
           \AttributeTok{files =} \FunctionTok{paste0}\NormalTok{(}\FunctionTok{gsub}\NormalTok{(}\StringTok{\textquotesingle{}.zip\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{, x), }\StringTok{\textquotesingle{}/\textquotesingle{}}\NormalTok{, }\FunctionTok{gsub}\NormalTok{(}\StringTok{\textquotesingle{}zip\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}dem.tif\textquotesingle{}}\NormalTok{, x)))}
\NormalTok{       )}
\end{Highlighting}
\end{Shaded}

Todos los DEM fueron proporcionados por ASF en el sistema de coordenadas
Universal Transversal de Mercator (UTM). Sin embargo, los situados al
oeste fueron suministrados en el huso 18N. Identificamos estos DEM y los
transformamos al huso 19N, que es el que corresponde a nuestra área, con
el objetivo de generar un producto continuo. Para realizar esta
transformación, empleamos la herramienta \texttt{gdalwarp} de la
biblioteca GDAL (GDAL/OGR contributors, 2022).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dems\_orig\_path }\OtherTok{\textless{}{-}} \FunctionTok{list.files}\NormalTok{(}\AttributeTok{path =} \StringTok{\textquotesingle{}alos{-}palsar{-}dem{-}rd/dem\textquotesingle{}}\NormalTok{,}
                             \AttributeTok{pattern =} \StringTok{\textquotesingle{}*dem.tif\textquotesingle{}}\NormalTok{, }\AttributeTok{full.names =}\NormalTok{ T)}
\NormalTok{crs\_18n }\OtherTok{\textless{}{-}} \FunctionTok{names}\NormalTok{(}\FunctionTok{which}\NormalTok{(}\FunctionTok{sapply}\NormalTok{(dems\_orig\_path, }\ControlFlowTok{function}\NormalTok{(x)\{}
\NormalTok{  crs\_x }\OtherTok{\textless{}{-}} \FunctionTok{gdal\_crs}\NormalTok{(x)}
\NormalTok{  is\_z18 }\OtherTok{\textless{}{-}} \FunctionTok{grepl}\NormalTok{(}\StringTok{\textquotesingle{}zone 18N\textquotesingle{}}\NormalTok{, crs\_x[[}\StringTok{\textquotesingle{}wkt\textquotesingle{}}\NormalTok{]])}
\NormalTok{\})))}
\FunctionTok{sapply}\NormalTok{(crs\_18n, }\ControlFlowTok{function}\NormalTok{(x) }\FunctionTok{file.rename}\NormalTok{(}\AttributeTok{from =}\NormalTok{ x, }\AttributeTok{to =} \FunctionTok{gsub}\NormalTok{(}\StringTok{\textquotesingle{}.tif\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}\_z18n.tif\textquotesingle{}}\NormalTok{, x)))}
\NormalTok{crs\_18n\_ren }\OtherTok{\textless{}{-}} \FunctionTok{list.files}\NormalTok{(}\AttributeTok{path =} \StringTok{\textquotesingle{}alos{-}palsar{-}dem{-}rd/dem\textquotesingle{}}\NormalTok{,}
                          \AttributeTok{pattern =} \StringTok{\textquotesingle{}z18n.tif\textquotesingle{}}\NormalTok{, }\AttributeTok{full.names =}\NormalTok{ T)}
\FunctionTok{sapply}\NormalTok{(crs\_18n\_ren, }\ControlFlowTok{function}\NormalTok{(x)\{}
  \FunctionTok{gdalwarp}\NormalTok{(}
  \AttributeTok{srcfile =}\NormalTok{ x,}
  \AttributeTok{dstfile =} \FunctionTok{gsub}\NormalTok{(}\StringTok{\textquotesingle{}\_z18n.tif\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}.tif\textquotesingle{}}\NormalTok{, x), }
  \AttributeTok{t\_srs =} \StringTok{\textquotesingle{}EPSG:32619\textquotesingle{}}\NormalTok{, }\AttributeTok{overwrite =}\NormalTok{ T)\})}
\end{Highlighting}
\end{Shaded}

A efectos de eficientizar la manipulación del DEM, creamos un ráster
virtual (VRT) usando la herramienta \texttt{gdalbuildvrt} de la
biblioteca GDAL. Un ráster virtual es básicamente la abstracción de una
imagen que se genera \emph{on the fly}, creado a partir de un índice de
tamaño pequeño, en formato XML, que apunta a los archivos originales sin
moverlos ni alterarlos. Tienen las mismas prestaciones que las imágenes
guardadas permanentes guardadas en disco, por lo que con un ráster
virtual podemos visualizar un mosaico continuo o realizar análisis
intermedios, o evaluar un producto antes de crearlo de forma definitiva.
Se trata de un formato muy eficiente que ayuda a ahorrar espacio en
disco.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{gdalbuildvrt}\NormalTok{(}\AttributeTok{gdalfile =}\NormalTok{ dems\_orig\_path,}
             \AttributeTok{output.vrt =} \FunctionTok{paste0}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(zip\_path, }\StringTok{\textquotesingle{}dem\textquotesingle{}}\NormalTok{), }\StringTok{\textquotesingle{}/dem\_seamless.vrt\textquotesingle{}}\NormalTok{),}
             \AttributeTok{resolution =} \StringTok{\textquotesingle{}highest\textquotesingle{}}\NormalTok{, }\AttributeTok{r =} \StringTok{\textquotesingle{}average\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Posterioremente, creamos la base de datos y localización de GRASS GIS
usando como fuente de extensión y resolución el ráster virtual (GRASS
Development Team, 2023). Decidimos usar GRASS GIS a partir de este punto
para prácticamente todas las tareas de análisis geoespacial e
hidrológico, pues se trata de un software bastante eficiente en muchos
de sus complementos y algoritmos de serie (e.g.~rellenado de nulos). Sin
embargo, en pasos posteriores, alternamos el flujo de procesamiento con
otras herramientas, como WhiteboxTools (Lindsay, 2018). En todo caso,
nuestro criterio fue siempre aprovechar al máximo los recursos de
hardware y software disponibles para obtener los productos requeridos en
el menor tiempo posible.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Usando Bash, desde la ruta ./alos{-}palsar{-}dem{-}rd/dem}
\ExtensionTok{grass} \AttributeTok{{-}{-}text} \AttributeTok{{-}c}\NormalTok{ dem\_seamless.vrt ./grassdata}
\CommentTok{\# Para abrir luego de cerrada: grass grassdata/PERMANENT/}
\end{Highlighting}
\end{Shaded}

Luego creamos una máscara de país en QGIS (QGIS Development Team, 2021),
superponiendo el límite oficial obtenido desde la página de la
\href{https://www.one.gob.do/}{Oficina Nacional de Estadística (ONE)}, y
combinándolo con otras fuentes disponibles en línea, como
\href{https://gadm.org/}{GADM},
\href{https://data.humdata.org/dataset/cod-ab-dom}{Humanitarian Data
Exchange (OCHA)} y \href{https://www.openstreetmap.org}{OpenStreetMap}
(GADM, 2022; OCHA, 2022; Oficina Nacional de Estadística (ONE), 2018;
OpenStreetMap contributors, 2017). De la máscara, eliminamos las
superficies de máximas de lagos y lagunas no artificiales, pues nos
interesa procesar las cuencas endorreicas que drenan hacia ellos. No
obstante, los embalses no los incluimos en dicha superficie, dado que
necesitamos construir la jerarquía de red ignorando su presencia, es
decir, asumiendo como continuos todos los cursos fluviales. Sobre esta
máscara, creamos un área de influencia, para recortar el DEM con un
cierto ``acolchado'' que nos permitiera análizar sin dificultades las
áreas costeras y de frontera. La creación de esta máscara fue el único
paso que realizamos de forma semimanual, pues el resto del flujo de
procesamiento lo realizamos con algoritmo automáticos.

Posteriormente, importamos la máscara generada a la base de datos de
GRASS y la aplicamos. GRASS opera de forma eficiente, circunscribiendo
la aplicación de los algoritmos al área definida como máscara. Las áreas
fuera de ésta son excluidas, eficientizando los recursos y evitando
malgastar tiempo de CPU en áreas que ajenas al proyecto.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Importar máscara}
\ExtensionTok{v.import}\NormalTok{ input=mascara{-}1km.gpkg output=mascara\_1km}

\CommentTok{\# Fijar máscara}
\ExtensionTok{r.mask} \AttributeTok{{-}r}
\ExtensionTok{r.mask}\NormalTok{ vector=mascara\_1km}

\CommentTok{\# Ver ambiente}
\ExtensionTok{g.gisenv}
\CommentTok{\#\# GISDBASE=/media/jose/datos/alos{-}palsar{-}dem{-}rd/dem}
\CommentTok{\#\# LOCATION\_NAME=grassdata}
\CommentTok{\#\# MAPSET=PERMANENT}
\CommentTok{\#\# GUI=text}
\CommentTok{\#\# PID=1632142}
\end{Highlighting}
\end{Shaded}

Importamos el ráster virtual a la base de datos de GRASS GIS con la
herramienta \texttt{r.import}. Con este paso generamos un mapa ráster
dentro de la base de datos GRASS GIS, el cual es una realización con
celdas manipulables y a la que le podemos aplicar algoritmos ráster de
nuestra preferencia.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Importar DEM a región de GRASS}
\BuiltInTok{time}\NormalTok{ r.import }\AttributeTok{{-}{-}overwrite}\NormalTok{ input=dem\_seamless.vrt output=dem}
\CommentTok{\#\# real }

\CommentTok{\# Ver en lista (q para salir)}
\ExtensionTok{g.list}\NormalTok{ type=raster}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics[width=0.8\linewidth]{figuras/dem-sin-procesar} 

}

\caption{DEM sin procesar, representado como relieve sombreado. Nótesense los píxeles sin datos, destacados en color rojo (Los Patos-Ojeda-Paraíso, provincia Barahona, sudoeste de República Dominicana)}\label{fig:demsinprocesar}
\end{figure}

A continuación, rellenamos las celdas con valor nulo (sin datos) por
medio del eficiente complemento de GRASS \texttt{r.fill.nulls}. Lo
configuramos para rellenar píxeles nulos usando interpolación
\emph{spline} bilineal con regularización Tykhonov (\emph{spline} es un
método de descomposición de curvas en porciones descritas por
polinomios).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Rellenar vacíos}
\BuiltInTok{time}\NormalTok{ r.fillnulls }\AttributeTok{{-}{-}overwrite} \AttributeTok{{-}{-}verbose} \DataTypeTok{\textbackslash{}}
\NormalTok{  input=dem method=}\StringTok{"bilinear"} \DataTypeTok{\textbackslash{}}
\NormalTok{  tension=40 smooth=0.1 edge=3 npmin=600 segmax=300 lambda=0.01 }\DataTypeTok{\textbackslash{}}
\NormalTok{  output=dem\_relleno}
\CommentTok{\# Enviar mensaje al finalizar (ejecutar conjuntamente con anterior)}
\BuiltInTok{echo} \StringTok{"Job finished"} \KeywordTok{|} \ExtensionTok{mail} \AttributeTok{{-}s} \StringTok{"Job finished"}\NormalTok{ USUARIO@MAIL}
\CommentTok{\#\# real 10m11.925s}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics[width=0.8\linewidth]{figuras/dem-relleno} 

}

\caption{DEM sin procesar, representado como relieve sombreado. Los píxeles sin datos fueron eliminados (Los Patos-Ojeda-Paraíso, provincia Barahona, sudoeste de República Dominicana)}\label{fig:demrelleno}
\end{figure}

En el siguiente paso suavizamos el DEM preservando morfologías. Para
esto usamos la herramienta \emph{FeaturePreservingSmoothing} de
WhiteboxTools, la cual reduce la rugosidad generada por el ruido en el
DEM (Lindsay, 2018; Lindsay et~al., 2019). Para aplicar esta
herramienta, primero exportamos el DEM desde la base de datos de GRASS
GIS a archivo GeoTIFF, y posteriormente aplicamos el suavizado.
Finalmente, importamos el DEM suavizado nuevamente a la base de datos de
GRASS GIS para continuar el procesamiento en dicha aplicación.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Exportar a GTiff con compresión LZW}
\BuiltInTok{time}\NormalTok{ r.out.gdal }\AttributeTok{{-}{-}overwrite} \AttributeTok{{-}{-}verbose}\NormalTok{ createopt=}\StringTok{"COMPRESS=LZW,BIGTIFF=YES"} \DataTypeTok{\textbackslash{}}
\NormalTok{  input=dem\_relleno }\DataTypeTok{\textbackslash{}}
\NormalTok{  format=GTiff type=Float64 output=dem\_relleno.tif}
\CommentTok{\# Enviar mensaje al finalizar (ejecutar conjuntamente con anterior)}
\BuiltInTok{echo} \StringTok{"Job finished"} \KeywordTok{|} \ExtensionTok{mail} \AttributeTok{{-}s} \StringTok{"Job finished"}\NormalTok{ USUARIO@MAIL}
\CommentTok{\#\# real 0m58.924s}

\CommentTok{\# Comenzó a 23.20 de 22 de abril}
\BuiltInTok{time}\NormalTok{ \textasciitilde{}/WhiteboxTools\_linux\_amd64/WBT/whitebox\_tools }\DataTypeTok{\textbackslash{}}
  \AttributeTok{{-}{-}wd}\OperatorTok{=}\StringTok{\textquotesingle{}/media/jose/datos/alos{-}palsar{-}dem{-}rd/dem/\textquotesingle{}} \DataTypeTok{\textbackslash{}}
  \AttributeTok{{-}{-}filter}\OperatorTok{=}\NormalTok{25 }\AttributeTok{{-}{-}norm\_diff}\OperatorTok{=}\NormalTok{45 }\AttributeTok{{-}{-}num\_iter}\OperatorTok{=}\NormalTok{5 }\DataTypeTok{\textbackslash{}}
  \AttributeTok{{-}{-}run}\OperatorTok{=}\NormalTok{FeaturePreservingSmoothing }\AttributeTok{{-}{-}input}\OperatorTok{=}\StringTok{\textquotesingle{}dem\_relleno.tif\textquotesingle{}} \DataTypeTok{\textbackslash{}}
  \AttributeTok{{-}{-}output}\OperatorTok{=}\StringTok{\textquotesingle{}dem\_relleno\_suavizado.tif\textquotesingle{}} \AttributeTok{{-}v}
\CommentTok{\# Enviar mensaje al finalizar (ejecutar conjuntamente con anterior)}
\BuiltInTok{echo} \StringTok{"Job finished"} \KeywordTok{|} \ExtensionTok{mail} \AttributeTok{{-}s} \StringTok{"Job finished"}\NormalTok{ USUARIO@MAIL}
\CommentTok{\#\# real 9min46.103s}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics[width=0.8\linewidth]{figuras/dem-suavizado} 

}

\caption{DEM suavizado, representado como relieve sombreado. Nótese la conservación de las morfologías principales y la eliminación del ruido sobre éstas (Los Patos-Ojeda-Paraíso, provincia Barahona, sudoeste de República Dominicana)}\label{fig:demsuavizado}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\BuiltInTok{time}\NormalTok{ r.import input=dem\_relleno\_suavizado.tif output=dem\_suavizado}
\BuiltInTok{echo} \StringTok{"Job finished"} \KeywordTok{|} \ExtensionTok{mail} \AttributeTok{{-}s} \StringTok{"Job finished"}\NormalTok{ USUARIO@MAIL}
\CommentTok{\#\# real 0m21.593s}
\end{Highlighting}
\end{Shaded}

A continuación, usamos el ráster de altura de geoide de La Española a 1
minuto de resolución (EGM2008) para obtener alturas pseudo-ortométricas,
por medio de una suma algebraica simple de este ráster y el DEM
suavizado en GRASS GIS con la herramienta \texttt{r.mapcalc}. Sin
embargo, previamente fue necesario aumentar la resolución del ráster de
altura del geoide antes de realizar la suma. Para esto, usamos
\texttt{r.resamp.rst} (evaluamos una segunda alternativa con el
complemento \texttt{r.resamp.interp} y, aunque realizó el trabajo
eficientemente, eliminó muchas áreas limítrofes, por lo que preferimos
no utilizarlo).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Importar DEM a región de GRASS}
\ExtensionTok{r.import} \AttributeTok{{-}{-}overwrite}\NormalTok{ input=egm2008{-}1\_espanola.tif output=egm2008\_1min}

\CommentTok{\# Ver en lista (q para salir)}
\ExtensionTok{g.list}\NormalTok{ type=raster}

\CommentTok{\# Ver atributos de la región}
\ExtensionTok{g.region} \AttributeTok{{-}p}

\CommentTok{\# Alternativa 1. Usando r.resamp.rst. Más eficiente y precisa}
\CommentTok{\# Fijar la región al geoide importado}
\ExtensionTok{g.region}\NormalTok{ raster=egm2008\_1min }\AttributeTok{{-}ap}
\CommentTok{\# Realizar la interpolación}
\ExtensionTok{r.resamp.rst} \AttributeTok{{-}{-}overwrite}\NormalTok{ input=egm2008\_1min ew\_res=50 ns\_res=50 elevation=egm2008\_hires}
\BuiltInTok{echo} \StringTok{"Job finished"} \KeywordTok{|} \ExtensionTok{mail} \AttributeTok{{-}s} \StringTok{"Job finished"}\NormalTok{ USUARIO@MAIL}
\CommentTok{\#\# real }
\CommentTok{\# Fijar región a nuevo geoide}
\ExtensionTok{g.region}\NormalTok{ raster=egm2008\_hires }\AttributeTok{{-}ap}

\CommentTok{\# Alternativa 2. Usando r.resamp.interp. También eficiente, pero eliminar áreas de borde}
\CommentTok{\# g.region res=50 {-}ap}
\CommentTok{\# r.resamp.interp {-}{-}overwrite input=egm2008\_1min \textbackslash{}}
\CommentTok{\#  output=egm2008\_hires method=bilinear}

\CommentTok{\# Exportar para explorar visualmente}
\CommentTok{\# r.out.gdal {-}{-}overwrite {-}{-}verbose createopt="COMPRESS=LZW" \textbackslash{}}
\CommentTok{\#  input=egm2008\_hires \textbackslash{}}
\CommentTok{\#  format=GTiff type=Float64 output=egm2008\_hires.tif}

\CommentTok{\# Volver a resolución de DEM rellenado y suavizado}
\ExtensionTok{g.region}\NormalTok{ raster=dem\_suavizado }\AttributeTok{{-}ap}

\CommentTok{\# Aplicar álgebra de mapas}
\ExtensionTok{r.mapcalc} \AttributeTok{{-}{-}overwrite} \StringTok{"dem\_pseudo\_ortometrico = dem\_suavizado {-} egm2008\_hires"}

\CommentTok{\#Estadísticos univariados}
\ExtensionTok{r.univar}\NormalTok{ dem\_pseudo\_ortometrico}
\CommentTok{\# n: 306462417}
\CommentTok{\# minimum: {-}51.4456}
\CommentTok{\# maximum: 3102.34}
\CommentTok{\# range: 3153.79}
\CommentTok{\# mean: 403.703}
\CommentTok{\# mean of absolute values: 403.858}
\CommentTok{\# standard deviation: 487.27}
\CommentTok{\# variance: 237432}
\CommentTok{\# variation coefficient: 120.7 \%}
\CommentTok{\# sum: 123719658638.311}
\end{Highlighting}
\end{Shaded}

El resumen estadístico proporcionado por la herramienta
\texttt{r.univar} de GRASS GIS, usando la máscara ajustada a los límites
costeros e internacional del país, informa que la elevación mínima es
-51.5 m, mientras que la máxima es 3102.34 m, para un rango de casi 3154
m. El valor mínimo probablemente no está bien recogido, debido a que la
máscara empleada podría estar eliminando elevaciones muy bajas en el
área de la Hoya de Enriquillo. La elevación media, considerando tanto
los negativos como los positivos, es de aproximadamente 404 m, con
desviación estándar de 487 m y coeficiente de variación de 121\%.
Remarcamos que, aunque ASF advierte de no usar este modelo para fines de
elevación, el valor máximo se ajusta bastante a la elevación máxima
conocida en República Dominicana, que es el pico Duarte (Instituto
Geográfico Nacional, 2022).

\begin{figure}

{\centering \includegraphics[width=0.8\linewidth]{figuras/perfiles-dem/los-patos} 

}

\caption{Alturas respecto de geoide EGM08 ($\sim$ortométrica) y sobre elipsoide WGS84, de un transecto descendente desde Bahoruco Oriental al Mar Caribe (Los Patos-Ojeda-Paraíso, provincia Barahona, sudoeste de República Dominicana)}\label{fig:alturasgeoideelipsoide}
\end{figure}

A continuación, efectuamos el procedimiento de tallado o grabado de una
red preexistente sobre el DEM, conocido como \emph{stream burning}
(Lindsay, 2016). Con este procedimiento, logramos que los píxeles del
DEM intersectados con el vectorial de la red preexistente, adquieran un
valor muy bajo respecto de su entorno, para asegurar que los algoritmos
automáticos de análisis hidrológico dirijan el flujo a través de los
lechos de ríos establecidos. El tallado es particularmente útil, incluso
esencial, en áreas planas, ya que ayuda a los algoritmos autómáticos a
producir redes hidrográficas más realistas y topológicamente correctas.
Sin embargo, su aplicación de requiere de una cuidadosa selección de la
red preexistente a tallar. Para crearla, usamos una red de drenaje de
cursos fluviales seleccionados, que incluyó sólo los de gran longitud,
comúnmente ríos permamentes, de lecho ancho y claramente establecidos.
Nos apoyamos en imágenes satelitales (Google; Airbus, CNES; Airbus,
Landsat; Copernicus; Maxar Technologies; U.S. Geological Survey, 2023)
y, ocasionalmente, en el MTN-50K (Instituto Cartográfico Militar (ICM),
1989). Complementamos con OpenStreetMap contributors (2017), ya que este
servicio provee información vectorial de fácil acceso y precisa. El
resultado consistió en una red de cursos largos seleccionados de
República Dominicana, representada por los ríos Artibonito, Yaque del
Norte, Yuna, Yaque del Sur, varios ríos del extremo meridional de la
cordillera Central y del borde sudoriental del país, así como algunos
ríos seleccionados de la cordillera Septentrional.

\begin{figure}

{\centering \includegraphics[width=0.8\linewidth]{figuras/red-cursos-largos} 

}

\caption{Mapa de la red de cursos largos creada para el estudio a partir de varias fuentes (más detalles, en el texto).}\label{fig:redcursoslargos}
\end{figure}

Nuestra de red cursos largos contiene varios ríos que atraviesan amplios
valles y karsts, por lo son comunes los tramos que cruzan zonas
complicadas para la conducción del flujo donde probablemente el error
posicional de las líneas es mayor. Cabe también señalar que, para
asegurar la continuidad topológica de la red, dimos un tratamiento
especial a los ríos que llenan embalses, los cuales representamos por
medio trazados históricos obtenidos del MTN-50K, omitiendo así la
presencia de los embalses.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Importar red a GRASS}
\ExtensionTok{v.import} \AttributeTok{{-}{-}overwrite}\NormalTok{ input=red\_mtn50k\_cleaned\_largos.gpkg }\DataTypeTok{\textbackslash{}}
\NormalTok{  output=red\_mtn50k\_cleaned\_largos}
\CommentTok{\# Ver mapa importado en lista (q para salir)}
\ExtensionTok{g.list}\NormalTok{ type=vector}
\CommentTok{\# Calcular y pasar a archivo, la longitud de cursos}
\CommentTok{\# y número de segmentos (ejecutar en casos de actualización)}
\ExtensionTok{v.to.db} \AttributeTok{{-}p}\NormalTok{ option=length map=red\_mtn50k\_cleaned\_largos }\OperatorTok{\textgreater{}} \DataTypeTok{\textbackslash{} }
  \ExtensionTok{stats\_length\_red\_mtn50k\_cleaned\_largos.txt}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{stats\_red\_mtn50k\_largos }\OtherTok{\textless{}{-}} \FunctionTok{read\_delim}\NormalTok{(}
  \FunctionTok{paste0}\NormalTok{(dem\_proc\_dir, }\StringTok{\textquotesingle{}/\textquotesingle{}}\NormalTok{,}
         \StringTok{\textquotesingle{}stats\_length\_red\_mtn50k\_cleaned\_largos.txt\textquotesingle{}}\NormalTok{),}
  \AttributeTok{progress =}\NormalTok{ F, }\AttributeTok{show\_col\_types =}\NormalTok{ F)}
\NormalTok{n\_seg\_red\_mtn50k\_largos }\OtherTok{\textless{}{-}}\NormalTok{ stats\_red\_mtn50k\_largos }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\NormalTok{cat}\SpecialCharTok{=={-}}\DecValTok{1}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ nrow}
\NormalTok{length\_mtn50k\_largos }\OtherTok{\textless{}{-}}\NormalTok{ stats\_red\_mtn50k\_largos }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\NormalTok{cat}\SpecialCharTok{=={-}}\DecValTok{1}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{pull}\NormalTok{(length) }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ sum}\SpecialCharTok{/}\DecValTok{1000}
\end{Highlighting}
\end{Shaded}

Finalmente, importamos nuestra red de cursos largos a la base de datos
de GRASS GIS y generamos estadísticas básicas. Se trata de una red
compuesta por \textbf{1047 segmentos} que suman un total de
\textbf{4895.88 kilómetros} de longitud. Cabe señalar que esta red no
tiene valor hidrográfico, pues, como indicamos, ignora los lagos para
garantizar la integridad topológica. Desaconsejamos su uso para otro fin
que no sea el grabado de un DEM.

El siguiente paso consistió en realizar el \emph{stream burning}
(tallado) de la red de cursos largos con distintos algoritmos sobre el
DEM. Probamos las funciones \texttt{r.carve} y \texttt{r.mapcalc}
(álgebra de mapas) de GRASS GIS, y \texttt{FillBurn} de WhiteboxTools
(GRASS Development Team, 2022a; Lindsay, 2018). Sin embargo, es
importante señalar que, dependiendo del algoritmo usado, el grabado
modifica de forma diferente el DEM. Además, algunos algoritmos modifican
no solamente los píxeles intersectados sino también otros píxeles,
incluso pueden llegar a cambiar los valores en el DEM completo. Nosotros
priorizamos un método de grabado que fuese efectivo pero que a la vez
produjese la mínima alteración sobre el DEM.

Comenzamos con \texttt{r.carve}, una herramienta diseñada para grabar el
DEM sin modificarlo sustancialmente, permitiendo al mismo tiempo
configurar la profundidad y la anchura del grabado (GRASS Development
Team, 2022b; Petrasova et~al., 2011). Por defecto, la anchura de lecho
es equivalente a la resolución del DEM. La profundidad puede definirse
por el usuario, para lo cual nosotros establecimos 100 metros. Pudimos
tallar la red de cursos largos sobre el DEM con esta herramienta,
generando un resultado que consideramos bueno, aunque el proceso ocupó
más de 1 hora de tiempo de cómputo. Esta alternativa es recomendada si
resultase imprescindible conservar las propiedades topográficas en el
DEM, pero debe tenerse en cuenta que su rendimiento es muy bajo. En los
casos en los que se use un DEM de resolución baja, se recomienda usar
esta alternativa. Sin embargo, a nosotros no nos resultó apropiado este
método por razones de rendimiento, que explicamos a continuación. Para
evaluar el rendimiento del DEM tallado, realizábamos un procesamiento
hidrológico abreviado (generación de la acumulación de flujo y
extracción de la red con \texttt{r.watershed}); si los productos
generados (e.g.~red hidrográfica) no nos parecían idóneos, nos veíamos
en la necesidad iterar, editando la red y aplicando el tallado
nuevamente. Dado que el complemento \texttt{r.carve} era poco eficiente,
preferimos buscar otras opciones de tallado.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Limpiar red manualmente en QGIS}
\CommentTok{\# Para mejorar la topología, se puede aplicar v.clean directamente en QGIS}

\CommentTok{\# Tallar red de cursos largos}
\BuiltInTok{time}\NormalTok{ r.carve }\AttributeTok{{-}{-}overwrite} \AttributeTok{{-}{-}verbose}\NormalTok{ raster=dem\_pseudo\_ortometrico }\DataTypeTok{\textbackslash{}}
\NormalTok{  vector=red\_mtn50k\_cleaned\_largos output=dem\_tallado depth=100}
\BuiltInTok{echo} \StringTok{"r.carve finalizado"} \KeywordTok{|} \ExtensionTok{mail} \AttributeTok{{-}s} \StringTok{"r.carve finalizado"}\NormalTok{ USUARIO@MAIL}
\CommentTok{\#\# real 97m3.970s}
\end{Highlighting}
\end{Shaded}

Posteriormente, probamos el tallado usando álgebra de mapas con
herramienta \texttt{r.mapcalc} de GRASS GIS (GRASS Development Team,
2022a; GRASS Development Team, 2022c; Larson et~al., 1991; Shapiro y
Westervelt, 1994). Para tallar con álgebra de mapas, primero
normalizamos el DEM, generamos una capa booleana ráster con la red de
cursos largos, la restamos al DEM normalizado y luego, para restablecer
los valores originales fuera de las áreas talladas, multiplicamos el
ráster resultante de la resta nuevamente por el rango del DEM (máximo -
mínimo). El resultado es un DEM tallado, en el que sólo los píxeles por
donde circula la red quedaron con una profundidad equivalente al rango.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Limpiar red manualmente en QGIS}
\CommentTok{\# Para mejorar la topología, se puede aplicar v.clean directamente en QGIS}

\CommentTok{\# Tallar}
\CommentTok{\# Rasterizar red (los píxeles de la red valdrán 1, el resto, nulo)}
\NormalTok{v.to.rast }\SpecialCharTok{{-}{-}}\NormalTok{overwrite input}\OtherTok{=}\NormalTok{red\_mtn50k\_cleaned\_largos type}\OtherTok{=}\NormalTok{line use}\OtherTok{=}\NormalTok{val \textbackslash{}}
\NormalTok{  output}\OtherTok{=}\NormalTok{red\_mtn50k\_cleaned\_largos}
\CommentTok{\# Convertir nulos a cero}
\NormalTok{r.null map}\OtherTok{=}\NormalTok{red\_mtn50k\_cleaned\_largos null}\OtherTok{=}\DecValTok{0}
\CommentTok{\# Determinar estadísticas univariantes del DEM}
\NormalTok{r.univar map}\OtherTok{=}\NormalTok{dem\_pseudo\_ortometrico}
\CommentTok{\# minimum: {-}51.4456}
\CommentTok{\# maximum: 3102.34}

\CommentTok{\# Aplicar normalización y resta}
\NormalTok{r.mapcalc }\SpecialCharTok{{-}{-}}\NormalTok{overwrite }\SpecialCharTok{\textless{}}\ErrorTok{\textless{}}\NormalTok{ EOF}
\FunctionTok{eval}\NormalTok{(}\AttributeTok{stddem =}\NormalTok{ (dem\_pseudo\_ortometrico }\SpecialCharTok{{-}} \SpecialCharTok{{-}}\FloatTok{51.4456}\NormalTok{) }\SpecialCharTok{/}\NormalTok{ (}\FloatTok{3102.34} \SpecialCharTok{{-}} \SpecialCharTok{{-}}\FloatTok{51.4456}\NormalTok{), }\SpecialCharTok{\textbackslash{}}
     \AttributeTok{stddemburn =}\NormalTok{ stddem }\SpecialCharTok{{-}}\NormalTok{ red\_mtn50k\_cleaned\_largos)}
\NormalTok{dem\_tallado }\OtherTok{=}\NormalTok{ (stddemburn }\SpecialCharTok{*}\NormalTok{ (}\FloatTok{3102.34} \SpecialCharTok{{-}} \SpecialCharTok{{-}}\FloatTok{51.4456}\NormalTok{)) }\SpecialCharTok{{-}} \FloatTok{51.4456}
\CommentTok{\# dem\_tallado = stddemburn * dem\_pseudo\_ortometrico \# Alternativa}
\NormalTok{EOF}
\NormalTok{echo }\StringTok{"Tallado finalizado"} \SpecialCharTok{|}\NormalTok{ mail }\SpecialCharTok{{-}}\NormalTok{s }\StringTok{"Mensaje sobre tallado"}\NormalTok{ USUARIO}\SpecialCharTok{@}\NormalTok{MAIL}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics[width=0.8\linewidth]{figuras/dem-sin-tallar-tallado} 

}

\caption{DEM sin aplicación de hidrografía (A), y con aplicación de hidrografía seleccionada (B). El DEM se representa como relieve sombreado y la aplicación se denota como un grabado oscurecido (cañón del río Payabo, Los Haitises, y río Yuna (proximidades de Arenoso, nordeste de República Dominicana)}\label{fig:demtallado}
\end{figure}

Como última alternativa de procesamiento, probamos la herramienta
\texttt{FillBurn}, basada en Saunders (2000) e implementada por Lindsay
(2016) en de WBT. \texttt{FillBurn} realiza dos modificaciones a la vez
sobre el DEM; por una parte, graba la red, usando una profundidad por
defecto y, por otro, rellena las depresiones. La herramienta mostró
mejor rendimiento que la de GRASS GIS en cuanto a tiempo de cómputo.
Tras tallar la red evaluamos el DEM resultante, y comprobamos que
\textbf{resultó ser muy diferente al original, especialmente en las
áreas con depresiones}. Por esta razón, descartamos este DEM y elegimos
usar el tallado por medio de álgebra de mapas (\texttt{r.mapcalc}) con
GRASS GIS en los siguientes pasos de nuestro flujo de trabajo.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Exportar dem\_pseudo\_ortometrico a GTiff con compresión LZW}
\BuiltInTok{time}\NormalTok{ r.out.gdal }\AttributeTok{{-}{-}overwrite} \AttributeTok{{-}{-}verbose}\NormalTok{ createopt=}\StringTok{"COMPRESS=LZW,BIGTIFF=YES"} \DataTypeTok{\textbackslash{}}
\NormalTok{ input=dem\_pseudo\_ortometrico }\DataTypeTok{\textbackslash{}}
\NormalTok{ format=GTiff type=Float64 output=dem\_pseudo\_ortometrico.tif}
\BuiltInTok{echo} \StringTok{"Job finished"} \KeywordTok{|} \ExtensionTok{mail} \AttributeTok{{-}s} \StringTok{"Job finished"}\NormalTok{ USUARIO@MAIL}
\CommentTok{\#\# real 1m0.248s}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Exportar red\_mtn50k\_cleaned\_largos.gpkg a shapefile}
\FunctionTok{ogr2ogr}\NormalTok{(}
  \AttributeTok{src\_datasource\_name =} \FunctionTok{paste0}\NormalTok{(}\StringTok{\textquotesingle{}/media/jose/datos/alos{-}palsar{-}dem{-}rd/\textquotesingle{}}\NormalTok{,}
                               \StringTok{\textquotesingle{}dem/red\_mtn50k\_cleaned\_largos.gpkg\textquotesingle{}}\NormalTok{),}
  \AttributeTok{dst\_datasource\_name =} \FunctionTok{paste0}\NormalTok{(}\StringTok{\textquotesingle{}/media/jose/datos/alos{-}palsar{-}dem{-}rd/\textquotesingle{}}\NormalTok{,}
                               \StringTok{\textquotesingle{}dem/red\_mtn50k\_cleaned\_largos.shp\textquotesingle{}}\NormalTok{),}
  \AttributeTok{verbose=}\ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Tallar con WBT}
\BuiltInTok{time}\NormalTok{ \textasciitilde{}/WhiteboxTools\_linux\_amd64/WBT/whitebox\_tools }\DataTypeTok{\textbackslash{}}
  \AttributeTok{{-}{-}wd}\OperatorTok{=}\StringTok{\textquotesingle{}/media/jose/datos/alos{-}palsar{-}dem{-}rd/dem/\textquotesingle{}} \DataTypeTok{\textbackslash{}}
  \AttributeTok{{-}{-}run}\OperatorTok{=}\NormalTok{FillBurn }\AttributeTok{{-}{-}dem}\OperatorTok{=}\StringTok{\textquotesingle{}dem\_pseudo\_ortometrico.tif\textquotesingle{}} \DataTypeTok{\textbackslash{}}
  \AttributeTok{{-}{-}streams}\OperatorTok{=}\NormalTok{red\_mtn50k\_cleaned.shp }\AttributeTok{{-}{-}output}\OperatorTok{=}\StringTok{\textquotesingle{}dem\_tallado.tif\textquotesingle{}} \AttributeTok{{-}v}
\BuiltInTok{echo} \StringTok{"Job finished"} \KeywordTok{|} \ExtensionTok{mail} \AttributeTok{{-}s} \StringTok{"Job finished"}\NormalTok{ USUARIO@MAIL}
\CommentTok{\#\# real 9m21.980s}
\CommentTok{\# Importar a GRASS GIS}
\BuiltInTok{time}\NormalTok{ r.import }\AttributeTok{{-}{-}overwrite}\NormalTok{ input=dem\_tallado.tif output=dem\_tallado}
\BuiltInTok{echo} \StringTok{"Job finished"} \KeywordTok{|} \ExtensionTok{mail} \AttributeTok{{-}s} \StringTok{"Job finished"}\NormalTok{ USUARIO@MAIL}
\CommentTok{\#\# real 0m38.519s}
\end{Highlighting}
\end{Shaded}

A continuación, implementamos algoritmos para superponer depresiones
sobre el Modelo Digital de Elevación (DEM). Este paso es esencial para
guiar el flujo de agua a través de las depresiones, en los lugares donde
éstas sean presentes. Es importante tener en cuenta que sólo se deben
superponer aquellas depresiones que tengan la capacidad de capturar la
escorrentía superficial, como los ponores o pérdidas, ya que son estos
elementos los que condicionarán la hidrología en su entorno. El proceso
de superposición de depresiones es fundamental para obtener límites de
cuencas y redes de drenaje coherentes.

Para generar un conjunto de depresiones, utilizamos la capa de
litologías de la República Dominicana, proporcionada por Mollat et~al.
(2004). A partir de este recurso, identificamos y separamos las calizas
que presentaban un grado de karstificación suficiente, basándonos en
nuestra experiencia de campo. Además, creamos una capa de depresiones
empleando el complemento \texttt{r.geomorphon} y utilizando el DEM como
insumo, según el método propuesto por Jasiewicz y Stepinski (2013).
También digitalizamos manualmente algunas depresiones cuya ubicación ya
conocíamos a partir de nuestra experiencia en el terreno. Finalmente,
realizamos una intersección de las tres fuentes de datos para producir
una capa exhaustiva que refleja las depresiones capaces de capturar el
flujo superficial.

\begin{figure}

{\centering \includegraphics[width=0.8\linewidth]{figuras/geomorfonos-de-rd} 

}

\caption{"Geomórfonos" de República Dominicana generados a partir de DEM ALOS PALSAR. En cartela, detalle del cañón del río Payabo}\label{fig:geomorfonosrd}
\end{figure}

No obstante, nuestro resultado debe tomarse con cautela en el relieve
kárstico. Como bien es sabido, no todas las calizas representadas en la
geología dominicana están lo suficientemente karstificadas como para
desarrollar depresiones. Por esta razón, usamos la capa de calizas a
discreción, y sólo conservamos aquellos afloramientos de calizas en los
que, desde nuestro conocimiento de terreno, no se evidenciaba
escorrentía superficial. Asimismo, reservamos aquellas calizas donde
encontramos evidencia de depresiones en la topografía detallada y en
imágenes satelitales. No obstante, gran parte de este trabajo se realizó
manualmente, por lo que nuestra colección de dolinas tiene suficiente
precisión, pero no es exhaustiva. Además, es virtualmente imposible
identificar todas las depresiones que funcionan como pérdidas en
imágenes satelitales o en mapas topográficos y geológicos. Finalmente,
un elemento adicional complica aún más las cosas en los relieves
kársticos: muchas pérdidas no ocurren a través de una depresión
topográficamente visible, pues gran parte de la infiltración se produce
a través de fracturas en la roca, pasando al endokarst y a la zona
vadosa de manera ``silenciosa'', sin que veamos desde el aire la típica
morfología deprimida (e.g.~dolina).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Crear geomórfonos}
\CommentTok{\# WBT}
\CommentTok{\# time \textasciitilde{}/WhiteboxTools\_linux\_amd64/WBT/whitebox\_tools \textbackslash{}}
\CommentTok{\#   {-}r=Geomorphons {-}v {-}{-}wd=\textquotesingle{}/media/jose/datos/alos{-}palsar{-}dem{-}rd/dem/\textquotesingle{} \textbackslash{}}
\CommentTok{\#   {-}{-}dem=dem\_tallado.tif {-}o=geomorfonos.tif {-}{-}search=25 \textbackslash{}}
\CommentTok{\#   {-}{-}threshold=0 {-}{-}tdist=0.0 {-}{-}forms}
\CommentTok{\# echo "Job finished" | mail {-}s "Job finished" USUARIO@MAIL}
\CommentTok{\#\# real 6m52.298s \#MUY EFICIENTE. Se prefirió la versión de GRASS }
\CommentTok{\#\# para garantizar flujo de trabajo dentro de la base de datos.}
\CommentTok{\# GRASS GIS}
\BuiltInTok{time}\NormalTok{ r.geomorphon }\DataTypeTok{\textbackslash{}}
  \AttributeTok{{-}{-}overwrite} \AttributeTok{{-}{-}verbose} \DataTypeTok{\textbackslash{}}
\NormalTok{  elevation=dem\_pseudo\_ortometrico forms=geomorfonos search=25}
\BuiltInTok{echo} \StringTok{"r.geomorphon finalizado"} \KeywordTok{|} \ExtensionTok{mail} \AttributeTok{{-}s} \StringTok{"Mensaje sobre r.geomorphon"}\NormalTok{ USUARIO@MAIL}
\CommentTok{\#\# real 33m16.508s \#MUY LENTO}

\CommentTok{\# Extraer depresiones desde geomorfonos}
\ExtensionTok{r.mapcalc} \AttributeTok{{-}{-}overwrite} \DataTypeTok{\textbackslash{}}
\NormalTok{  expression=}\StringTok{"\textquotesingle{}depresiones\_geomorfonos\textquotesingle{} = if(geomorfonos == 10, 1, null())"}

\CommentTok{\# Importar depresiones manualmente digitalizadas a base de datos de GRASS GIS}
\ExtensionTok{v.import} \AttributeTok{{-}{-}overwrite}\NormalTok{ input=depresiones\_digitalizadas.gpkg }\DataTypeTok{\textbackslash{}}
\NormalTok{  output=depresiones\_digitalizadas}

\CommentTok{\# Convertir depresiones digitalizadas manualmente a ráster}
\ExtensionTok{v.to.rast} \AttributeTok{{-}{-}overwrite}\NormalTok{ input=depresiones\_digitalizadas }\DataTypeTok{\textbackslash{}}
\NormalTok{  type=area use=val output=depresiones\_digitalizadas}

\CommentTok{\# Importa la capa de calizas con depresiones en RD (de Mapa Geológico 250K)}
\ExtensionTok{v.import} \AttributeTok{{-}{-}overwrite}\NormalTok{ input=calizas\_con\_depresiones.gpkg output=calizas\_con\_depresiones}

\CommentTok{\# Convertir la capa de calizas con depresiones a ráster}
\ExtensionTok{v.to.rast} \AttributeTok{{-}{-}overwrite}\NormalTok{ input=calizas\_con\_depresiones type=area }\DataTypeTok{\textbackslash{}}
\NormalTok{  use=val output=calizas\_con\_depresiones}

\CommentTok{\# Adjuntar depresiones digitalizadas manualmente con calizas}
\ExtensionTok{r.mapcalc} \AttributeTok{{-}{-}overwrite} \DataTypeTok{\textbackslash{}}
\NormalTok{  expression=}\StringTok{"\textquotesingle{}depresiones\_geomorfonos\_calizas\textquotesingle{} = }\DataTypeTok{\textbackslash{}}
\StringTok{              \textquotesingle{}depresiones\_geomorfonos\textquotesingle{} * \textquotesingle{}calizas\_con\_depresiones\textquotesingle{}"}

\CommentTok{\# Unir todas las depresiones en un único mapa}
\ExtensionTok{r.patch} \AttributeTok{{-}{-}overwrite}\NormalTok{ input=depresiones\_geomorfonos\_calizas,depresiones\_digitalizadas }\DataTypeTok{\textbackslash{}}
\NormalTok{  output=depresiones\_todas}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics[width=0.8\linewidth]{figuras/depresiones} 

}

\caption{DEM ALOS PALSAR representado como mapa hipsómétrico (rojo y marrón representan terreno elevado, verde y azul claro terreno bajo) sobre relieve sombreado, mostrando el área de Guaraguao, Los Haitises, al sur del río Yuna (nordeste de República Dominicana). (A) sin mostrar depresiones, (B) mostrando depresiones en tonalidad azul oscuro}\label{fig:depresiones}
\end{figure}

\hypertarget{suplemento-meotodoluxf3gico-para-la-subsecciuxf3n-procesamiento-de-hidrologuxeda-computacional}{%
\subsection*{Suplemento meotodológico para la subsección ``Procesamiento
de hidrología
computacional''}\label{suplemento-meotodoluxf3gico-para-la-subsecciuxf3n-procesamiento-de-hidrologuxeda-computacional}}
\addcontentsline{toc}{subsection}{Suplemento meotodológico para la
subsección ``Procesamiento de hidrología computacional''}

Las técnicas de hidrología computacional han experimentado una
considerable transformación desde su origen en el siglo pasado hasta la
actualidad, un proceso evolutivo al que han contribuido múltiples
entidades y personas de manera directa (Ehlschlaeger, 1989; Freeman,
1991; Holmgren, 1994; Larson et~al., 1991; McCool et~al., 1987; Metz
et~al., 2011; Moore et~al., 1991; Quinn et~al., 1991; Weltz et~al.,
1988). De manera particular, en las últimas dos décadas, se han
realizado avances que han expandido el alcance y profundidad de la
hidrología computacional como disciplina, abriendo nuevas fronteras de
conocimiento y posibilitando abordajes más sofisticados y detallados de
los fenómenos hídricos. En este proceso, GRASS GIS ha jugado un papel
fundamental, pues no solo ha mantenido activo calendario de lanzamiento
de versiones, sino que también ha ampliado, gracias a comunidad, el
número de herramientas de forma significativa.

Para realizar análisis de cuencas y redes de drenaje en GRASS GIS, el
complemento por excelencia es \texttt{r.watershed} (GRASS Development
Team, 2022d), el cual ofrece la posibilidad de crear mapas de
acumulación de flujo usando algoritmos avanzados, y facilita también la
tarea de extraer \emph{talwegs} y redes de drenaje, y delimitar cuencas.
Alternativamente, en los casos en los que los que existe especial
interés por el análisis de redes de drenaje y la jerarquía hidrográfica,
se utiliza la familia de complementos \texttt{r.stream*} (Jasiewicz y
Metz, 2011). Dentro de esta familia se encuentran
\texttt{r.stream.extract} para generar la red, \texttt{r.stream.order}
para calcular su jerarquía (requiere de los subproductos generados para
la herramienta anterior), y \texttt{r.stream.basins} para crear cuencas
hidrográficas en función de la jerarquía. En este sentido, debemos
elegir apropiadamente entre \texttt{r.watershed} o la familia
\texttt{r.stream*} según nuestras necesidades y objetivos, o usar ambos
si nos interesan resultados combinados, pero tomando las debidas
precauciones.

Ambos complementos necesitan de dos mapas derivados para generar
productos hidrológicos, los cuales pueden ser generados por ellos
mismos; estos son el mapa de la red propiamente (\texttt{stream\_rast}),
y el de dirección de drenaje (\texttt{direction}). En este sentido, debe
evitarse combinar mapas generados por algoritmos distintos para mantener
la consistencia (por ejemplo, se desaconseja generar
\texttt{stream\_ras} con \texttt{r.watershed} y \texttt{direction} con
\texttt{r.stream*}, y viceversa), por lo que se recomienda generar ambos
mapas por medio del mismo algoritmo.

Considerando que nuestro objetivo principal es la jerarquía de red,
podíamos iniciar con \texttt{r.stream.extract} para generar los insumos
para \texttt{r.stream.order}. Pero dado que este último requiere el mapa
de acumulación flujo, el cual sólo es producido por
\texttt{r.watershed}, generamos primero este mapa. Por lo tanto, sólo
usamos \texttt{r.watershed} para obtener el mapa de acumulación que
necesitamos en la aplicación de la familia \texttt{r.stream.*}.

Previo al inicio de los análisis hidrológicos, aplicamos una máscara
ajustada a la línea de costa y los límites fronterizos del país para
evitar que las redes extraídas se extiendan al mar, y creamos una zona
de influencia en el límite fronterizo para permitir la salida y entrada
de flujo a través de este. Posteriormente, extrajimos el mapa de
acumulación de flujo.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Importar máscara}
\ExtensionTok{v.import} \AttributeTok{{-}{-}overwrite}\NormalTok{ input=mascara{-}1km{-}solo{-}en{-}frontera.gpkg }\DataTypeTok{\textbackslash{}}
\NormalTok{  output=mascara\_1km\_solo\_en\_frontera}
\CommentTok{\# Fijar máscara (EJECUTAR SÓLO SI ES ESTRICTAMENTE NECESARIO, PUES TARDA MUCHO)}
\ExtensionTok{r.mask} \AttributeTok{{-}r}
\ExtensionTok{r.mask}\NormalTok{ vector=mascara\_1km\_solo\_en\_frontera}

\CommentTok{\# Acumulación de flujo}
\BuiltInTok{time}\NormalTok{ r.watershed }\AttributeTok{{-}{-}overwrite} \AttributeTok{{-}{-}verbose}\NormalTok{ elevation=dem\_tallado }\DataTypeTok{\textbackslash{}}
\NormalTok{ depression=depresiones\_todas accumulation=rwshed\_acum }\DataTypeTok{\textbackslash{}}
\NormalTok{ threshold=180 stream=rwshed\_talwegs }\DataTypeTok{\textbackslash{}}
 \CommentTok{\# El umbral 180 se usó en la extracción de una red de muestra, como forma de}
 \CommentTok{\# previsualizar una hidrografía inicial y no como red definitiva.}
 \CommentTok{\# Otras opciones posibles del addon son las siguientes (útiles en otras aplicaciones):}
 \CommentTok{\# drainage=rwshed\_direccion\_drenaje basin=rwshed\_cuencas half\_basin=rwshed\_hemicuenca \textbackslash{}}
 \CommentTok{\# tci=rwshed\_tci spi=rwshed\_spi \textbackslash{}}
 \CommentTok{\# length\_slope=rwshed\_longitud\_vertiente slope\_steepness=rwshed\_empinamiento \textbackslash{}}
 \CommentTok{\# retention=rwshed\_retencion\_flujo max\_slope\_length=rwshed\_max\_longitud\_vertiente \textbackslash{}}
 \VariableTok{memory}\OperatorTok{=}\NormalTok{32000}
\BuiltInTok{echo} \StringTok{"r.watershed finalizado"} \KeywordTok{|} \ExtensionTok{mail} \AttributeTok{{-}s} \StringTok{"Mensaje sobre r.watershed"}\NormalTok{ USUARIO@MAIL}
\CommentTok{\#\# real 9m47.041s}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics[width=0.8\linewidth]{figuras/acumulacion-flujo-y-red-rwshed} 

}

\caption{Mapa de acumulación de flujo generado con `r.watershed`. En cartela, detalle del mapa en la cuenca del río Yaque del Sur.}\label{fig:acumyredrwshed}
\end{figure}

Usando como insumos el DEM y el mapa de acumulación producido por
\texttt{r.watershed}, obtuvimos la red hidrográfica utilizando
\texttt{r.stream.extract}. Esta etapa requirió la evaluación de umbrales
de acumulación óptimos a través de inspección visual. El umbral de
acumulación es un área de debate en hidrología computacional. Nos
enfocamos en la evaluación de criterios para la extracción de
\emph{talwegs} en un sentido amplio, sin considerarlos como cursos
fluviales permanentes. Reconocemos que la determinación de la
permanencia fluvial requeriría un análisis detallado de las
características individuales de cada cuenca, incluyendo aspectos como la
pendiente, tamaño, litología y clima.

Siguiendo las mejores prácticas, realizamos diversas ejecuciones del
complemento \texttt{r.stream.extract} usando varios umbrales para
identificar la red hidrográfica más adecuada en nuestra área de interés
(Freeman, 1991; Jasiewicz y Metz, 2011; Marchesini et~al., 2021). Para
seleccionar un umbral de acumulación óptimo, consideramos cuatro
criterios: consistencia con estudios similares, suficiente densidad de
red, evitar una generalización excesiva de la red, y prevenir una red
demasiado densa que incluya áreas sin características hidrológicas
mínimas. Dado que nuestro DEM tiene una resolución espacial de 12.5 m,
examinamos diferentes umbrales para obtener una red hidrográfica
adecuada. En \texttt{r.stream.extract}, optamos por los umbrales de
acumulación de 180, 540 y 900 celdas, equivalentes a 3, 8 y 14 hectáreas
de superficie, respectivamente. Estos umbrales están en línea con los
utilizados en estudios que consultamos, donde se evaluaron áreas
propensas a inundaciones y cuencas de captación (Freeman, 1991;
Marchesini et~al., 2021).

El código necesario para generar las distintas redes evaluadas lo
implementamos mediante un bucle \texttt{for} en Bash para mayor
eficiencia y consistencia en el procesamiento. Hicimos que el bucle
iterara automáticamente sobre los tres umbrales de acumulación, usando
los valores de umbral como iterador (\texttt{i=\{180..900..360\}}, debe
leerse como ``itera desde 180 a 900 en incrementos de 360 enteros'',
resultando en los valores 180, 540 y 900), el cual pasamos como
argumento del parámetro \texttt{threshold}. Finalmente, para cada red
generada con los distintos umbrales, calculamos la longitud de cursos
fluviales, actualizamos la base de datos de GRASS GIS y generamos un
archivo de texto resumen que posteriormente importamos a R para obtener
estadísticos básicos.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Extraer redes de drenaje para tres umbrales de acumulación distintos}
\CommentTok{\# En bucle}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \KeywordTok{\textasciigrave{}}\BuiltInTok{echo} \DataTypeTok{\{}\DecValTok{180}\DataTypeTok{..}\DecValTok{900}\DataTypeTok{..}\DecValTok{360}\DataTypeTok{\}}\KeywordTok{\textasciigrave{};} \DataTypeTok{\textbackslash{}}
  \ControlFlowTok{do} \BuiltInTok{echo} \AttributeTok{{-}e} \StringTok{"\textbackslash{}nTRABAJANDO EL UMBRAL DE ACUMULACIÓN }\VariableTok{$i}\StringTok{ ...\textbackslash{}n"}\KeywordTok{;} \DataTypeTok{\textbackslash{}}
  \BuiltInTok{time}\NormalTok{ r.stream.extract }\AttributeTok{{-}{-}overwrite}\NormalTok{ elevation=dem\_tallado accumulation=rwshed\_acum }\DataTypeTok{\textbackslash{}}
\NormalTok{    depression=depresiones\_todas threshold=}\VariableTok{$i} \DataTypeTok{\textbackslash{}}
\NormalTok{    stream\_vector=rstream\_talwegs\_umbral\_}\VariableTok{$i}\NormalTok{ stream\_raster=rstream\_talwegs\_umbral\_}\VariableTok{$i} \DataTypeTok{\textbackslash{}}
\NormalTok{    direction=rstream\_direccion\_umbral\_}\VariableTok{$i}\NormalTok{ memory=32000}\KeywordTok{;} \DataTypeTok{\textbackslash{}}
  \BuiltInTok{echo} \AttributeTok{{-}e} \StringTok{"r.stream.extract umbral }\VariableTok{$i}\StringTok{ finalizado"} \KeywordTok{|}\DataTypeTok{\textbackslash{}}
    \ExtensionTok{mail} \AttributeTok{{-}s} \StringTok{"Mensaje sobre r.stream.extract"}\NormalTok{ USUARIO@MAIL}\KeywordTok{;} \DataTypeTok{\textbackslash{}}
\ControlFlowTok{done}
\CommentTok{\#\# real 11m28.455s}
\CommentTok{\#\# real 11m26.908s}
\CommentTok{\#\# real 11m30.074s}
\CommentTok{\# Único umbral, para testing}
\CommentTok{\# time r.stream.extract {-}{-}overwrite elevation=dem\_tallado accumulation=rwshed\_acum \textbackslash{}}
\CommentTok{\#   depression=depresiones\_todas threshold=64 \textbackslash{}}
\CommentTok{\#   stream\_vector=rstream\_talwegs\_umbral\_64 stream\_raster=rstream\_talwegs\_umbral\_64 \textbackslash{}}
\CommentTok{\#     direction=rstream\_direccion\_umbral\_64 memory=32000}
\CommentTok{\# echo "Job finished" | mail {-}s "Job finished" USUARIO@MAIL}
\CommentTok{\#\# real 11m46.930s}

\CommentTok{\# Calcular estadisticos, y pasar a archivo}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \KeywordTok{\textasciigrave{}}\BuiltInTok{echo} \DataTypeTok{\{}\DecValTok{180}\DataTypeTok{..}\DecValTok{900}\DataTypeTok{..}\DecValTok{360}\DataTypeTok{\}}\KeywordTok{\textasciigrave{};} \DataTypeTok{\textbackslash{}}
  \ControlFlowTok{do} \ExtensionTok{v.to.db} \AttributeTok{{-}p}\NormalTok{ option=length map=rstream\_talwegs\_umbral\_}\VariableTok{$i} \OperatorTok{\textgreater{}}\DataTypeTok{\textbackslash{}}
\NormalTok{    stats\_length\_rstream\_talwegs\_umbral\_}\VariableTok{$i}\NormalTok{.txt}\KeywordTok{;}
\ControlFlowTok{done}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{stats\_rstream\_talwegs }\OtherTok{\textless{}{-}} \FunctionTok{sapply}\NormalTok{(}\FunctionTok{as.character}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{180}\NormalTok{, }\DecValTok{540}\NormalTok{, }\DecValTok{900}\NormalTok{)), }\ControlFlowTok{function}\NormalTok{(x) }
  \FunctionTok{read\_delim}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(dem\_proc\_dir, }\StringTok{\textquotesingle{}/\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}stats\_length\_rstream\_talwegs\_umbral\_\textquotesingle{}}\NormalTok{, x, }\StringTok{\textquotesingle{}.txt\textquotesingle{}}\NormalTok{),}
             \AttributeTok{progress =}\NormalTok{ F, }\AttributeTok{show\_col\_types =}\NormalTok{ F), }\AttributeTok{simplify =}\NormalTok{ F)}
\NormalTok{n\_rstream\_talwegs }\OtherTok{\textless{}{-}}\NormalTok{ stats\_rstream\_talwegs }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{map}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{ .x }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\NormalTok{cat}\SpecialCharTok{=={-}}\DecValTok{1}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ nrow) }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ unlist}
\NormalTok{length\_rstream\_talwegs }\OtherTok{\textless{}{-}}\NormalTok{ stats\_rstream\_talwegs }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{map}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{ .x }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\NormalTok{cat}\SpecialCharTok{=={-}}\DecValTok{1}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{pull}\NormalTok{(length) }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ sum}\SpecialCharTok{/}\DecValTok{1000}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ unlist}
\end{Highlighting}
\end{Shaded}

Evaluamos los resultados y recopilamos los estadísticos esenciales de
cada red formada con los distintos umbrales. Para los umbrales de 180,
540 y 900 celdas, se obtuvieron \textbf{419646, 192453 y 130244
segmentos} correspondientemente, acumulando \textbf{138444, 98213 y
82081 kilómetros} de longitud en cada caso. Para cada una de las redes,
evaluamos el grado de alineación con nuestros criterios de selección de
la red óptima, tras lo cual elegimos la red generada con el umbral de
acumulación de 540 celdas. Sin embargo, mantuvimos las restantes en la
base de datos y les aplicamos todos los subsiguientes algoritmos de
análisis de hidrología computacional, hasta alcanzar los resultados
finales.

\begin{figure}

{\centering \includegraphics[width=0.8\linewidth]{figuras/red-indiferenciada} 

}

\caption{Red de drenaje extraída para tres umbrales de acumulación: (A) 180 celdas, equivalente a ~3 ha; (B) 540 celdas, equivalente a ~8 ha; (C) 900 celdas, equivalente a ~14 ha. La imagen de fondo es un relieve sombreado a partir de DEM ALOS PALSAR, mostrando el área de El Arroyazo en la reserva científica Ébano Verde (provincia La Vega, cordillera Central de República Dominicana)}\label{fig:redindiferenciada}
\end{figure}

Posteriormente, calculamos el orden jerárquico de la red hidrográfica,
proceso que repetimos para cada uno de los umbrales de acumulación que
definimos previamente, es decir, 180, 540 y 900 celdas. Al igual que en
casos anteriores, utilizamos un bucle en Bash para iterar
automáticamente sobre los tres umbrales de acumulación; en este caso,
los valores del índice se correspondían con los sufijos de los mapas de
entrada (\texttt{\_\$i}). El núcleo del bucle, en este caso, contiene la
ejecución del complemento \texttt{r.stream.order} de GRASS GIS. Este
complemento se invoca con una serie de argumentos que especifican los
mapas de entrada y salida que se deben usar en el cálculo. De manera
específica, le proporcionamos el mapa de \emph{talwegs} o cursos
(parámetro \texttt{stream\_rast}), el mapa de dirección de drenaje
(\texttt{direction}), el mapa de elevación (\texttt{elevation}), y el
mapa de acumulación (\texttt{accumulation}), todos correspondientes al
umbral de acumulación que está siendo procesado en cada iteración.
Adicionalmente, especificamos los nombres de los mapas de salida que
contienen el orden de red según los métodos de Strahler y Horton
(argumentos \texttt{strahler} y \texttt{horton}) (Horton, 1945;
Strahler, 1957), así como el mapa de topología (\texttt{topo}) y el
vectorial de salida (\texttt{stream\_vect}).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Extraer orden de red}
\CommentTok{\# En bucle}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \KeywordTok{\textasciigrave{}}\BuiltInTok{echo} \DataTypeTok{\{}\DecValTok{180}\DataTypeTok{..}\DecValTok{900}\DataTypeTok{..}\DecValTok{360}\DataTypeTok{\}}\KeywordTok{\textasciigrave{};} \DataTypeTok{\textbackslash{}}
  \ControlFlowTok{do} \BuiltInTok{echo} \AttributeTok{{-}e} \StringTok{"\textbackslash{}nTRABAJANDO EL UMBRAL DE ACUMULACIÓN }\VariableTok{$i}\StringTok{ ...\textbackslash{}n"}\KeywordTok{;} \DataTypeTok{\textbackslash{}}
  \BuiltInTok{time}\NormalTok{ r.stream.order }\AttributeTok{{-}{-}overwrite}\NormalTok{ stream\_rast=rstream\_talwegs\_umbral\_}\VariableTok{$i} \DataTypeTok{\textbackslash{}}
\NormalTok{    direction=rstream\_direccion\_umbral\_}\VariableTok{$i} \DataTypeTok{\textbackslash{}}
\NormalTok{    elevation=dem\_tallado accumulation=rwshed\_acum }\DataTypeTok{\textbackslash{}}
\NormalTok{    stream\_vect=rstream\_orden\_de\_red\_umbral\_}\VariableTok{$i} \DataTypeTok{\textbackslash{}}
\NormalTok{    strahler=rstream\_orden\_strahler\_de\_red\_umbral\_}\VariableTok{$i} \DataTypeTok{\textbackslash{}}
\NormalTok{    horton=rstream\_orden\_horton\_de\_red\_umbral\_}\VariableTok{$i} \DataTypeTok{\textbackslash{}}
\NormalTok{    topo=topologia\_orden\_umbral\_}\VariableTok{$i}\NormalTok{ memory=32000}\KeywordTok{;} \DataTypeTok{\textbackslash{}}
  \BuiltInTok{echo} \AttributeTok{{-}e} \StringTok{"r.stream.order umbral de acumulación }\VariableTok{$i}\StringTok{ finalizado"} \KeywordTok{|}\DataTypeTok{\textbackslash{}}
    \ExtensionTok{mail} \AttributeTok{{-}s} \StringTok{"Mensaje sobre r.stream.order"}\NormalTok{ USUARIO@MAIL}\KeywordTok{;} \DataTypeTok{\textbackslash{}}
\ControlFlowTok{done}
\CommentTok{\#\# real 1m34.983s}
\CommentTok{\#\# real 1m18.662s}
\CommentTok{\#\# real 1m14.986s}
\CommentTok{\# Aplicación de algoritmo con un único umbral, sólo para pruebas}
\CommentTok{\# time r.stream.order {-}{-}overwrite \textbackslash{}}
\CommentTok{\#     stream\_rast=rstream\_talwegs direction=rstream\_direccion \textbackslash{}}
\CommentTok{\#     elevation=dem\_tallado accumulation=rwshed\_acum stream\_vect=order\_todos \textbackslash{}}
\CommentTok{\#     topo=topologia\_orden memory=32000}
\CommentTok{\# echo "Job finished" | mail {-}s "Job finished" USUARIO@MAIL}
\CommentTok{\#\# real }
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics[width=0.8\linewidth]{figuras/red-orden} 

}

\caption{Orden de red de Strahler para redes de drenaje generadas a partir de tres umbrales de acumulación: (A) 180 celdas, equivalente a ~3 ha; (B) 540 celdas, equivalente a ~8 ha; (C) 900 celdas, equivalente a ~14 ha. El área mostrada corresponde al río San Juan, afluente del río Yaque del Sur (vertiente sur de la cordillera Central de República Dominicana)}\label{fig:redorden3umbrales}
\end{figure}

\begin{figure}

{\centering \includegraphics[width=0.8\linewidth]{figuras/red-orden-detalle-mtn} 

}

\caption{Orden de red de Strahler en el área del pico de la Viuda y Sabana Vieja, provincia San Juan (vertiente sur de la cordillera Central de República Dominicana). Esta red fue generada usando un umbral de acumulación de 180 celdas, equivalente a ~3 ha. De fondo, mapa topográfico nacional escala 1:50,000 y relieve sombreado}\label{fig:redordenumbral180}
\end{figure}

A continuación, delimitamos cuencas y subcuencas según la jerarquía de
red, con independencia de si tratara de cuencas tributarias o no, para
lo cual usamos el complemento \texttt{r.stream.basins} especificando la
opción (\emph{flag}) \texttt{-c}, que utiliza una secuencia única de
categorías (en nuestro caso, órdenes) para delimitar las cuencas en
lugar de flujos de entrada. En este caso, construimos un bucle
\texttt{for} doble, anidando el orden de red dentro del umbral de
acumulación. Así, para cada uno de los mapas de redes hidrográficas
según los tres umbrales de acumulación, delimitamos las cuencas de cada
uno de los órdenes de Strahler disponibles. Al utilizar el criterio
orden de red, las unidades delimitadas por este procedimiento incluyen
tanto cuencas completas como subcuencas (tributarias), por lo que la
mayoría contiene redes de drenaje tributarias (ríos que desembocan en
otros ríos).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Delimitar cuencas según jerarquía}
\CommentTok{\# En bucle}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \KeywordTok{\textasciigrave{}}\BuiltInTok{echo} \DataTypeTok{\{}\DecValTok{180}\DataTypeTok{..}\DecValTok{900}\DataTypeTok{..}\DecValTok{360}\DataTypeTok{\}}\KeywordTok{\textasciigrave{};} \DataTypeTok{\textbackslash{}}
  \ControlFlowTok{do} \ControlFlowTok{for}\NormalTok{ j }\KeywordTok{in} \KeywordTok{\textasciigrave{}}\BuiltInTok{echo} \DataTypeTok{\{}\DecValTok{1}\DataTypeTok{..}\DecValTok{8}\DataTypeTok{..}\DecValTok{1}\DataTypeTok{\}}\KeywordTok{\textasciigrave{};} \DataTypeTok{\textbackslash{}}
    \ControlFlowTok{do} \BuiltInTok{echo} \AttributeTok{{-}e} \StringTok{"\textbackslash{}nTRABAJANDO EL UMBRAL DE ACUMULACIÓN }\VariableTok{$i}\StringTok{, orden }\VariableTok{$j}\StringTok{...\textbackslash{}n"}\KeywordTok{;} \DataTypeTok{\textbackslash{}}
    \BuiltInTok{time}\NormalTok{ r.stream.basins }\AttributeTok{{-}c} \AttributeTok{{-}{-}overwrite}\NormalTok{ direction=rstream\_direccion\_umbral\_}\VariableTok{$i} \DataTypeTok{\textbackslash{}}
\NormalTok{      stream\_rast=rstream\_orden\_strahler\_de\_red\_umbral\_}\VariableTok{$i}\NormalTok{ cats=}\VariableTok{$j} \DataTypeTok{\textbackslash{}}
\NormalTok{      basins=rstream\_cuencas\_strahler\_umbral\_}\VariableTok{$\{i\}}\NormalTok{\_orden\_}\VariableTok{$j}\NormalTok{ memory=32000}\KeywordTok{;} \DataTypeTok{\textbackslash{}}
  \ControlFlowTok{done}\KeywordTok{;} \DataTypeTok{\textbackslash{}}
  \BuiltInTok{echo} \AttributeTok{{-}e} \StringTok{"r.stream.basins umbral de acumulación }\VariableTok{$i}\StringTok{ finalizado"} \KeywordTok{|}\DataTypeTok{\textbackslash{}}
    \ExtensionTok{mail} \AttributeTok{{-}s} \StringTok{"Mensaje sobre r.stream.basins"}\NormalTok{ USUARIO@MAIL}\KeywordTok{;} \DataTypeTok{\textbackslash{}}
\ControlFlowTok{done}
\CommentTok{\#\# real \textasciitilde{} 0m40s repetido tantas veces como órdenes para cada umbral de acumulación}
\end{Highlighting}
\end{Shaded}

Posteriormente, delimitamos las cuencas con desembocadura en mares,
lagos, lagunas o en pérdidas kársticas. En esta sección aplicamos el
mismo complemento que en el paso anterior (\texttt{r.stream.basins}) en
bucle doble anidado, pero en esta ocasión especificamos la opción
\texttt{-l}. Es decir, delimitamos las cuencas completas, cuya red
desemboca en el mar (exorreicas), o en lagos, lagunas y pérdidas del
karst (endorreicas), y excluimos las subcuencas de redes tributarias
(eg. red cuyo curso principal desemboca en otro río). Por lo tanto, se
trata de cuencas propiamente en la acepción más formal del término, que
significa que no existe---o no se conoce ni se puede detectar con
información disponible---prolongación del drenaje superficial fuera de
ellas.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Delimitar cuencas terminales}
\CommentTok{\# En bucle}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \KeywordTok{\textasciigrave{}}\BuiltInTok{echo} \DataTypeTok{\{}\DecValTok{180}\DataTypeTok{..}\DecValTok{900}\DataTypeTok{..}\DecValTok{360}\DataTypeTok{\}}\KeywordTok{\textasciigrave{};} \DataTypeTok{\textbackslash{}}
  \ControlFlowTok{do} \ControlFlowTok{for}\NormalTok{ j }\KeywordTok{in} \KeywordTok{\textasciigrave{}}\BuiltInTok{echo} \DataTypeTok{\{}\DecValTok{1}\DataTypeTok{..}\DecValTok{8}\DataTypeTok{..}\DecValTok{1}\DataTypeTok{\}}\KeywordTok{\textasciigrave{};} \DataTypeTok{\textbackslash{}}
    \ControlFlowTok{do} \BuiltInTok{echo} \AttributeTok{{-}e} \StringTok{"\textbackslash{}nTRABAJANDO EL UMBRAL DE ACUMULACIÓN }\VariableTok{$i}\StringTok{, orden }\VariableTok{$j}\StringTok{...\textbackslash{}n"}\KeywordTok{;} \DataTypeTok{\textbackslash{}}
    \BuiltInTok{time}\NormalTok{ r.stream.basins }\AttributeTok{{-}lc} \AttributeTok{{-}{-}overwrite}\NormalTok{ direction=rstream\_direccion\_umbral\_}\VariableTok{$i} \DataTypeTok{\textbackslash{}}
\NormalTok{      stream\_rast=rstream\_orden\_strahler\_de\_red\_umbral\_}\VariableTok{$i}\NormalTok{ cats=}\VariableTok{$j} \DataTypeTok{\textbackslash{}}
\NormalTok{      basins=rstream\_cuencas\_strahler\_terminal\_umbral\_}\VariableTok{$\{i\}}\NormalTok{\_orden\_}\VariableTok{$j}\NormalTok{ memory=32000}\KeywordTok{;} \DataTypeTok{\textbackslash{}}
  \ControlFlowTok{done}\KeywordTok{;} \DataTypeTok{\textbackslash{}}
  \BuiltInTok{echo} \AttributeTok{{-}e} \StringTok{"r.stream.basins umbral de acumulación }\VariableTok{$i}\StringTok{ finalizado"} \KeywordTok{|}\DataTypeTok{\textbackslash{}}
    \ExtensionTok{mail} \AttributeTok{{-}s} \StringTok{"Mensaje sobre r.stream.basins"}\NormalTok{ USUARIO@MAIL}\KeywordTok{;} \DataTypeTok{\textbackslash{}}
\ControlFlowTok{done}
\CommentTok{\#\# real \textasciitilde{} 0m40s repetido tantas veces como órdenes para cada umbral de acumulación}
\end{Highlighting}
\end{Shaded}

Finalmente, convertimos las cuencas a modelo de datos vectorial, pero
para evitar agrandar la base de datos innecesariamente, elegimos sólo
las cuencas generadas para el umbral de 540 celdas. Los vectoriales
resultantes nos permitieron un mejor manejo de los datos para análisis y
representación de la cuencas. Describimos el procedimiento detallado a
continuación.

Comenzamos la vectorización ejecutando un bucle para convertir cada capa
ráster de cuencas terminales correspondiente a cada orden de red (desde
1 a 8) en un mapa vectorial de tipo área. Para realizar esta conversión,
utilizamos el complemento \texttt{r.to.vect} de GRASS GIS, añadiendo
también una nueva columna llamada \texttt{strahler} a la tabla de
atributos de cada capa vectorial, que luego actualizamos con el valor
del orden de red Strahler correspondiente. Después de procesar las
cuencas de cada orden, fusionamos todas las capas vectoriales en una
sola utilizando el complemento \texttt{v.patch}. Esto produjo una única
capa vectorial conteniendo información sobre todas las cuencas
terminales para todos los órdenes Strahler. Es importante aclarar que
sólo fueron propiamente clasificadas como polígonos con de orden de red,
aquellas las áreas del ráster que contaban con categorías asignadas
(e.g.~píxeles con valor 1 a 8), es decir, aquellas a las que el
algoritmo \texttt{r.stream.basins} asignó un orden de red debidamente.
Las áreas que formaban el fondo (e.g.~píxeles con valor cero), que
corresponden a espacios con drenaje hacia depresiones sin pertenencia a
jerarquía alguna, conforman la capa ``0'' del mapa vectorial generado
(\texttt{rstream\_cuencas\_strahler\_terminal\_umbral\_540\_todos\_cleaned\ 0}).
Por esta razón, el mapa vectorial de cuencas generado, presenta espacios
vacíos; si hiciera falta recuperar dichos espacios, bastaría con cargar
la referida capa ``0'', tomando en consideración que sus elementos no
cuentan con atributos aprovechables.

Luego, limpiamos y preparamos los datos para el análisis. Primero,
corregimos la topología y actualizamos el área de cada cuenca usando el
complemento \texttt{v.clean}. Eliminamos las áreas inferiores a 200
metros cuadrados (cuencas espurias) para mejorar la calidad de los
datos. Posteriormente, eliminamos los registros con un valor de área
nulo (artefactos). Estas etapas de limpieza y preparación son críticas
para garantizar la precisión y relevancia de nuestros resultados.

Finalmente, seleccionamos las filas válidas---las que tenían un valor de
categoría distinto de -1---de la tabla de atributos de nuestra capa
vectorial final, y exportamos estos datos a un archivo de texto. Este
archivo de texto contiene estadísticas del área para cada cuenca
terminal según orden Strahler, lo cual nos proporcionó información
valiosa para nuestro análisis posterior.

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \KeywordTok{\textasciigrave{}}\BuiltInTok{echo} \DataTypeTok{\{}\DecValTok{1}\DataTypeTok{..}\DecValTok{8}\DataTypeTok{..}\DecValTok{1}\DataTypeTok{\}}\KeywordTok{\textasciigrave{};} \DataTypeTok{\textbackslash{}}
  \ControlFlowTok{do} \ExtensionTok{r.to.vect} \AttributeTok{{-}{-}overwrite}\NormalTok{ input=rstream\_cuencas\_strahler\_terminal\_umbral\_540\_orden\_}\VariableTok{$i} \DataTypeTok{\textbackslash{}}
\NormalTok{  output=rstream\_cuencas\_strahler\_terminal\_umbral\_540\_orden\_}\VariableTok{$i}\NormalTok{ type=area}\KeywordTok{;} \DataTypeTok{\textbackslash{}}
  \ExtensionTok{v.db.addcolumn}\NormalTok{ rstream\_cuencas\_strahler\_terminal\_umbral\_540\_orden\_}\VariableTok{$i} \DataTypeTok{\textbackslash{}}
\NormalTok{    columns=}\StringTok{"strahler int"}\KeywordTok{;} \DataTypeTok{\textbackslash{}}
  \ExtensionTok{v.db.update}\NormalTok{ rstream\_cuencas\_strahler\_terminal\_umbral\_540\_orden\_}\VariableTok{$i} \DataTypeTok{\textbackslash{}}
\NormalTok{  col=strahler value=}\VariableTok{$i}\NormalTok{ where=}\StringTok{"strahler IS NULL"}\KeywordTok{;} \DataTypeTok{\textbackslash{}}
\ControlFlowTok{done}
\ExtensionTok{v.patch} \AttributeTok{{-}e} \AttributeTok{{-}{-}overwrite} \DataTypeTok{\textbackslash{}}
\NormalTok{  input=}\KeywordTok{\textasciigrave{}}\ExtensionTok{g.list}\NormalTok{ type=v pattern=}\StringTok{\textquotesingle{}rstream\_cuencas\_strahler\_terminal\_umbral\_540\_orden\_*\textquotesingle{}} \DataTypeTok{\textbackslash{}}
\NormalTok{    separator=comma}\KeywordTok{\textasciigrave{}} \DataTypeTok{\textbackslash{}}
\NormalTok{  output=rstream\_cuencas\_strahler\_terminal\_umbral\_540\_todos}

\CommentTok{\# Calcular estadisticos, y pasar a archivo}
\CommentTok{\#\# Preparación de fuentes (corrección de topología \textgreater{}}
\CommentTok{\#\#                         actualización de área \textgreater{}}
\CommentTok{\#\#                         eliminar registros)}
\ExtensionTok{v.clean} \AttributeTok{{-}{-}overwrite}\NormalTok{ layer=1 input=rstream\_cuencas\_strahler\_terminal\_umbral\_540\_todos }\DataTypeTok{\textbackslash{}}
\NormalTok{  output=rstream\_cuencas\_strahler\_terminal\_umbral\_540\_todos\_cleaned }\DataTypeTok{\textbackslash{}}
\NormalTok{  tool=rmarea threshold=200}
\ExtensionTok{v.to.db} \AttributeTok{{-}{-}overwrite}\NormalTok{ option=area type=centroid columns=area }\DataTypeTok{\textbackslash{}}
\NormalTok{  map=rstream\_cuencas\_strahler\_terminal\_umbral\_540\_todos\_cleaned}
\ExtensionTok{v.db.droprow}\NormalTok{ rstream\_cuencas\_strahler\_terminal\_umbral\_540\_todos\_cleaned }\DataTypeTok{\textbackslash{}}
\NormalTok{  output=rstream\_cuencas\_strahler\_terminal\_umbral\_540\_todos\_cleaned\_2 where=}\StringTok{"area IS NULL"}
\ExtensionTok{g.rename} \AttributeTok{{-}{-}overwrite} \DataTypeTok{\textbackslash{}}
\NormalTok{  vector=rstream\_cuencas\_strahler\_terminal\_umbral\_540\_todos\_cleaned\_2,}\DataTypeTok{\textbackslash{}}
\NormalTok{  rstream\_cuencas\_strahler\_terminal\_umbral\_540\_todos\_cleaned}

\CommentTok{\# Excluir cuencas strahler\textgreater{}=4 y area\textless{}=1e6}
\ExtensionTok{v.db.droprow}\NormalTok{ rstream\_cuencas\_strahler\_terminal\_umbral\_540\_todos\_cleaned }\DataTypeTok{\textbackslash{}}
\NormalTok{  output=rstream\_cuencas\_strahler\_terminal\_umbral\_540\_todos\_cleaned\_2 }\DataTypeTok{\textbackslash{}}
\NormalTok{  where=}\StringTok{"strahler \textgreater{}= 4 and area \textless{}= 1e6"}
\ExtensionTok{g.rename} \AttributeTok{{-}{-}overwrite} \DataTypeTok{\textbackslash{}}
\NormalTok{  vector=rstream\_cuencas\_strahler\_terminal\_umbral\_540\_todos\_cleaned\_2,}\DataTypeTok{\textbackslash{}}
\NormalTok{  rstream\_cuencas\_strahler\_terminal\_umbral\_540\_todos\_cleaned}

\CommentTok{\#\# Generar tabla}
\ExtensionTok{v.db.select} \AttributeTok{{-}{-}overwrite}\NormalTok{ rstream\_cuencas\_strahler\_terminal\_umbral\_540\_todos\_cleaned }\DataTypeTok{\textbackslash{}}
\NormalTok{  where=}\StringTok{\textquotesingle{}cat!={-}1\textquotesingle{}} \OperatorTok{\textgreater{}}\NormalTok{ stats\_area\_rstream\_cuencas\_strahler\_terminal\_umbral\_540\_todos.txt}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{stats\_rstream\_cuencas\_540 }\OtherTok{\textless{}{-}} \FunctionTok{read\_delim}\NormalTok{(}
  \FunctionTok{paste0}\NormalTok{(dem\_proc\_dir, }\StringTok{\textquotesingle{}/\textquotesingle{}}\NormalTok{,}
         \StringTok{\textquotesingle{}stats\_area\_rstream\_cuencas\_strahler\_terminal\_umbral\_540\_todos.txt\textquotesingle{}}\NormalTok{),}
  \AttributeTok{progress =}\NormalTok{ F, }\AttributeTok{show\_col\_types =}\NormalTok{ F)}
\NormalTok{rstream\_cuencas\_540\_por\_orden }\OtherTok{\textless{}{-}}\NormalTok{ stats\_rstream\_cuencas\_540 }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{rename}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Orden de red (Strahler)}\StringTok{\textasciigrave{}} \OtherTok{=}\NormalTok{ strahler) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Orden de red (Strahler)}\StringTok{\textasciigrave{}}\NormalTok{)  }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Número de cuencas}\StringTok{\textasciigrave{}} \OtherTok{=} \FunctionTok{n}\NormalTok{(),}
            \StringTok{\textasciigrave{}}\AttributeTok{Área promedio}\StringTok{\textasciigrave{}} \OtherTok{=} \FunctionTok{mean}\NormalTok{(area),}
            \StringTok{\textasciigrave{}}\AttributeTok{Área total}\StringTok{\textasciigrave{}} \OtherTok{=} \FunctionTok{sum}\NormalTok{(area))}
\end{Highlighting}
\end{Shaded}

\hypertarget{suplemento-para-la-secciuxf3n-resultados}{%
\subsection{Suplemento para la sección
``Resultados''}\label{suplemento-para-la-secciuxf3n-resultados}}

Realizamos análisis estadísticos de las cuencas terminales. Se necesita
descargar el comprimido con los
\href{https://doi.org/10.5281/zenodo.8146391}{datos del estudio},
colocar el directorio \texttt{gpkg-shp} en el directorio raíz de este
repo. Como medida de seguridad, excluimos cuencas con orden de red
cuatro o mayor y con área menor 1~\textsuperscript{2}. Posteriormente,
generamos un nuevo objeto de cuencas de orden cuatro o mayor para
análisis focalizados.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cuencas }\OtherTok{\textless{}{-}} \FunctionTok{read\_sf}\NormalTok{(}\StringTok{\textquotesingle{}gpkg{-}shp/rstream\_cuencas\_strahler\_terminal\_umbral\_540\_todos\_cleaned.gpkg\textquotesingle{}}\NormalTok{)}
\NormalTok{cuencas4mas }\OtherTok{\textless{}{-}}\NormalTok{ cuencas[cuencas}\SpecialCharTok{$}\NormalTok{strahler }\SpecialCharTok{\textgreater{}=} \DecValTok{4}\NormalTok{, ]}
\end{Highlighting}
\end{Shaded}

\hypertarget{informe-de-la-sesiuxf3n-de-r}{%
\subsection*{Informe de la sesión de
R}\label{informe-de-la-sesiuxf3n-de-r}}
\addcontentsline{toc}{subsection}{Informe de la sesión de R}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sessionInfo}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## R version 4.3.0 (2023-04-21)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 20.04.3 LTS
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0
## 
## locale:
##  [1] LC_CTYPE=es_DO.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=es_DO.UTF-8        LC_COLLATE=es_DO.UTF-8    
##  [5] LC_MONETARY=es_DO.UTF-8    LC_MESSAGES=es_DO.UTF-8   
##  [7] LC_PAPER=es_DO.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=es_DO.UTF-8 LC_IDENTIFICATION=C       
## 
## time zone: America/Santo_Domingo
## tzcode source: system (glibc)
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] e1071_1.7-13        gdalUtilities_1.2.4 lubridate_1.9.2    
##  [4] forcats_1.0.0       stringr_1.5.0       dplyr_1.1.2        
##  [7] purrr_1.0.1         readr_2.1.4         tidyr_1.3.0        
## [10] tibble_3.2.1        ggplot2_3.4.2       tidyverse_2.0.0    
## [13] kableExtra_1.3.4    sf_1.0-12           raster_3.6-20      
## [16] sp_1.6-0           
## 
## loaded via a namespace (and not attached):
##  [1] gtable_0.3.3       xfun_0.39          lattice_0.20-45    tzdb_0.4.0        
##  [5] vctrs_0.6.2        tools_4.3.0        generics_0.1.3     parallel_4.3.0    
##  [9] proxy_0.4-27       fansi_1.0.4        pkgconfig_2.0.3    Matrix_1.4-0      
## [13] KernSmooth_2.23-20 webshot_0.5.4      lifecycle_1.0.3    compiler_4.3.0    
## [17] munsell_0.5.0      terra_1.7-29       codetools_0.2-18   htmltools_0.5.5   
## [21] class_7.3-20       yaml_2.3.7         crayon_1.5.2       pillar_1.9.0      
## [25] classInt_0.4-9     cachem_1.0.8       wk_0.7.3           conflicted_1.2.0  
## [29] tidyselect_1.2.0   rvest_1.0.3        digest_0.6.31      stringi_1.7.12    
## [33] fastmap_1.1.1      grid_4.3.0         colorspace_2.1-0   cli_3.6.1         
## [37] magrittr_2.0.3     utf8_1.2.3         withr_2.5.0        scales_1.2.1      
## [41] bit64_4.0.5        timechange_0.2.0   rmarkdown_2.21     httr_1.4.6        
## [45] bit_4.0.5          reticulate_1.30    png_0.1-8          hms_1.1.3         
## [49] ggspatial_1.1.8    memoise_2.0.1      evaluate_0.21      knitr_1.42        
## [53] viridisLite_0.4.2  s2_1.1.4           rticles_0.25       rlang_1.1.1       
## [57] Rcpp_1.0.10        glue_1.6.2         DBI_1.1.3          xml2_1.3.4        
## [61] vroom_1.6.3        jsonlite_1.8.4     svglite_2.1.1      rstudioapi_0.14   
## [65] R6_2.5.1           systemfonts_1.0.4  units_0.8-2
\end{verbatim}

\hypertarget{referencias}{%
\section*{Referencias}\label{referencias}}
\addcontentsline{toc}{section}{Referencias}

\hypertarget{refs}{}
\begin{CSLReferences}{1}{0}
\leavevmode\vadjust pre{\hypertarget{ref-anderson2010geomorphology}{}}%
Anderson, R. S. y Anderson, S. P. (2010). \emph{Geomorphology: the
mechanics and chemistry of landscapes}. Cambridge University Press.

\leavevmode\vadjust pre{\hypertarget{ref-asfdaac2014hires}{}}%
ASF DAAC. (2014).
\emph{PALSAR{\_}Radiometric{\_}Terrain{\_}Corrected{\_}high{\_}res}.
\url{https://doi.org/10.5067/Z97HFCNKR6VA}

\leavevmode\vadjust pre{\hypertarget{ref-aziz2022}{}}%
Aziz, K. M. A. y Rashwan, K. S. (2022). Comparison of different
resolutions of six free online DEMs with GPS elevation data on a new 6th
of October City, Egypt. \emph{Arabian Journal of Geosciences},
\emph{15}(20), 1585. \url{https://doi.org/10.1007/s12517-022-10845-5}

\leavevmode\vadjust pre{\hypertarget{ref-burn1997}{}}%
Burn, D. H. (1997). Hydrological information for sustainable
development. \emph{Hydrological Sciences Journal}, \emph{42}(4),
481-492. \url{https://doi.org/10.1080/02626669709492048}

\leavevmode\vadjust pre{\hypertarget{ref-charlton2010fundamentals}{}}%
Charlton, R. (2010). \emph{Fundamentals of fluvial geomorphology}
(Repr). Routledge.

\leavevmode\vadjust pre{\hypertarget{ref-cidiatindrhi1992control}{}}%
CIDIAT y INDRHI. (1992). \emph{{Control de Inundaciones en la cuenca del
Río Yaque del Sur}}. {Instituto Nacional de Recursos Hidráulicos
(INDRHI)}.

\leavevmode\vadjust pre{\hypertarget{ref-ehlschlaeger1989using}{}}%
Ehlschlaeger, C. R. (1989). \emph{Using the A{\^{}} T search algorithm
to develop hydrologic models from digital elevation data}. 275281.

\leavevmode\vadjust pre{\hypertarget{ref-foucault1985diccionario}{}}%
Foucault, A. y Raoult, J. F. (1985). \emph{Diccionario de Geología}.
MASSON. \url{https://books.google.com.do/books?id=x5FDPQAACAAJ}

\leavevmode\vadjust pre{\hypertarget{ref-freeman1991calculating}{}}%
Freeman, T. G. (1991). Calculating catchment area with divergent flow
based on a regular grid. \emph{Computers \& Geosciences}, \emph{17}(3),
413-422. \url{https://doi.org/10.1016/0098-3004(91)90048-I}

\leavevmode\vadjust pre{\hypertarget{ref-gadm}{}}%
GADM. (2022). \emph{{GADM}}. Available online:
\url{https://gadm.org/index.html} (accessed on abril, 2023).

\leavevmode\vadjust pre{\hypertarget{ref-garcia2011clasificacion}{}}%
García, J. H. G. y Ojeda, A. O. (2011). Clasificación geomorfológica de
cursos fluviales a partir de sistemas de información geográfica (SIG).
\emph{Boletín de la Asociación de Geógrafos Españoles}, \emph{56},
373-396.

\leavevmode\vadjust pre{\hypertarget{ref-gdal2022gdal}{}}%
GDAL/OGR contributors. (2022). \emph{{GDAL/OGR} Geospatial Data
Abstraction software Library}. Open Source Geospatial Foundation.
\url{https://doi.org/10.5281/zenodo.5884351}

\leavevmode\vadjust pre{\hypertarget{ref-googlemaps}{}}%
Google; Airbus, CNES; Airbus, Landsat; Copernicus; Maxar Technologies;
U.S. Geological Survey. (2023). \emph{Google Maps}.
\url{https://www.google.com/maps/}

\leavevmode\vadjust pre{\hypertarget{ref-GRASS_GIS_software}{}}%
GRASS Development Team. (2022a). \emph{Geographic Resources Analysis
Support System (GRASS) Software, Version 8.0.2}. Open Source Geospatial
Foundation. \url{https://grass.osgeo.org}

\leavevmode\vadjust pre{\hypertarget{ref-grassdev2022rcarve}{}}%
GRASS Development Team. (2022b). \emph{r.carve. Generates stream
channels. Takes vector stream data, transforms it to raster and
subtracts depth from the output DEM. GRASS GIS manual}.
\url{https://grass.osgeo.org/grass82/manuals/r.carve.html}

\leavevmode\vadjust pre{\hypertarget{ref-grassdev2022rmapcalc}{}}%
GRASS Development Team. (2022c). \emph{r.mapcalc - Raster map
calculator. GRASS GIS manual}.
\url{https://grass.osgeo.org/grass82/manuals/r.mapcalc.html}

\leavevmode\vadjust pre{\hypertarget{ref-grassdev2022rwatershed}{}}%
GRASS Development Team. (2022d). \emph{r.watershed - Calculates
hydrological parameters and RUSLE factors.}
\url{https://grass.osgeo.org/grass82/manuals/r.watershed.html}

\leavevmode\vadjust pre{\hypertarget{ref-GRASS_GIS_softwarev82}{}}%
GRASS Development Team. (2023). \emph{Geographic Resources Analysis
Support System (GRASS) Software, Version 8.2.0}. Open Source Geospatial
Foundation. \url{https://grass.osgeo.org}

\leavevmode\vadjust pre{\hypertarget{ref-gutierrez2009geomorfologia}{}}%
Gutiérrez Elorza, M. (2009). \emph{Geomorfología} (Última reimpr).
Pearson-Prentice Hall.

\leavevmode\vadjust pre{\hypertarget{ref-halcrow1992estudio}{}}%
Halcrow-COR Ing. S.A. (2002). \emph{{Estudio de Vulnerabilidad de las
Grandes Presas}}. {Instituto Nacional de Recursos Hidráulicos (INDRHI)}.

\leavevmode\vadjust pre{\hypertarget{ref-hijmans2023raster}{}}%
Hijmans, R. J. (2023). \emph{raster: Geographic Data Analysis and
Modeling}. \url{https://CRAN.R-project.org/package=raster}

\leavevmode\vadjust pre{\hypertarget{ref-holmgren1994multiple}{}}%
Holmgren, P. (1994). Multiple flow direction algorithms for runoff
modelling in grid based elevation models: An empirical evaluation.
\emph{Hydrological Processes}, \emph{8}(4), 327-334.
\url{https://doi.org/10.1002/hyp.3360080405}

\leavevmode\vadjust pre{\hypertarget{ref-horton1945erosional}{}}%
Horton, R. E. (1945). {Erosional development of streams and their
drainage basins: Hydrophysical approach to quantitative morphology}.
\emph{Geological Society of America Bulletin}, \emph{56}(3), 275-370.
\url{https://doi.org/10.1130/0016-7606(1945)56\%5B275:EDOSAT\%5D2.0.CO;2}

\leavevmode\vadjust pre{\hypertarget{ref-indrhi1996estadisticas}{}}%
INDRHI. (1996). \emph{{Estadísticas del Agua en la República
Dominicana}}. {Instituto Nacional de Recursos Hidráulicos (INDRHI)}.

\leavevmode\vadjust pre{\hypertarget{ref-indrhi2012plan}{}}%
INDRHI. (2012). \emph{{Plan Hidrológico Nacional, República
Dominicana}}. {Instituto Nacional de Recursos Hidráulicos (INDRHI)}.

\leavevmode\vadjust pre{\hypertarget{ref-indrhi2019inventario}{}}%
INDRHI. (2019). \emph{{Inventario de Estaciones Hidrometeorológicas.
Informe Final}}. {Instituto Nacional de Recursos Hidráulicos}.

\leavevmode\vadjust pre{\hypertarget{ref-indrhiaquater2000estudio}{}}%
INDRHI y AQUATER. (2000). \emph{{Estudio Hidrogeológico Nacional de la
República Dominicana, Fase I. Memoria de Proyecto, 7 volúmenes}}.
{Instituto Nacional de Recursos Hidráulicos (INDRHI)}.

\leavevmode\vadjust pre{\hypertarget{ref-indrhieptisa2004estudio}{}}%
INDRHI y EPTISA. (2000). \emph{{Estudio Hidrogeológico Nacional de la
República Dominicana, Fase II}}. {Instituto Nacional de Recursos
Hidráulicos (INDRHI)}.

\leavevmode\vadjust pre{\hypertarget{ref-icm1989serie}{}}%
Instituto Cartográfico Militar (ICM). (1989). \emph{{Serie E733 de mapas
topográficos escala 1:50,000}}. {Instituto Cartográfico Militar}.

\leavevmode\vadjust pre{\hypertarget{ref-ign2022medicion}{}}%
Instituto Geográfico Nacional. (2022). \emph{Medición por Sistema Global
de Navegación por Satélite (GNSS) de los Tres Picos Más Altos De Las
Antillas}. Disponible en línea. Accedido a través de
\url{https://www.ign.gob.do/index.php/noticias/item/448-medicion-por-sistema-global-de-navegacion-por-satelite-gnss-de-los-tres-picos-mas-altos-de-las-antillas}.

\leavevmode\vadjust pre{\hypertarget{ref-Izzo2010ANC}{}}%
Izzo, M., Rosskopf, C. M., Aucelli, P. P. C., Maratea, A., Méndez, R.
E., Pérez, C. y Segura, H. (2010). A New Climatic Map of the Dominican
Republic Based on the Thornthwaite Classification. \emph{Physical
Geography}, \emph{31}, 455-472.

\leavevmode\vadjust pre{\hypertarget{ref-jarvis2008}{}}%
Jarvis, A., Reuter, H. I., Nelson, A. y Guevara, E. (2008). Hole-filled
SRTM for the globe Version 4. \emph{available from the CGIAR-CSI SRTM
90m Database (http://srtm. csi. cgiar. org)}, \emph{15}(25-54), 5.

\leavevmode\vadjust pre{\hypertarget{ref-jasiewicz2011a}{}}%
Jasiewicz, J. y Metz, M. (2011). A new GRASS GIS toolkit for Hortonian
analysis of drainage networks. \emph{Computers \& Geosciences},
\emph{37}(8), 1162-1173.
\url{https://doi.org/10.1016/j.cageo.2011.03.003}

\leavevmode\vadjust pre{\hypertarget{ref-jasiewicz2013}{}}%
Jasiewicz, J. y Stepinski, T. F. (2013). Geomorphons {\textemdash} a
pattern recognition approach to classification and mapping of landforms.
\emph{Geomorphology}, \emph{182}, 147-156.
\url{https://doi.org/10.1016/j.geomorph.2012.11.005}

\leavevmode\vadjust pre{\hypertarget{ref-jaxameti2007alos}{}}%
JAXA/METI y ASF DAAC. (2015). \emph{{ALOS
PALSAR\_Radiometric\_Terrain\_Corrected\_high\_res. Includes material de
JAXA/METI 2010}}. Disponible en línea. Accedido a través de ASF DAAC
\url{https://asf.alaska.edu/}. DOI:
\url{https://doi.org/10.5067/Z97HFCNKR6VA} (accessed on abril, 2023).

\leavevmode\vadjust pre{\hypertarget{ref-larson1991performing}{}}%
Larson, M., Shapiro, M. y Tweddale, S. (1991). Performing map
calculations on GRASS data: r. mapcalc program tutorial. \emph{US Army
Corps of Engineers, Construction Engineering Research Laboratory.
https://grass. osgeo. org/uploads/grass/history{\_}docs/mapcalc. pdf}.

\leavevmode\vadjust pre{\hypertarget{ref-Le2019ClimateCA}{}}%
Le, T. D. N. (2019). Climate change adaptation in coastal cities of
developing countries: characterizing types of vulnerability and
adaptation options. \emph{Mitigation and Adaptation Strategies for
Global Change}, \emph{25}, 739-761.

\leavevmode\vadjust pre{\hypertarget{ref-LincolnLenderking2020ClimateCA}{}}%
Lenderking, H. L., Robinson, S. y Carlson, G. R. (2020). Climate change
and food security in Caribbean small island developing states:
challenges and strategies. \emph{International Journal of Sustainable
Development \& World Ecology}, \emph{28}, 238-245.

\leavevmode\vadjust pre{\hypertarget{ref-lindsay2016}{}}%
Lindsay, J. B. (2016). The practice of DEM stream burning revisited: The
Practice of DEM Stream Burning Revisited. \emph{Earth Surface Processes
and Landforms}, \emph{41}(5), 658-668.
\url{https://doi.org/10.1002/esp.3888}

\leavevmode\vadjust pre{\hypertarget{ref-lindsay2018whiteboxtools}{}}%
Lindsay, J. B. (2018). \emph{{WhiteboxTools user manual}}. Available
online: \url{https://www.whiteboxgeo.com/manual/wbt_book/intro.html}
(accessed on abril, 2023).

\leavevmode\vadjust pre{\hypertarget{ref-lindsay2019}{}}%
Lindsay, J. B., Francioni, A. y Cockburn, J. M. H. (2019). LiDAR DEM
Smoothing and the Preservation of Drainage Features. \emph{Remote
Sensing}, \emph{11}(16), 1926. \url{https://doi.org/10.3390/rs11161926}

\leavevmode\vadjust pre{\hypertarget{ref-Lohmann2016ComparingVA}{}}%
Lohmann, H. (2016). Comparing vulnerability and adaptive capacity to
climate change in individuals of coastal Dominican Republic. \emph{Ocean
\& Coastal Management}, \emph{132}, 111-119.

\leavevmode\vadjust pre{\hypertarget{ref-Mackay2017TheFO}{}}%
Mackay, E. A. y Spencer, A. J. (2017). The future of Caribbean tourism:
competition and climate change implications. \emph{Worldwide Hospitality
and Tourism Themes}, \emph{9}, 44-59.

\leavevmode\vadjust pre{\hypertarget{ref-marchesini2021}{}}%
Marchesini, I., Salvati, P., Rossi, M., Donnini, M., Sterlacchini, S. y
Guzzetti, F. (2021). Data-driven flood hazard zonation of Italy.
\emph{Journal of Environmental Management}, \emph{294}, 112986.
\url{https://doi.org/10.1016/j.jenvman.2021.112986}

\leavevmode\vadjust pre{\hypertarget{ref-martinez2019drainagepreprint}{}}%
Martinez-Batlle, J.-R. (2019). \emph{Drainage rearrangement as a driver
of geomorphological evolution during the Upper Pleistocene in a small
tropical basin}. \url{https://doi.org/10.31223/OSF.IO/PFZVQ}

\leavevmode\vadjust pre{\hypertarget{ref-martinez2019drainagejgg}{}}%
Martínez-Batlle, J.-R. (2019). Drainage Rearrangement as a Driver of
Geomorphological Evolution During the Upper Pleistocene in a Small
Tropical Basin. \emph{Journal of Geography and Geology}, \emph{11}(2),
1. \url{https://doi.org/10.5539/jgg.v11n2p1}

\leavevmode\vadjust pre{\hypertarget{ref-martinez2023datos}{}}%
Martínez-Batlle, J.-R. y Izzo-Gioiosa, M. (2023). \emph{Datos del
estudio "Generación de red hidrográfica densa de República Dominicana a
partir de modelo digital de elevaciones de resolución media"}.
\url{https://doi.org/10.5281/ZENODO.8146391}

\leavevmode\vadjust pre{\hypertarget{ref-mccool1987revised}{}}%
McCool, D. K., Brown, L. C., Foster, G. R., Mutchler, C. K. y Meyer, L.
D. (1987). Revised Slope Steepness Factor for the Universal Soil Loss
Equation. \emph{Transactions of the ASAE}, \emph{30}(5), 1387-1396.
\url{https://doi.org/10.13031/2013.30576}

\leavevmode\vadjust pre{\hypertarget{ref-metz2011efficient}{}}%
Metz, M., Mitasova, H. y Harmon, R. S. (2011). Efficient extraction of
drainage networks from massive, radar-based elevation models with least
cost path search. \emph{Hydrology and Earth System Sciences},
\emph{15}(2), 667-678. \url{https://doi.org/10.5194/hess-15-667-2011}

\leavevmode\vadjust pre{\hypertarget{ref-mishra2009}{}}%
Mishra, A. K. y Coulibaly, P. (2009). Developments in hydrometric
network design: A review. \emph{Reviews of Geophysics}, \emph{47}(2),
RG2001. \url{https://doi.org/10.1029/2007RG000243}

\leavevmode\vadjust pre{\hypertarget{ref-mishra2010}{}}%
Mishra, A. K. y Coulibaly, P. (2010). Hydrometric network evaluation for
Canadian watersheds. \emph{Journal of Hydrology}, \emph{380}(3-4),
420-437. \url{https://doi.org/10.1016/j.jhydrol.2009.11.015}

\leavevmode\vadjust pre{\hypertarget{ref-mollat2004mapa}{}}%
Mollat, H., Wagner, B. M., Cepek, P. y Weiss, W. (2004). \emph{{Mapa
Geol{ó}gico de la Rep{ú}blica Dominicana 1~:~250.000. Texto
Explicativo}}. E. Schweizerbart'sche Verlagsbuchhandiung.

\leavevmode\vadjust pre{\hypertarget{ref-moore1991digital}{}}%
Moore, I. D., Grayson, R. B. y Ladson, A. R. (1991). Digital terrain
modelling: A review of hydrological, geomorphological, and biological
applications. \emph{Hydrological Processes}, \emph{5}(1), 3-30.
\url{https://doi.org/10.1002/hyp.3360050103}

\leavevmode\vadjust pre{\hypertarget{ref-nasajpl2013nasa}{}}%
NASA JPL. (2013). \emph{NASA Shuttle Radar Topography Mission Global 3
arc second {[}Data set{]}}.
\url{https://doi.org/10.5067/MEaSUREs/SRTM/SRTMGL3.003}

\leavevmode\vadjust pre{\hypertarget{ref-nasa2014srtm1sdem}{}}%
NASA LP DAAC. (2000). \emph{SRTM 1 Arc-Second Global}.
\url{https://earthexplorer.usgs.gov/}.

\leavevmode\vadjust pre{\hypertarget{ref-nasa2013aster}{}}%
National Aeronautics and Space Administration y United States Geological
Survey. (2009). \emph{{ASTER GDEM}}. \url{https://lpdaac.usgs.gov/}.

\leavevmode\vadjust pre{\hypertarget{ref-ngula2019usefulness}{}}%
Ngula Niipele, J. y Chen, J. (2019). {The usefulness of alos-palsar dem
data for drainage extraction in semi-arid environments in The Iishana
sub-basin}. \emph{Journal of Hydrology: Regional Studies}, \emph{21},
57-67. \url{https://doi.org/10.1016/j.ejrh.2018.11.003}

\leavevmode\vadjust pre{\hypertarget{ref-obrien2023gdalutilities}{}}%
O'Brien, J. (2023). \emph{gdalUtilities: Wrappers for 'GDAL' Utilities
Executables}. \url{https://CRAN.R-project.org/package=gdalUtilities}

\leavevmode\vadjust pre{\hypertarget{ref-ocha2023hdx}{}}%
OCHA. (2022). \emph{{Humanitarian Data Exchange (OCHA)}}. Available
online: \url{https://data.humdata.org/dataset/cod-ab-dom} (accessed on
abril, 2023).

\leavevmode\vadjust pre{\hypertarget{ref-oeaindrhi1994estudio}{}}%
OEA y INDRHI. (1994). \emph{{Plan Nacional de Ordenamiento de los
Recursos Hídricos (PNORHI)}}. {Instituto Nacional de Recursos
Hidráulicos (INDRHI)}.

\leavevmode\vadjust pre{\hypertarget{ref-one2023division}{}}%
Oficina Nacional de Estadística (ONE). (2018). \emph{{División
territorial de República Dominicana}}. Available online:
\url{https://www.one.gob.do/media/s5gdl00n/divisi\%C3\%B3n-territorial-2020-t.pdf}
(accessed on abril, 2023).

\leavevmode\vadjust pre{\hypertarget{ref-OpenStreetMap}{}}%
OpenStreetMap contributors. (2017). \emph{{Planet dump retrieved from
https://planet.osm.org }}. Available online:
\url{https://www.openstreetmap.org} (accessed on abril, 2023).

\leavevmode\vadjust pre{\hypertarget{ref-pebesma2018simple}{}}%
Pebesma, E. (2018). {Simple Features for R: Standardized Support for
Spatial Vector Data}. \emph{{The R Journal}}, \emph{10}(1), 439-446.
\url{https://doi.org/10.32614/RJ-2018-009}

\leavevmode\vadjust pre{\hypertarget{ref-pebesma2023spatial}{}}%
Pebesma, E. y Bivand, R. (2023). \emph{{Spatial Data Science: With
applications in R}} (p. 352). {Chapman and Hall/CRC}.
\url{https://r-spatial.org/book/}

\leavevmode\vadjust pre{\hypertarget{ref-pedraza1996geomorfologia}{}}%
Pedraza Gilsanz, J. de. (1996). \emph{Geomorfología: principios, métodos
y aplicaciones}. Ed. Rueda.

\leavevmode\vadjust pre{\hypertarget{ref-petrasova2011geoinformation}{}}%
Petrasova, A., Petras, V., Jeziorska, J., White, C. H. C., Reckling, W.,
Millar, G., Grokhowsky, N., Paulukonis, A., Montgomery, K., Coffer, M.,
Harmon, B., Cepero, K., Starek, M., Hardin, N. L. E., Paris, P., Russ,
E., Weaver, K., Fogleman, B., Leo, M. di y Stopkova, E. (2011).
\emph{GeoInformation Science and Environmental Modeling}.
\url{http://fatra.cnr.ncsu.edu/~hmitaso/}

\leavevmode\vadjust pre{\hypertarget{ref-QGIS_software}{}}%
QGIS Development Team. (2021). \emph{QGIS Geographic Information System,
Version 3.26.2}. QGIS Association. \url{https://www.qgis.org}

\leavevmode\vadjust pre{\hypertarget{ref-quinn1991prediction}{}}%
Quinn, P., Beven, K., Chevallier, P. y Planchon, O. (1991). The
prediction of hillslope flow paths for distributed hydrological
modelling using digital terrain models. \emph{Hydrological Processes},
\emph{5}(1), 59-79. \url{https://doi.org/10.1002/hyp.3360050106}

\leavevmode\vadjust pre{\hypertarget{ref-rcoreteam2023r}{}}%
R Core Team. (2023). \emph{R: A Language and Environment for Statistical
Computing}. R Foundation for Statistical Computing.
\url{https://www.R-project.org/}

\leavevmode\vadjust pre{\hypertarget{ref-rodriguez2006potencial}{}}%
Rodríguez, H. y Febrillet, J. F. (2006). {Potencial idrogeológico de la
República Dominicana}. \emph{Boletín Geológico y Minero}, \emph{117}.

\leavevmode\vadjust pre{\hypertarget{ref-Roson2013AMF}{}}%
Roson, R. (2013). A Modeling Framework to Assess the Economic Impact of
Climate Change in the Caribbean. \emph{Cepal Review}, \emph{111}, 23-36.

\leavevmode\vadjust pre{\hypertarget{ref-saunders2000}{}}%
Saunders, W. (2000). Preparation of DEMs for use in environmental
modeling analysis. \emph{Hydrologic and Hydraulic Modeling Support.
Redlands, CA: ESRI}, 2951.

\leavevmode\vadjust pre{\hypertarget{ref-semarn2004atlas}{}}%
Secretaría de Estado de Medio Ambiente y Recursos Naturales. (2004).
\emph{{Atlas de los Recursos Naturales de la República Dominicana}}.
{Secretaría de Estado de Medio Ambiente y Recursos Naturales}.

\leavevmode\vadjust pre{\hypertarget{ref-sercitecindrhi2002control}{}}%
SERCITEC y INDRHI. (2002). \emph{{Control de Inundaciones de la cuenca
del Río Yaque del Norte}}. {Instituto Nacional de Recursos Hidráulicos
(INDRHI)}.

\leavevmode\vadjust pre{\hypertarget{ref-shapiro1994rmapcalc}{}}%
Shapiro, M. y Westervelt, J. (1994). \emph{r. mapcalc: An algebra for
GIS and image processing}. US Army Corps of Engineers, Construction
Engineering Research Laboratories.

\leavevmode\vadjust pre{\hypertarget{ref-strahler1957quantitative}{}}%
Strahler, A. N. (1957). Quantitative analysis of watershed
geomorphology. \emph{Eos, Transactions American Geophysical Union},
\emph{38}(6), 913-920. \url{https://doi.org/10.1029/tr038i006p00913}

\leavevmode\vadjust pre{\hypertarget{ref-vanrossum2009python}{}}%
Van Rossum, G. y Drake, F. L. (2009). \emph{Python 3 Reference Manual}.
CreateSpace.

\leavevmode\vadjust pre{\hypertarget{ref-weltz1988revised}{}}%
Weltz, M. A., Renard, K. G. y Simanton, J. R. (1988). Revised Universal
Soil Loss Equation for Western Rangelands{\^{}}1. \emph{Estrategias de
Clasificación Y Manejo de Vegetación Silvestre Para la Producción de
Alimentos en Zonas Áridas}, \emph{150}, 104.

\leavevmode\vadjust pre{\hypertarget{ref-whicham2019welcome}{}}%
Wickham, H., Averick, M., Bryan, J., Chang, W., McGowan, L. D.,
François, R., Grolemund, G., Hayes, A., Henry, L., Hester, J., Kuhn, M.,
Pedersen, T. L., Miller, E., Bache, S. M., Müller, K., Ooms, J.,
Robinson, D., Seidel, D. P., Spinu, V., \ldots{} Yutani, H. (2019).
Welcome to the {tidyverse}. \emph{Journal of Open Source Software},
\emph{4}(43), 1686. \url{https://doi.org/10.21105/joss.01686}

\leavevmode\vadjust pre{\hypertarget{ref-xie2014implementing}{}}%
Xie, Y. (2014). knitr: A Comprehensive Tool for Reproducible Research in
{R}. En V. Stodden, F. Leisch, y R. D. Peng (Eds.), \emph{Implementing
Reproducible Computational Research}. Chapman; Hall/CRC.

\leavevmode\vadjust pre{\hypertarget{ref-xie2015dynamic}{}}%
Xie, Y. (2015). \emph{Dynamic Documents with {R} and knitr} (2nd ed.).
Chapman; Hall/CRC. \url{https://yihui.org/knitr/}

\leavevmode\vadjust pre{\hypertarget{ref-xie2023knitr}{}}%
Xie, Y. (2023). \emph{knitr: A General-Purpose Package for Dynamic
Report Generation in R}. \url{https://yihui.org/knitr/}

\leavevmode\vadjust pre{\hypertarget{ref-zhu2021kableextra}{}}%
Zhu, H. (2021). \emph{kableExtra: Construct Complex Table with 'kable'
and Pipe Syntax}. \url{https://CRAN.R-project.org/package=kableExtra}

\end{CSLReferences}

\bibliographystyle{unsrt}
\bibliography{references.bib}


\end{document}
