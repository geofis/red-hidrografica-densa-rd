---
title: Generación de red hidrográfica densa de República Dominicana a partir de modelo digital de elevaciones de resolución media
authors:
  - name: José-Ramón Martínez-Batlle\orcidlink{0000-0001-9924-0327}
    department: Facultad de Ciencias
    affiliation: Universidad Autónoma de Santo Domingo (UASD)
    location:  Santo Domingo, República Dominicana
    email: joseramon@geografiafisica.org
  - name: Michela Izzo Gioiosa\orcidlink{0000-0003-4835-3967}
    department: Directora Ejecutiva
    affiliation: Guakia Ambiente
    location:  Santo Domingo, República Dominicana
    email: michela.izzo@guakiambiente.org
abstract: |
  El resumen se colocará aquí.
keywords:
  - modelo digital de elevaciones
  - análisis hidrológico
  - procesamiento de datos geoespaciales
  - hidrología computacional
bibliography: references.bib
csl: apa-es.csl
lang: es
output: rticles::arxiv_article
editor_options: 
  chunk_output_type: console
always_allow_html: true
header-includes:
  \usepackage{orcidlink}
  \usepackage{float}
  \usepackage[all]{nowidow}
  \usepackage[spanish]{babel}
  \renewcommand\spanishtablename{Tabla}
  \usepackage{xcolor}
  \usepackage{tabu}
  \renewcommand\tablename{Tabla}
  \renewcommand\figurename{Figura}
  \newcommand{\beginsupplement}{
    \setcounter{table}{0}
    \renewcommand{\thetable}{S\arabic{table}}
    \renewcommand\tablename{Tabla}
    \setcounter{figure}{0}
    \renewcommand{\thefigure}{S\arabic{figure}}
    \renewcommand\figurename{Figura}
  }
  \usepackage[hidelinks]{hyperref}
  \usepackage{xurl}
  \usepackage[left]{lineno}
  \linenumbers
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  cache = TRUE, 
  echo = TRUE,
  warning = FALSE,
  message = FALSE,
  out.width = '80%',
  dpi = 300,
  fig.align = "center"
  )
# options(digits = 3)
options(knitr.duplicate.label = "allow")
raiz_supl_met <- 'suplemento'
```

```{r, echo=F, include=F}
incluir_supl_al_final <- T
cargar_script_supl_met <- T
if(cargar_script_supl_met) {
  knitr::purl(paste0(raiz_supl_met, '.Rmd'))
  source(paste0(raiz_supl_met, '.R'))
}
```

```{r pkgsetings, echo=F, include=F}
set.seed(99)
library(tidyverse)
theme_set(theme_bw()) 
library(kableExtra)
options(knitr.kable.NA = '', knitr.table.format = 'latex')
```

# Introducción

El agua es un recurso crítico, que impulsa la economía y sostiene la vida. A nivel global, pero especialmente en países que comparten islas pequeñas, como República Dominicana (RD), la administración eficaz de este recurso es esencial [@Lohmann2016ComparingVA; @Izzo2010ANC; @LincolnLenderking2020ClimateCA; @Mackay2017TheFO; @Le2019ClimateCA; @Roson2013AMF]. Sin embargo, la gestión eficiente de los recursos hídricos puede verse limitada por la falta de información precisa y completa sobre la red hidrográfica. En este contexto, las fuentes actuales de información geográfica, a pesar de su valor, presentan limitaciones en cuanto a su resolución, cobertura y consistencia.

La red hidrográfica de RD digitalizada a partir del mapa topográfico nacional a escala 1:50,000 ("MTN-50k") [@icm1989serie] ofrece una cobertura extensa pero carece de los detalles necesarios para apoyar el análisis hidrológico. Por otro lado, los estudios técnicos y multitemáticos de ámbito subnacional desarrollados por el Instituto Nacional de Recursos Hidráulicos (INDRHI) de RD y otras entidades y autores, aunque son valiosas fuentes de información, utilizan metodologías diversas, lo que limita la consolidación de una red hidrográfica coherente a nivel nacional [@indrhi2012plan; @indrhiaquater2000estudio; @indrhieptisa2004estudio; @oeaindrhi1994estudio; @indrhi1996estadisticas; @semarn2004atlas; @rodriguez2006potencial; @cidiatindrhi1992control; @halcrow1992estudio; @sercitecindrhi2002control; @martinez2019drainagepreprint; @martinez2019drainagejgg]

Adicionalmente, las redes hidrográficas derivadas de modelos digitales de elevaciones de baja resolución, como el Shuttle Radar Topography Mission (SRTM) de 3 arco-segundos, normalmente presentan artefactos de difícil depuración, además de que la longitud de los canales es siempre más corta que la verdadera, resultando en redes poco densas [@nasajpl2013nasa; @jarvis2008; @nasa2014srtm1sdem; @nasa2013aster]. Por otro lado, el DEM SRTM de 1 arco-segundo (\~30 metros) garantiza la precisión mientras aumenta el detalle de elevación y parece ser una de las fuentes más consistentes actualmente [@aziz2022]. No obstante, nosotros hemos generado productos hidrográficos con SRTM-DEM de 30 metros, y notamos que el nivel de detalle de la red es bastante mejorable, sobre todo en áreas de montaña.

Desde 2014, Alaska Satellite Facility (ASF) inició la creación de productos ALOS-PALSAR corregidos radiométricamente en función del terreno (RTC), con el objetivo de mejorar la geometría y la radiometría---coeficiente de retrodispersión por unidad de superficie del frente de onda incidente, también conocido como *gamma-nought*, $\gamma^0$---de las imágenes generadas por el sensor PALSAR (radar de apertura sintética, banda L, con distintas polarizaciones y modos de barrido) montado a bordo del satélite ALOS de la Agencia Espacial Japonesa (JAXA) [@jaxameti2007alos; @asfdaac2014hires]. ALOS fue lanzado en 2006, pero luego de cinco años de servicio, perdió energía y cesó la comunicación con el centro de control, aunque aún permanece en órbita.

Para obtener los productos RTC, denominados propiamente como "*Hi-Res Terrain Corrected*" o "ALOS PALSAR RTC", ASF requirió de datos globales de elevación de la máxima resolución posible, para lo cual empleó de forma preferente (según territorios) el SRTM de 1 arco-segundo. En el proceso fue necesario ajustar el espaciado de píxeles del DEM fuente (\~30 metros) para hacerlo coincidir con el espaciado de píxel de las imágenes ALOS PALSAR (\~ 12.5 metros) usando una función de remuestreo (*up-sampling*), obteniéndose así un DEM de 12.5 metros [@jaxameti2007alos; @asfdaac2014hires].

A pesar de que ASF advirtió que este DEM se empleó únicamente para realizar la corrección radiométrica del terreno del producto derivado de ALOS-PALSAR, y que no debería ser utilizado como fuente de elevación precisa [@asfdaac2014hires], lo cierto es que en países donde no se dispone de DEM de mediana o alta resolución, se vuelve crucial indagar en el potencial de cada nuevo producto disponible. Por esta razón, tras varias pruebas iniciales en las que extrajimos redes de drenaje y elementos del relieve a partir de este DEM, comprobamos que la red hidrográfica obtenida tenía mucho mayor detalle que las redes generadas con cualquier otra fuente disponible. Dado que la elevación precisa no es crucial en nuestras aplicaciones, vimos un alto potencial en este DEM para realizar aplicaciones de hidrología computacional, en concreto para la extracción de redes densas con énfasis en áreas de montaña.

El propósito de este artículo es ofrecer nuevos datos para superar las limitaciones de las redes hidrográficas existentes, desarrollando una red densa de ríos, arroyos y cañadas---canales, talwegs---con énfasis en áreas montañosas---donde las fuentes actualmente disponibles suelen mostrar una red dispersa---, utilizando como fuente el DEM servido con los productos ALOS PALSAR RTC de 12.5 metros de resolución espacial. Nuestro segundo objetivo es optimizar el DEM, reduciendo el ruido y asegurando su precisión hidrológica, a la vez que mantenemos los elementos morfológicos significativos del terreno. El tercer objetivo, no menos importante, es sistematizar el protocolo de procesamiento con una metodología explícita, generando una base de código abierto basada en software libre para el procesamiento de datos de elevación e hidrología computacional, que ofrezca a personas interesadas, especialmente a estudiantes, una referencia didáctica que pueda aplicarse a fuentes de elevación similares.

Nuestro trabajo tiene potencial para suplir las demandas de información sobre hidrografía de resolución fina, que es un aspecto crucial en muchos estudios de modelación, análisis de riesgos, morfometría de cuencas, entre otros. De manera particular, la hidrografía densa generada por nosotros es idónea para mejorar la red estaciones hidrométricas del país, la cual es limitada y afronta diversos desafíos de densidad de puntos y de operación, un común denominador en este tipo de redes globalmente. Nos enfocamos en la utilidad de una hidrografía sistemáticamente generada, no necesariamente en las métricas precisas, pues el modelo digital de elevaciones usado tiene error, y la información de terreno necesaria para conducir el flujo en áreas llanas, es insuficiente. Asimismo, nuestro trabajo también podría contribuir a aportar información para acciones de conservación, planificación y gestión de los recursos hídricos a nivel nacional [@burn1997; @indrhi2019inventario; @mishra2010; @mishra2009]. Además, los datos generados pueden ser de gran valor para un amplio rango de aplicaciones, incluyendo la planificación del uso del suelo, el diseño de infraestructuras, la gestión de cuencas hidrográficas y la modelización de escorrentía y erosión. A medida que nos enfrentamos a los impactos del cambio climático y a la creciente escasez de agua, esperamos que este trabajo sirva como una contribución significativa para la gestión de los recursos hídricos en la República Dominicana [@Lohmann2016ComparingVA; @Izzo2010ANC; @LincolnLenderking2020ClimateCA; @Mackay2017TheFO; @Le2019ClimateCA; @Roson2013AMF].

## Notas sobre terminología {.unnumbered}

La terminología utilizada para describir los distintos componentes de los sistemas fluviales es un tema de continuo debate en el campo de la geomorfología fluvial. Este debate suele estar intrínsecamente ligado a la escala de análisis empleada; al variar la escala, incrementándola o reduciéndola, los criterios empleados para delimitar las definiciones de los elementos morfológicos, tienden a desdibujarse y/o a resultar inconsistentes [@garcia2011clasificacion]. Seleccionar el término apropiado para describir la unidad topográficamente deprimida por donde fluye o por donde podría circular el agua de escorrentía, es un desafío nada despreciable. Este reto se intensifica cuando el idioma introduce distintas connotaciones para términos similares, y donde la traducción podría prestarse a confusión---tal como ocurre con *channel* y canal en inglés y español, respectivamente---[@charlton2010fundamentals; @anderson2010geomorphology; @gutierrez2009geomorfologia; @pedraza1996geomorfologia].

La resolución de las discrepancias en la terminología supera el alcance del presente trabajo, por lo decidimos fijar los términos utilizados en el artículo de manera convencional. En este estudio, empleamos los términos *talweg* y canal de forma indistinta para referimos a la unidad topográficamente deprimida por la que fluye, o podría fluir, la corriente. En geomorfología, utilizamos la voz germánica *talweg* para referirnos a la línea imaginaria que traza la parte más baja de un valle, razón por la cual también la hemos incluido entre los términos genéricos usados [@foucault1985diccionario]. Es importante remarcar que nuestra definición convencional no siempre se refiere a un curso fluvial permanente, pues la circulación del agua es influenciada por múltiples factores. Asimismo, cabe destacar que, a esta unidad geomorfológica en sus distintas variantes hidrodinámicas y dimensionales, también se le conoce con múltiples nombres en República Dominicana (en orden de mayor a menor "importancia"), como son río, arroyo o cañada, denominaciones que también incorporamos en la redacción.

Finalmente, en nuestro en este trabajo también adoptamos los términos curso, drenaje o corriente, especialmente cuando destacamos la presencia de un flujo ya sea permanente, semipermanente o intermitente. Además, para el análisis hortoniano de los sistemas fluviales, nos referimos al sistema interconectado de canales, cursos, corrientes o drenajes con las denominaciones "red de drenajes" o "red hidrográfica".

# Materiales y métodos

## Obtención y Preprocesamiento del DEM

```{r obtencionpreprocdem, echo=F, fig.cap='Resumen gráfico de la obtención y preprocesamiento del DEM', fig.pos='H'}
knitr::include_graphics(paste0(figuras, "/", "resumen-obtencion-preprocesamiento-dem.pdf"))
```

Iniciamos nuestro estudio valorando diversas herramientas para el procesamiento de los datos (Figura \ref{fig:obtencionpreprocdem}). Debido a la gran variedad de complementos que ofrece, junto con su alto rendimiento y la calidad de los resultados que proporciona, decidimos utilizar GRASS GIS v8.2.0 para realizar la mayor parte del preprocesamiento del DEM [@GRASS_GIS_softwarev82]. La implementación de su interfaz de línea de comandos (e.g. interfaz basada en texto), en nuestro caso Bash, garantizó la reproducibilidad de nuestros procedimientos. Nos auxiliamos también de la biblioteca GDAL/OGR, WhiteboxTools el entorno de programación estadística R y el lenguaje de programación Python [@gdal2022gdal; @lindsay2018whiteboxtools; @rcoreteam2023r; @vanrossum2009python]. Nuestro enfoque de reproducibilidad asegura que, sin importar la fuente de datos empleada, el seguimiento del flujo de trabajo es viable, manteniendo la integridad y coherencia del proceso de análisis, sin menoscabo de la calidad del resultado final.

Asimismo, para facilitar nuestra labor, utilizamos una serie de bibliotecas de R, además de funciones personalizadas escritas por nosotros para agilizar y optimizar las tareas de limpieza y representación de datos y mapas [@hijmans2023raster; @whicham2019welcome; @obrien2023gdalutilities; @pebesma2018simple; @pebesma2023spatial; @zhu2021kableextra; @xie2023knitr; @xie2015dynamic; @xie2014implementing]. El código reproducible usado en el estudio se puede consultar en la sección [Información suplementaria](#infosupl), así como los repositorios creados al efecto, donde incluimos el código escrito y las direcciones para acceder a los datos fuentes, entre otras utilidades.

Nos centramos en la fuente de datos, que en nuestro caso es el modelo digital de elevaciones (DEM) servido con los productos *Hi-Res Terrain Corrected* de Alaska Satellite Facility (ASF) [@asfdaac2014hires]. Este producto se descarga desde el Centro de Archivo Activo Distribuido del Alaska Satellite Facility o ASF DAAC---una de las instalaciones temáticas de la Administración Nacional de Aeronáutica y del Espacio de los Estados Unidos, NASA---en forma de escenas o "cuadros" (*tiles*), conteniendo dos imágenes de retrodispersión $\gamma^0$ (ca. 70x58 km cada una), una por cada polaridad, y el modelo digital de elevaciones remuestreado con el que ASF realizó la corrección radiométrica de terreno (ca. 80x70 km), objeto de nuestro estudio.

Cabe señalar que en un estudio de @aziz2022, se evaluó la precisión del DEM comparándolo con otras fuentes de elevación, encontrándose un rendimiento relativamente bajo en varias pruebas. Sin embargo, en el trabajo se utilizó el DEM sin preprocesar, lo cual seguramente afectó el detectado bajo rendimiento. Consideramos que, a pesar de los resultados de su comparativa, la alta resolución del DEM lo convierte en una excelente opción para la extracción de redes de drenaje, siempre que se apliquen filtros apropiados [@ngula2019usefulness]. Además, ASF señaló en su documentación [@jaxameti2007alos; @asfdaac2014hires] que el DEM usado en la RTC no es una fuente confiable de elevación, por lo que el resultado obtenido por @aziz2022 era más bien el esperado.

Para conformar un mosaico continuo del DEM de República Dominicana, seleccionamos y descargamos más de 40 escenas únicas de ALOS-PALSAR desde el ASF DAAC [@jaxameti2007alos], minimizando la redundancia espacial y eligiendo las versiones más recientes, conservando sólo `r nrow(ind_orig_sel)` escenas distintas (Figura \ref{fig:mapaindice} y Tabla \ref{tab:tablaindice}). Después, extrajimos los DEM correspondientes de los archivos comprimidos y transformamos aquellos proyectos en el huso 18N al 19N del sistema UTM. Posteriormente, creamos un mosaico continuo ("sin costuras") usando el formato de ráster virtual.

```{r mapaindice, echo=F, fig.cap=paste('Mapa índice de las', nrow(ind_orig_sel), 'escenas usadas en la formación del DEM de República Dominicana, superponiendo las huellas (polígono de área con datos) de las escenas ALOS PALSAR RTC sobre el límite costero e internacional del país')}
ind_orig_sel_m
```

Posteriormente, creamos una base de datos, con su correspondiente localización, en GRASS GIS, nuestro software principal por su eficiencia. Ocasionalmente recurrimos a otras herramientas como WhiteboxTools y QGIS, siempre con el objetivo de optimizar el uso de los recursos de hardware para obtener los resultados necesarios de manera rápida [@GRASS_GIS_softwarev82; @lindsay2018whiteboxtools; @QGIS_software]. Complementariamente, generamos una máscara de país en QGIS, fusionando el límite oficial de la Oficina Nacional de Estadística con fuentes en línea como GADM, OCHA y OpenStreetMap, y excluyendo superficies de lagos naturales y embalses para facilitar el análisis de cuencas endorreicas; este paso fue realizado de forma semimanual. Posteriormente, importamos tanto el ráster virtual como la máscara a la base de datos de GRASS GIS (Figura \ref{fig:demsinprocesar}). Inmediatamente, aplicamos la máscara a la región activa para enfocar los análisis sólo dentro del área de interés. [@QGIS_software; @one2023division; @gadm; @ocha2023hdx; @OpenStreetMap].

Dentro de la base de datos de GRASS, rellenamos los datos nulos del DEM (Figura \ref{fig:demrelleno}), para luego suavizar el resultado preservando morfologías con la herramienta *FeaturePreservingSmoothing* de WhiteboxTools (Figura \ref{fig:demsuavizado}) [@lindsay2019; @lindsay2018whiteboxtools]. Tras esto, combinamos el DEM suavizado con el ráster de altura del geoide EGM2008 mediante una simple suma algebraica para obtener alturas pseudo-ortométricas, incrementando previamente la resolución del segundo para acercarla ligeramente a la del primero.

A continuación, como último paso del preprocesamiento, tallamos el DEM con una red preexistente de cursos largos de República Dominicana, un paso clave en la generación de la hidrografía por métodos computacionales, y que en inglés se conoce como *stream burning* [@lindsay2016]. Primero creamos la red a partir de una selección de ríos largos y permanentes, apoyados en imágenes satelitales [@googlemaps], MTN-50K [@icm1989serie] y @OpenStreetMap. Para representar ríos que que llenan embalses, usamos sus trazados históricos para así mantener la continuidad hidrológica (Figura \ref{fig:redcursoslargos}). Luego realizamos el tallado del DEM probando tres algoritmos: `r.carve` y `r.mapcalc` de GRASS GIS, y `FillBurn` de WhiteboxTools [@GRASS_GIS_software; @petrasova2011geoinformation; @grassdev2022rcarve; @grassdev2022rmapcalc; @shapiro1994rmapcalc; @larson1991performing; @lindsay2018whiteboxtools; @saunders2000]. Como criterio de selección establecimos que el mejor algoritmo fuese aquel que lograra una mínima alteración en el DEM, minimizando a la vez el tiempo de cómputo. `r.carve` produjo un buen DEM tallado, aunque ocupó mucho tiempo de cómputo, por lo que no la consideramos una herramienta adecuada para iteraciones rápidas. Con `r.mapcalc` realizamos el tallado mediante una simple álgebra de mapas (normalización, operaciones booleanas, multiplicación), de donde obtuvimos un DEM poco alterado en tiempo relativamente corto. Finalmente, probamos con la función `FillBurn` de WhiteboxTools, la cual produjo un DEM tallado sustancialmente alterado respecto del original, especialmente en las áreas de karst con depresiones. Optamos por continuar nuestro flujo de procesamiento con el DEM tallado por `r.mapcalc` (ver Figura \ref{fig:demtallado}).

Finalmente, como último paso del preprocesamiento del DEM, aplicamos algoritmos para superponer depresiones al modelo, un paso esencial para dirigir la escorrentía y definir de forma coherente los límites de las cuencas y redes de drenaje. Utilizamos diversas fuentes para generar un conjunto de depresiones. Principalmente, a partir de la capa de litologías de la República Dominicana [@mollat2004mapa], identificamos las calizas con suficiente grado de karstificación. Además, utilizamos el complemento `r.geomorphon` para crear una capa de depresiones [@jasiewicz2013] (Figura \ref{fig:geomorfonosrd}), y digitalizamos manualmente algunas depresiones conocidas. Finalmente, intersectamos las tres fuentes de datos para producir una capa exhaustiva de las depresiones que capturan la escorrentía superficial (Figura \ref{fig:depresiones}).

## Procesamiento de hidrología computacional

```{r procesamientohidrocompu, echo=F, fig.cap='Resumen gráfico del procesamiento de hidrología computacional', fig.pos='H'}
knitr::include_graphics(paste0(figuras, "/", "resumen-procesamiento-hidrologia-computacional.pdf"))
```

El avance en las técnicas de procesamiento de hidrología computacional ha permitido estudios cada vez más sofisticados de fenómenos hídricos, impulsado por las actualizaciones y herramientas disponibles hoy en día, entre las cuales destacan las de GRASS GIS [@quinn1991prediction; @freeman1991calculating; @ehlschlaeger1989using; @larson1991performing; @mccool1987revised; @metz2011efficient; @moore1991digital; @weltz1988revised; @holmgren1994multiple]. Por su potencial y múltiples complementos disponibles, todo el procesamiento de hidrología computacional lo desarrollamos en GRASS GIS (Figura \ref{fig:procesamientohidrocompu}).

Antes de iniciar el procesamiento de hidrología computacional con GRASS GIS, aplicamos una máscara de país, delimitada por la línea de costa y a los límites fronterizos, para evitar que las redes se extendieran más allá de nuestra área de interés. Posteriormente, generamos el mapa de acumulación de flujo con el complemento `r.watershed` [@grassdev2022rwatershed] (Figura \ref{fig:acumyredrwshed}), y utilizamos este mapa como fuente de los complementos de la familia `r.stream*` para el estudio de redes de drenaje y jerarquía hidrográfica [@jasiewicz2011a]. Dentro de esta familia se encuentran `r.stream.extract`, que usa el mapa de acumulación de flujo generado por `r.watershed` para extraer la red, `r.stream.order` para calcular la jerarquía hidrográfica, y `r.stream.basins` para crear cuencas hidrográficas en función de la referida jerarquía. En consecuencia, aplicamos estos algoritmos al DEM para generar la hidrografía dominicana jerarquizada y la delimitación de las cuencas según órdenes, proceso que sumarizamos a continuación.

Empleando el DEM y el mapa de acumulación creado con `r.watershed`, generamos la red hidrográfica usando el complemento `r.stream.extract`, enfocándonos en la extracción de cursos indiferenciados, sin caracterización hidrodinámica, sólo morfológica [@marchesini2021; @freeman1991calculating; @jasiewicz2011a]. Basándonos en experiencia de terreno y estudios previos, seleccionamos umbrales de acumulación de 180, 540 y 900 celdas, equivalentes a 3, 8 y 14 hectáreas respectivamente [@freeman1991calculating; @marchesini2021]. Automatizamos la generación de las redes con un bucle `for` en Bash, iterando sobre cada umbral de acumulación; para cada red generada (Figura \ref{fig:redindiferenciada}), actualizamos la base de datos y creamos un resumen con estadísticas básicas.

Para determinar la red hidrográfica óptima de alta densidad de República Dominicana, realizamos una inspección visual de los tres resultados generados a partir de los umbrales de acumulación elegidos (Figura \ref{fig:redorden3umbrales}). Tras evaluar las redes, seleccionamos la obtenida con el umbral de 540 celdas, por ajustarse a nuestros criterios de selección. Sin embargo, para preservar la reproducibilidad de nuestros resultados y facilitar eventuales aplicaciones futuras, decidimos conservar todos las redes en la base de datos, incluyendo las originadas a partir de los umbrales de 180 y 900 celdas. En concreto, la red generada con el umbral 180 celdas, presenta un buen ajuste con las vaguadas topográficas marcadas en el mapa topográfico (Figura \ref{fig:redordenumbral180}).

A continuación, con el complemento `r.stream.order` de GRASS GIS, calculamos la jerarquía de la red hidrográfica para cada uno de los umbrales de acumulación previamente establecidos (180, 540 y 900 celdas), utilizando un bucle en Bash para automatizar el proceso. Este análisis permitió obtener la jerarquía de la red hidrográfica de acuerdo a los métodos de Strahler y Horton, ofreciendo información útil para nuestros objetivos [@horton1945erosional; @strahler1957quantitative].

Utilizando el complemento `r.stream.basins` de GRASS GIS, delimitamos las cuencas y subcuencas según la jerarquía de red para cada uno de los tres umbrales de acumulación. Este proceso permitió la delimitación de unidades que incluyen, de forma indiferenciada, tanto cuencas como subcuencas con redes de drenaje tributarias. Posteriormente, aplicamos el mismo complemento para delimitar las cuencas que desembocan en el mar, lagos, lagunas o pérdidas del karst, excluyendo las subcuencas tributarias (e.g. cuencas sin prolongación de drenaje superficial fuera de ellas).

Finalizamos el procesamiento de hidrología computacional seleccionando solo las cuencas generadas para el umbral de 540 celdas y las convertimos en un modelo de datos vectorial utilizando el complemento `r.to.vect` de GRASS GIS. Este procedimiento incluyó la creación y actualización de una nueva columna `strahler` en la tabla de atributos de cada capa vectorial para indicar el correspondiente orden de red. Después de procesar y fusionar todas las cuencas de cada orden en una única capa vectorial con `v.patch`, procedimos a limpiar y preparar los datos para el análisis. Este paso, que incluyó la corrección de topología, la actualización del área de cada cuenca con `v.clean`, la eliminación de áreas espurias y artefactos, resultó crítico para garantizar la precisión de nuestros resultados. Finalmente, seleccionamos los datos válidos y los exportamos a un archivo de texto, lo que nos proporcionó valiosas estadísticas del área para cada cuenca con desembocadura en mares, lagos o en pérdidas kársticas, según el orden Strahler para nuestro análisis posterior.

# Resultados

La base de datos de cuencas hidrográficas delimitadas y la red de drenaje extraída usando el umbral de acumulación de 540 celdas (\~8 ha), se ajustó bien a nuestros criterios óptimos de selección. El modelo de red hidrográfica y la delimitación de cuencas demostró coherencia, suficiente detalle y una diversidad sustancial a lo largo del territorio dominicano, especialmente en las áreas de montaña, proporcionando una representación hidrográfica precisa sin atenuar patrones de variabilidad. Presentamos a continuación los principales hallazgos, en forma de resúmenes estadísticos, de las cuencas y sus redes de drenaje.

## Cuencas que desembocan en mares, lagos, lagunas o en pérdidas kársticas

En el caso de las cuencas que desembocan en mares, lagos, lagunas o en pérdidas kársticas, en total delimitamos `r nrow(cuencas)` cuencas hidrográficas (Figura \ref{fig:cuencasordenestodas}). Predominan cuencas de gran tamaño y anchura en los valles del Cibao y de San Juan, así como en la periferia de la plataforma kárstica sudoriental. Por otro lado, las cuencas medianas y de forma alargada con forma ligeramente ensanchada en cabecera, tienden a concentrarse a lo largo del borde meridional de la Cordillera Central y en el karst de la plataforma sudoriental. Las cuencas más pequeñas, en cambio, se distribuyen de manera más uniforme a través de los sistemas kársticos y zonas costeras. Entre todas las cuencas delimitadas, se alcanzó una jerarquía de red máxima de ocho, condición que sólo se observó en tres cuencas específicas: Yaque del Sur, Yuna y Ozama.

La cuenca más extensa, correspondiente al río Yaque del Norte, cubre una superficie de `r format(max(cuencas$area)/1000000, scientific=F, digits=4)`&nbsp;km\textsuperscript{2}, aunque sólo alcanzó orden máximo de siete, seguida de las cuencas de los ríos Yuna (`r format(sort(cuencas$area, decreasing = T)[2]/1000000, scientific=F, digits=4)`&nbsp;km\textsuperscript{2}) y Yaque del Sur (`r format(sort(cuencas$area, decreasing = T)[3]/1000000, scientific=F, digits=4)`&nbsp;km\textsuperscript{2}), ambas con orden máximo de ocho (en la siguiente sección, discutimos sobre la discrepancia entre las superficies de cuencas obtenidas por nosotros y los tamaños publicados en referencias existentes). El tamaño promedio de las cuencas es de `r format(mean(cuencas$area)/1000000, scientific=F, digits=1)`&nbsp;km\textsuperscript{2} y desviación estándar de `r format(sd(cuencas$area)/1000000, scientific=F, digits=1)`&nbsp;km\textsuperscript{2}, reflejando la diversidad de las cuencas hidrográficas presentes en el país.

```{r cuencasordenestodas, echo=F, fig.cap='Cuencas según orden de Strahler de República Dominicana, y sus correspondientes redes de drenaje (sólo mostrando los cursos de orden 4 o superior). El umbral de acumulación usado para extraer la red fue de 540 celdas (aprox. 8 ha).'}
knitr::include_graphics(paste(figuras, "cuencas-ordenes-todas.jpg", sep = '/'))
```

La mitad de las cuencas delimitadas tiene `r format(median(cuencas$area)/1000000, scientific=F, digits=2)`&nbsp;km\textsuperscript{2} o menos de superficie, el 25% de las cuencas más grandes apenas supera los `r format(quantile(cuencas$area, 0.75)/1000000, scientific=F, digits=2)`&nbsp;km\textsuperscript{2} y, de hecho, el 5% más grande sólo alcanza `r format(quantile(cuencas$area, 0.95)/1000000, scientific=F, digits=2)`&nbsp;km\textsuperscript{2} o más. Por lo tanto, la distribución de las cuencas por tamaño presenta sesgo a la derecha (sesgo calculado, `r format(e1071::skewness(cuencas$area), scientific=F, digits=4)`), con un importante número de cuencas pequeñas y pocas grandes, un patrón bastante común en este tipo de conjunto de datos.

```{r tablaordenesarea, echo=F}
rstream_cuencas_540_por_orden %>%
  estilo_kable(titulo = paste('Relación entre orden de red de Strahler y número',
                        'de cuencas para el umbral de acumulación 540 celdas ($\\sim$ 8 hectáreas)'))
```

Los estadísticos básicos de cuenca sugieren que los resultados obtenidos fueron consistentes, pues observamos el típico decrecimiento exponencial del número de cuencas en relación con el orden de red (ver Figura \ref{fig:ordennumcuencas} y Tabla \ref{tab:tablaordenesarea}). En segundo lugar, destaca un hecho particular reseñable: el número de cuencas de orden siete es menor que el número de cuencas de orden ocho, un hecho que afecta a la cuenca del Yaque del Norte que, con independencia de su gran tamaño, no alcanza la jerarquía máxima.

```{r ordennumcuencas, message=F, warning=F, echo=F, fig.cap='Número de cuencas por órdenes de red de Strahler para el umbral de acumulación 540 celdas ($\\sim$8 hectáreas)', out.width='60%'}
rstream_cuencas_540_por_orden %>%
  ggplot + aes(x = `Orden de red (Strahler)`, y = `Número de cuencas`) + geom_line() +
  ylab('Número de cuencas (log2)') +
  scale_y_continuous(trans='log2') +
  theme_bw() +
  theme(text = element_text(size = 18))
```

Una caracterización de las cuencas que alcanzan un orden cuatro o mayor resulta también oportuna en este caso, dado que las cuencas de orden de red inferior son muy numerosas y, por la naturaleza del DEM empleado, la delimitación de las cuencas pequeñas es más propensa a error. Así, enfocando nuestro análisis sólo en las cuencas de orden cuatro o mayor, encontramos algunos patrones de interés que merecen mención.

Contabilizamos `r nrow(cuencas4mas)` cuencas de orden cuatro y mayor, lo que representa un `r format(nrow(cuencas4mas)/nrow(cuencas)*100, scientific=F, digits=3)`% del total nacional. Sin embargo, este pequeño porcentaje representa, en términos de superficie, el `r format(sum(cuencas4mas$area)/sum(cuencas$area)*100, scientific=F, digits=3)`% del área total de cuencas. En este subconjunto encontramos un tamaño mínimo de `r format(min(cuencas4mas$area)/1000000, scientific=F, digits=3)`&nbsp;km\textsuperscript{2}, promedio de `r format(mean(cuencas4mas$area)/1000000, scientific=F, digits=1)`&nbsp;km\textsuperscript{2} y desviación estándar de `r format(sd(cuencas$area)/1000000, scientific=F, digits=1)`&nbsp;km\textsuperscript{2}. La mitad de las cuencas de orden cuatro y mayor `r format(median(cuencas4mas$area)/1000000, scientific=F, digits=4)`&nbsp;km\textsuperscript{2} o menos de superficie y, aunque este subconjunto de cuencas tiene mejor distribución, el sesgo a la derecha persiste (sesgo calculado `r format(e1071::skewness(cuencas4mas$area), scientific=F, digits=3)`).

## Cuencas y subcuencas

Analizando las cuencas considerando sólo el orden de su red,

## Red de drenaje

La longitud total de *talwegs* obtenidos es de \### kilómetros, con el río más largo extendiéndose por \### kilómetros. Este nivel de detalle en la cartografía de ríos y corrientes supera significativamente a los modelos previos existentes, permitiendo una mejor comprensión y análisis de los patrones de flujo de agua en la República Dominicana (Figura \ref{fig:redordennacional}).

```{r redordennacional, echo=F, fig.cap='Representación de la red hidrográfica dominicana simbolizando el grosor de los segmentos en función de su orden de red (método de Strahler). El orden máximo alcanzado fue de 8. Esta red fue generada usando un umbral de acumulación de 540 celdas ($\\sim$8 ha)'}
knitr::include_graphics(paste(figuras, "red-orden-nacional.jpg", sep = '/'))
```

En cuanto a la jerarquía de la red, se observó un rango desde \### (la menor jerarquía) hasta \### (la mayor jerarquía), lo que indica una diversidad significativa en la configuración de las corrientes de agua. Esta jerarquía hidrográfica proporciona información valiosa para comprender la estructura y el funcionamiento de las cuencas.

Además, la inclusión de las redes generadas con los umbrales de 180 y 900 celdas en la base de datos añade un nivel adicional de detalle y versatilidad, ofreciendo diversas opciones para futuros estudios o aplicaciones que requieran diferentes niveles de resolución. Cabe mencionar que la red generada con un umbral de 180 celdas resultó en la mayor cantidad de cuencas hidrográficas identificadas, mientras que la red generada con el umbral de 900 celdas proporcionó las representaciones más simplificadas de las cuencas.

En cuanto a la distribución de cursos según jerarquía hidrográfica, la red generada con el umbral de 8 hectáreas alcanzó un orden máximo de 8 según los métodos de Strahler y Horton. Tanto la distribución del número de cursos como la suma de longitudes según órdenes jerárquicos, presentan un relación inversa exponencial.

# Discusión

Por el énfasis que hemos puesto en la generación de la red hidrográfica y la detallada metodología, nuestro trabajo es un artículo de datos y metodológico a la vez.

Para lograr una rápida salida del trabajo, dejamos para futuras investigaciones lo siguiente:

-   Evaluación de precisión de la elevación.
-   Nuestro interés gira en torno a la aplicabilidad de la hidrografía sistemáticamente generada, no necesariamente a las métricas, pues el modelo digital de elevaciones usado tiene error, y la información de terreno es insuficiente.
-   El drenaje en las áreas de desembocadura, especialmente en los casos de Yuna y Yaque de Sur.
-   Morfometría de redes y morfometría de cuencas, para próximos trabajos.
-   Mejora de la hidrografía de las áreas llanas (esperaremos mejores fuentes de elevación, e.g. TanDEM-X)
-   Las diferencias en cuanto a superficie de las cuencas, e.g. Yuna y Yaque del Sur.
-   Análisis hortonianos exhaustivos.
-   Segregación de la red teórica y la red circulante.
-   Con respecto a la precisión posicional de la red, estimamos que es alta en sistemas montañosos no kársticos, y moderada en sistemas kársticos. En los sistemas kársticos en particular, nuestro mapa exhibe un grado ligeramente mayor de incertidumbre debido a la ausencia de un catálogo detallado y preciso de depresiones, como las dolinas, que en última instancia definen la topología y jerarquización de la red en estos relieves. Para subsanar esta carencia, generamos nuestro propio inventario de depresiones a partir del modelo de elevaciones seleccionado, aunque lo aplicamos con prudencia a la hora de determinar la ubicación de los sumideros reales donde el flujo se infiltra al karst. Es relevante mencionar que nuestra red podría presentar una precisión reducida en áreas urbanas y llanas, así como en terrenos con canales de riego. Sin embargo, este factor no impacta la relevancia de nuestro estudio, dado que se enfoca primordialmente en otros tipos de áreas.
-   En relación a las cuencas y redes de drenaje transfronterizas, es importante destacar que sólo se caracterizaron utilizando información la porción correspondiente al territorio dominicano. Como resultado, el orden de red máximo obtenido para estas redes podría no reflejar su orden real. Estas cuencas abarcan las de los ríos Artibonito, Pedernales y Masacre, además de varias cuencas menores dispersas a lo largo de la frontera. No obstante, una evaluación visual preliminar indica que la mencionada limitación no interfiere con el propósito de nuestro estudio. Además, en futuros trabajos, abordaremos estas cuencas de manera integral para proporcionar una visión más completa de su morfometría.
-   Para asegurar que los datos de elevación eran adecuados y precisos en términos de elevación, se debería validar el DEM con datos de puntos de verificación tomados con GNSS.

<!-- # Financiamiento {.unnumbered} -->

<!-- Esta investigación recibió financiamiento del Banco Interamericano de Desarrollo (BID), y fue apoyado por la ONG Guakía Ambiente y la Universidad Autónoma de Santo Domingo (UASD). -->

# Declaración de conflicto de intereses {.unnumbered}

El autor y la autora de este artículo declaran que no tienen ningún conflicto de interés con el contenido de este artículo.

# Disponibilidad de datos, scripts y código {.unnumbered}

Los datos que respaldan los hallazgos de este estudio están disponibles abiertamente en Zenodo en \url{https://doi.org/10.5281/zenodo.8146391} [@martinez2023datos]. Los scripts utilizados para la curación de datos, análisis y visualización están disponibles en esta sección, así como en el repositorio de GitHub en \url{https://github.com/geofis/red-hidrografica-densa-rd} y en Zenodo en \url{} [@RELLENAR].

\newpage

# Información suplementaria {#infosupl .unnumbered}

```{=tex}
\beginsupplement
```
```{r child=paste0(raiz_supl_met, '.Rmd'), eval=incluir_supl_al_final}
```

# Referencias
